(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1008:function(e,t){},1009:function(e,t){},103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(n,r,o){void 0===o&&(o={hideCloseButton:!1});var a=e.call(this,"Script Lab Error",n,r)||this;return Object.setPrototypeOf(a,t.prototype),a.options=o,a}return r.__extends(t,e),t}(n(36).CustomError);t.ScriptLabError=o},1062:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1062},107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(103),a=r.__importDefault(n(852)),i="<Unable to display object>";function c(e,t){void 0===t&&(t={});if(t=r.__assign({},{quoteStrings:!1,skipErrorStack:!1},t),null===e)return"null";if("undefined"===typeof e)return"undefined";if("string"===typeof e)return t.quoteStrings?'"'+e+'"':e;if(Array.isArray(e))return function(e){for(var t=0;t<e.length;t++)if(!a.default(e[t]))return!1;return!0}(e)?"["+e.map(function(e){return c(e,r.__assign({},t,{quoteStrings:!0}))}).join(", ")+"]":"[\n"+e.map(function(e){return c(e,r.__assign({},t,{quoteStrings:!0}))}).join(",\n").split("\n").map(function(e){return new Array(4).fill(" ").join("")+e}).join("\n")+"\n]";if(e instanceof Error)try{return(e instanceof o.ScriptLabError?e.message+":":"Error:")+"\n"+n(e)}catch(i){return c(e.toString(),t)}return"[object Object]"!==e.toString()?e.toString():n(e);function n(e){return JSON.stringify(e,function(n,a){if(!(e instanceof Error&&t.skipErrorStack&&"stack"===n)&&!(e instanceof o.ScriptLabError&&"options"===n))return a&&"object"===typeof a&&!Array.isArray(a)?function(e){var t={};try{var n=e;do{var o=Object.getOwnPropertyNames(n);o.forEach(c),a(n=Object.getPrototypeOf(n))&&(n=null)}while(n);return t}catch(i){return e}function a(e){var n,o,a=Object.keys(t);try{for(var i=r.__values(Object.keys(e)),c=i.next();!c.done;c=i.next()){var s=c.value;if(a.indexOf(s)<0)return!1}}catch(u){n={error:u}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!0}function c(n){var r=Object.prototype.hasOwnProperty;n.indexOf(" ")<0&&!r.call(t,n)&&Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get:function(){return e[n]}})}}(a):a},4)}}t.matchesSearch=function(e,t){var n,o;if(0===e.length)return!0;try{for(var a=r.__values(t),i=a.next();!i.done;i=a.next()){var c=i.value;if(c&&c.toLowerCase().includes(e))return!0}}catch(s){n={error:s}}finally{try{i&&!i.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return!1},t.stripSpaces=function(e){for(var t,n,o=e.split("\n"),a=0;a<o.length;a++)o[a].replace("\t","    ");var i=!0,c=0;do{""===o[c].trim()?o.splice(c,1):i=!1}while(i||c===o.length);c=o.length-1,i=!0;do{""===o[c].trim()?(o.splice(c,1),c--):i=!1}while(i);var s=1024;try{for(var u=r.__values(o),l=u.next();!l.done;l=u.next()){var d=l.value;if(""!==d.trim()){var f=d.search(/\S/);f<s&&(s=f)}}}catch(m){t={error:m}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}for(a=0;a<o.length;a++)o[a].length>=s&&(o[a]=o[a].substring(s));var p="";for(a=0;a<o.length;a++)a<o.length-1?p+=o[a]+"\n":p+=o[a];return p},t.stringifyPlusPlus=c,t.stringifyPlusPlusOrErrorMessage=function(e){try{return c(e)}catch(t){return i}},t.generateLogString=function(e,t){var n="",r=!0;return e.forEach(function(e){try{n+=c(e)}catch(t){r=!1,n+=i}n+="\n"}),n.length>0&&(n=n.trim()),{message:n,severity:r?t:"error"}}},108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.languageMapLowercased={typescript:"typescript",javascript:"javascript",css:"css",html:"html",json:"json",python:"python"},t.languageMapDisplayNames={typescript:"TypeScript",javascript:"JavaScript",css:"CSS",html:"HTML",json:"JSON",python:"Python"}},116:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bufferToHexString=function(e){return Array.from(e instanceof Uint8Array?e:new Uint8Array(e)).map(function(e){return("00"+e.toString(16)).slice(-2)}).join("")},t.hexStringToBuffer=function(e){var t=e.match(/.{1,2}/g).map(function(e){return parseInt(e,16)}),n=new ArrayBuffer(t.length),r=new Uint8Array(n);return t.forEach(function(e,t){return r[t]=e}),n},t.unicodeStringToBuffer=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t},t.bufferToUnicodeString=function(e){return String.fromCharCode.apply(null,Array.from(new Uint16Array(e)))}},1217:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PC="PC",e.OfficeOnline="OfficeOnline",e.Mac="Mac",e.iOS="iOS",e.Android="Android",e.Universal="Universal"}(r=t.PlatformType||(t.PlatformType={})),t.getPlatform=function(){return window.Office&&window.Office.context&&window.Office.context.platform||r.OfficeOnline}},1218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,a=n(1),i=a.__importDefault(n(11));t.Layout=i.default.div(r||(r=a.__makeTemplateObject(["\n  height: 100%;\n  max-height: inherit;\n  display: flex;\n  flex-direction: column;\n  z-index: 1000;\n"],["\n  height: 100%;\n  max-height: inherit;\n  display: flex;\n  flex-direction: column;\n  z-index: 1000;\n"]))),t.ContentWrapper=i.default.div(o||(o=a.__makeTemplateObject(["\n  z-index: 1000;\n  flex: 1;\n  height: 100%;\n\n  overflow: hidden;\n\n  background: ",";\n"],["\n  z-index: 1000;\n  flex: 1;\n  height: 100%;\n\n  overflow: hidden;\n\n  background: ",";\n"])),function(e){return e.theme.white})},1219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=o.__importDefault(n(11));t.PivotBarWrapper=a.default.div(r||(r=o.__makeTemplateObject(["\n  background-color: ",";\n  z-index: 1000;\n"],["\n  background-color: ",";\n  z-index: 1000;\n"])),function(e){return e.theme.primaryDarker})},1220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=o.__importDefault(n(0)),i=o.__importDefault(n(1221)),c=n(544),s=n(107),u=o.__importDefault(n(1281));!function(e){e.Info="info",e.Log="log",e.Warn="warn",e.Error="error"}(r=t.ConsoleLogSeverities||(t.ConsoleLogSeverities={}));t.default=function(e){var t,n=e.severity,o=e.message,l=e.theme,d=(t={},t[r.Log]={backgroundColor:l.white,color:l.black,icon:null},t[r.Info]={backgroundColor:"#cce6ff",color:l.black,icon:{name:"Info",color:"#002db3"}},t[r.Warn]={backgroundColor:"#fff4ce",color:l.black,icon:{name:"Warning",color:"gold"}},t[r.Error]={backgroundColor:"#fde7e9",color:l.black,icon:{name:"Error",color:"red"}},t)[n],f=d.backgroundColor,p=d.color,m=d.icon;return"object"===typeof o?a.default.createElement(c.ObjectInspectorLogEntry,{backgroundColor:f,style:{backgroundColor:f,color:p}},a.default.createElement(u.default,{icon:m}),a.default.createElement(i.default,{obj:o})):a.default.createElement(c.LogEntry,{style:{backgroundColor:f,color:p}},a.default.createElement(u.default,{icon:m}),a.default.createElement(c.LogText,null,s.stringifyPlusPlusOrErrorMessage(o)))}},1221:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importStar(n(0)),a=n(1222),i=r.__importDefault(n(1280)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.obj;return e&&e.toJSON?o.default.createElement(a.ObjectInspector,{data:e.toJSON()}):"undefined"!==typeof OfficeExtension&&e instanceof OfficeExtension.Error?o.default.createElement(a.ObjectInspector,{data:e,expandPaths:["$","$.debugInfo","$.debugInfo.surroundingStatements"]}):i.default(e)?o.default.createElement(a.ObjectInspector,{data:e,showNonenumerable:!0,expandLevel:1,sortObjectKeys:s}):o.default.createElement(a.ObjectInspector,{data:e})},t}(o.PureComponent);function s(e,t){return"stack"===e?1:"stack"===t?-1:e<t?-1:e>t?1:0}t.default=c},1281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1).__importDefault(n(0)),o=n(93);t.default=function(e){var t=e.icon;return t?r.default.createElement(o.Icon,{className:"ms-font-m",iconName:t.name,style:{fontSize:"1.2rem",color:t.color,lineHeight:"1.2rem"}}):r.default.createElement("div",{style:{width:"1.2rem",height:"1.2rem"}})}},1285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=o.__importDefault(n(11));t.Wrapper=a.default.footer(r||(r=o.__makeTemplateObject(["\n  overflow: hidden;\n  height: 2rem;\n  font-size: 1.2rem;\n\n  background-color: ",";\n  color: ",";\n"],["\n  overflow: hidden;\n  height: 2rem;\n  font-size: 1.2rem;\n\n  background-color: ",";\n  color: ",";\n"])),function(e){return e.theme.primary},function(e){return e.theme.white})},1286:function(e,t,n){},1331:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1331},1332:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"get",function(){return Lt}),n.d(r,"getSolutionWithHiddenFiles",function(){return Bt}),n.d(r,"getAll",function(){return Pt}),n.d(r,"getInLastModifiedOrder",function(){return Rt}),n.d(r,"getInLastOpenedOrder",function(){return Nt}),n.d(r,"getEditorLastModifiedDate",function(){return Ut}),n.d(r,"getCustomFunctionsLastModifiedDate",function(){return Ft}),n.d(r,"getFile",function(){return Mt}),n.d(r,"getFiles",function(){return Gt});var o={};n.r(o),n.d(o,"getActiveSolution",function(){return Wt}),n.d(o,"getLastModifiedDate",function(){return zt}),n.d(o,"getActiveFile",function(){return Kt}),n.d(o,"getIntellisenseFiles",function(){return Jt}),n.d(o,"getIsActiveSolutionCF",function(){return qt}),n.d(o,"getIsActiveSolutionPython",function(){return Vt}),n.d(o,"getIsActiveSolutionTrusted",function(){return Yt});var a={};n.r(a),n.d(a,"get",function(){return $t}),n.d(a,"getIsWeb",function(){return Xt}),n.d(a,"getIsInDesktop",function(){return Zt}),n.d(a,"getIsRunnableOnThisHost",function(){return en});var i={};n.r(i),n.d(i,"getToken",function(){return nn}),n.d(i,"getProfilePicUrl",function(){return rn}),n.d(i,"getUsername",function(){return on}),n.d(i,"getIsLoggingInOrOut",function(){return an}),n.d(i,"getIsAuthDialogOpen",function(){return cn}),n.d(i,"getIsLoggedIn",function(){return sn});var c={};n.r(c),n.d(c,"getWidth",function(){return un}),n.d(c,"getHeight",function(){return ln}),n.d(c,"getIsTaskPaneWidth",function(){return dn});var s={};n.r(s),n.d(s,"show",function(){return pn}),n.d(s,"dismiss",function(){return mn}),n.d(s,"hide",function(){return hn}),n.d(s,"reset",function(){return gn});var u={};n.r(u),n.d(u,"open",function(){return bn}),n.d(u,"hide",function(){return yn}),n.d(u,"openBackstage",function(){return On}),n.d(u,"hideBackstage",function(){return vn}),n.d(u,"openFile",function(){return jn}),n.d(u,"setActive",function(){return Sn}),n.d(u,"onMount",function(){return _n}),n.d(u,"applyMonacoOptions",function(){return wn}),n.d(u,"setIntellisenseFiles",function(){return En}),n.d(u,"removeIntellisenseFiles",function(){return xn}),n.d(u,"applyFormatting",function(){return An}),n.d(u,"newSolutionOpened",function(){return kn}),n.d(u,"newFileOpened",function(){return Cn}),n.d(u,"navigateToRun",function(){return Tn}),n.d(u,"shouldUpdateIntellisense",function(){return In});var l={};n.r(l),n.d(l,"importSnippet",function(){return Dn}),n.d(l,"create",function(){return Ln}),n.d(l,"update",function(){return Bn}),n.d(l,"fetchMetadata",function(){return Pn}),n.d(l,"get",function(){return Rn});var d={};n.r(d),n.d(d,"showLoginDialog",function(){return Nn}),n.d(d,"loginSuccessful",function(){return Un}),n.d(d,"cancelLogin",function(){return Fn}),n.d(d,"logout",function(){return Mn});var f={};n.r(f),n.d(f,"change",function(){return Gn});var p={};n.r(p),n.d(p,"show",function(){return Hn}),n.d(p,"dismiss",function(){return Wn});var m={};n.r(m),n.d(m,"initialize",function(){return zn}),n.d(m,"switchEnvironment",function(){return Kn}),n.d(m,"confirmSwitchEnvironment",function(){return Jn}),n.d(m,"hideLoadingSplashScreen",function(){return qn}),n.d(m,"popOutEditor",function(){return Vn}),n.d(m,"goToCustomFunctionsDashboard",function(){return Yn});var h={};n.r(h),n.d(h,"fetchMetadata",function(){return Qn}),n.d(h,"get",function(){return $n});var g={};n.r(g),n.d(g,"updateSize",function(){return Xn});var b={};n.r(b),n.d(b,"edit",function(){return Zn}),n.d(b,"setLastActive",function(){return er}),n.d(b,"open",function(){return tr}),n.d(b,"close",function(){return nr}),n.d(b,"editFile",function(){return rr}),n.d(b,"cycleEditorTheme",function(){return or});var y={};n.r(y),n.d(y,"create",function(){return ar}),n.d(y,"add",function(){return ir}),n.d(y,"edit",function(){return cr}),n.d(y,"changeLanguage",function(){return sr}),n.d(y,"updateLastOpened",function(){return ur}),n.d(y,"remove",function(){return lr}),n.d(y,"deleteFromState",function(){return dr}),n.d(y,"getDefault",function(){return fr}),n.d(y,"updateOptions",function(){return pr}),n.d(y,"scriptNeedsParsing",function(){return mr});var O={};n.r(O),n.d(O,"dialog",function(){return s}),n.d(O,"editor",function(){return u}),n.d(O,"gists",function(){return l}),n.d(O,"github",function(){return d}),n.d(O,"host",function(){return f}),n.d(O,"messageBar",function(){return p}),n.d(O,"misc",function(){return m}),n.d(O,"samples",function(){return h}),n.d(O,"screen",function(){return g}),n.d(O,"settings",function(){return b}),n.d(O,"solutions",function(){return y}),n.d(O,"default",function(){return hr});var v={};n.r(v),n.d(v,"getMode",function(){return br}),n.d(v,"getItems",function(){return vr}),n.d(v,"getFarItems",function(){return jr});var j={};n.r(j),n.d(j,"getIsOpen",function(){return Tr}),n.d(j,"get",function(){return Ir}),n.d(j,"getUser",function(){return Dr}),n.d(j,"getMonacoTheme",function(){return Lr}),n.d(j,"getPrettyEditorTheme",function(){return Br}),n.d(j,"getBackgroundColor",function(){return Pr}),n.d(j,"getTabSize",function(){return Rr}),n.d(j,"getIsPrettierEnabled",function(){return Nr}),n.d(j,"getIsAutoFormatEnabled",function(){return Ur}),n.d(j,"getMonacoOptions",function(){return Fr});var S={};n.r(S),n.d(S,"getItems",function(){return Hr}),n.d(S,"getFarItems",function(){return Wr});var _={};n.r(_),n.d(_,"getGistMetadata",function(){return zr});var w={};n.r(w),n.d(w,"getMetadataByGroup",function(){return Kr});var E={};n.r(E),n.d(E,"editor",function(){return o}),n.d(E,"footer",function(){return S}),n.d(E,"gists",function(){return _}),n.d(E,"github",function(){return i}),n.d(E,"header",function(){return v}),n.d(E,"host",function(){return a}),n.d(E,"samples",function(){return w}),n.d(E,"screen",function(){return c}),n.d(E,"settings",function(){return j}),n.d(E,"solutions",function(){return r}),n.d(E,"default",function(){return Jr});var x=n(3),A=n.n(x),k=n(38),C=(n(613),n(43)),T=(n(904),n(2)),I=n.n(T),D=n(594),L=n.n(D);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=n(96),P=n.n(B),R=n(29),N=n(595),U=n.n(N),F="user-settings",M="user-settings-file",G="default-settings-file",H="null-file",W={id:H,name:"",content:"",language:"",dateCreated:0,dateLastModified:0,dateLastOpened:0},z="null-solution",K={id:z,name:"",host:"ALL",dateCreated:0,dateLastModified:0,dateLastOpened:0,options:{},files:[]},J=[H,"about",G],q="https://aka.ms/script-lab/issues",V="/functions",Y="/auth",Q="/custom-functions",$="/custom-functions-heartbeat",X="/custom-functions-run",Z="/",ee="/external-page",te="/heartbeat",ne="/run",re=250,oe=450,ae=n(30),ie=n(31),ce=n(33),se=n(32),ue=n(34),le=n(97),de=n(1365),fe=n(445),pe=n(141),me=n.n(pe),he=n(36),ge=n(47),be=n(10),ye=n(92),Oe=n.n(ye),ve=function(e){return fetch(e).then(function(e){return e.ok?e.text():Promise.reject(e.statusText)}).then(function(e){return{content:Oe.a.safeLoad(e)}}).catch(function(e){return{error:e}})};function je(e){return Se.apply(this,arguments)}function Se(){return(Se=Object(k.a)(A.a.mark(function e(t){var n,r,o,a,i,c;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.method,r=t.url,o=t.token,a=t.jsonPayload,i=Object(be.a)({},_e(o,{Authorization:"Bearer ".concat(o)}),_e("GET"!==n,{"Content-Type":"application/json; charset=utf-8"})),e.prev=2,e.next=5,fetch(r,{method:n,headers:i,body:a});case 5:if(!(c=e.sent).ok){e.next=14;break}return e.next=9,c.json();case 9:return e.t0=e.sent,e.t1=c.headers,e.abrupt("return",{response:e.t0,headers:e.t1});case 14:return e.abrupt("return",Promise.reject(new Error(c.statusText)));case 15:e.next=20;break;case 17:return e.prev=17,e.t2=e.catch(2),e.abrupt("return",{error:e.t2});case 20:case"end":return e.stop()}},e,this,[[2,17]])}))).apply(this,arguments)}function _e(e,t){return e?t:{}}var we=n(37),Ee=n(42),xe="https://api.github.com";function Ae(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(k.a)(A.a.mark(function e(t){var n,r,o,a,i,c,s,u,l,d,f;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.method,r=t.path,o=t.token,a=t.jsonPayload,i=t.isArrayResponse,e.prev=1,c="".concat(xe,"/").concat(r),s=[];case 4:if(!c){e.next=19;break}return e.next=7,je({url:c,method:n,token:o,jsonPayload:a});case 7:if(u=e.sent,l=u.response,d=u.headers,!(f=u.error)){e.next=13;break}return e.abrupt("return",{error:f});case 13:if(i){e.next=15;break}return e.abrupt("return",{response:l});case 15:s=Object(ge.a)(s).concat(Object(ge.a)(l)),c=Ie(d.get("Link")),e.next=4;break;case 19:return e.abrupt("return",{response:s});case 22:return e.prev=22,e.t0=e.catch(1),e.abrupt("return",{error:e.t0});case 25:case"end":return e.stop()}},e,this,[[1,22]])}))).apply(this,arguments)}var Ce=function(e){return Ae({method:"GET",path:"user",token:e,isArrayResponse:!1}).then(function(t){var n=t.response,r=t.error;if(r)throw r;return{token:e,profilePicUrl:n.avatar_url,username:n.login,fullName:n.name}})},Te=function(){localStorage.removeItem(Ee.GITHUB_KEY),localStorage.removeItem("OAuth2Tokens")};function Ie(e){var t=/\<(https:[^\>]*)\>; rel="next"/.exec(e);return t?t[1]:null}var De=n(215),Le=n.n(De),Be=function(){return I.a.createElement("div",null,I.a.createElement(de.a,{messageBarType:fe.a.severeWarning},"Script Lab's authentication with GitHub is no longer supported on Internet Explorer. Please re-open this URL in an alternate browser, such as Edge, Chrome, Firefox, etc."),I.a.createElement(Le.a,{style:{marginTop:"2rem"},text:window.location.href}))},Pe=n(17),Re=n.n(Pe),Ne=function(e){var t=e.additionalInfo;return I.a.createElement(de.a,{messageBarType:fe.a.severeWarning},"Something went wrong. Please return to the code editor window and try again, or try logging in using a different browser.",I.a.createElement(Re.a,{when:!!t},I.a.createElement("div",null,I.a.createElement("div",{style:{fontStyle:"italic",marginTop:"2.5rem",marginBottom:"1.5rem"}},"Additional info:"),I.a.createElement("div",null,t))))},Ue=n(1366),Fe=n(139),Me=function(e){var t=e.encodedToken,n=e.username,r=e.fullName,o=e.profilePicUrl;return I.a.createElement("div",null,I.a.createElement(de.a,{messageBarType:fe.a.success},"Your encoded GitHub auth token is ready. Please copy it from here, and paste it back into the code editor window."),I.a.createElement(Ue.a,{styles:{root:{marginTop:"2rem"}},imageUrl:o,size:Fe.c.size48,text:n,secondaryText:r,showSecondaryText:!0}),I.a.createElement(Le.a,{style:{marginTop:"2rem"},text:t}))},Ge=n(1359),He=n(448),We=n(219),ze=n(116),Ke={auth_completed:"auth_completed",auth_key:"auth_key",auth_state:"auth_state"},Je=function(e){function t(e){var n;Object(ae.a)(this,t),(n=Object(ce.a)(this,Object(se.a)(t).call(this,e))).exchangeCodeAndStateForAccessToken=Object(k.a)(A.a.mark(function e(){var t,r,o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={code:n.params.code,state:sessionStorage.getItem(Ke.auth_state)},e.next=4,fetch(we.currentServerUrl+"/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if(!(r=e.sent).ok){e.next=12;break}return e.next=8,r.json();case 8:(o=e.sent).error?n.onError(o.error):o.access_token?n.onToken(o.access_token):n.onError("Unexpected error, response doesn't match expected form."),e.next=13;break;case 12:n.onError(r.statusText);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),n.onError(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),n.onToken=function(){var e=Object(k.a)(A.a.mark(function e(t){var r,o,a,i,c,s,u;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ce(t);case 3:return r=e.sent,o=r.username,a=r.profilePicUrl,i=r.fullName,e.next=9,qe(n.state.publicKeyString);case 9:return c=e.sent,e.next=12,crypto.subtle.encrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},c,Object(ze.unicodeStringToBuffer)(t));case 12:s=e.sent,u=Object(ze.bufferToHexString)(s),n.setState({encodedToken:u,username:o,profilePicUrl:a,fullName:i}),window.sessionStorage.setItem(Ke.auth_completed,"true"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),Object(C.invokeGlobalErrorHandler)(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),n.onError=function(e){return n.setState({error:e})};var r,o,a=Object(le.isInternetExplorer)();return n.params=P.a.parse(P.a.extract(window.location.href)),n.params.key&&n.params.key.trim().length>0?(r=n.params.key,Object.values(Ke).forEach(function(e){return sessionStorage.removeItem(e)}),sessionStorage.setItem(Ke.auth_key,r)):r=sessionStorage.getItem(Ke.auth_key),sessionStorage.getItem(Ke.auth_completed)&&(o="You've already authenticated once on this page. If you need to re-authenticate, please close this page, go back to the code editor, and retrieve a new sign-in URL to open in a new page."),n.state={isIE:a,publicKeyString:r,error:o,hasCodeAndState:!o&&Boolean(n.params.code&&n.params.state)},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=function(){if(e.state.error)return{component:I.a.createElement(Ne,{additionalInfo:e.state.error}),showUI:!0};if(e.state.encodedToken)return{component:I.a.createElement(Me,{encodedToken:e.state.encodedToken,username:e.state.username,fullName:e.state.fullName,profilePicUrl:e.state.profilePicUrl}),showUI:!0};if(e.state.hasCodeAndState){var t=sessionStorage.getItem(Ke.auth_state);return e.state.publicKeyString&&t&&t===e.params.state?{component:I.a.createElement(We.RunOnLoad,{funcToRun:e.exchangeCodeAndStateForAccessToken}),showUI:!1}:(console.error("Something went wrong: have code and state on the URL query string, but don't seem to have it in session storage!"),{component:I.a.createElement(Ne,null),showUI:!0})}return e.state.publicKeyString&&!e.state.isIE?(qe(e.state.publicKeyString).then(function(e){var t,n=Object(le.generateRandomToken)();sessionStorage.setItem(Ke.auth_state,n),window.location.href=(t=n,"https://github.com/login/oauth/authorize?"+P.a.stringify({client_id:we.githubAppClientId,redirect_uri:window.location.origin,scope:"gist",state:t}))}).catch(function(t){e.setState({error:'The "key" parameter in the URL appears to be incomplete. Please go back to the sign-in dialog in the code editor, and be sure to copy the full URL.'})}),{component:null,showUI:!1}):e.state.publicKeyString?e.state.isIE?{component:I.a.createElement(Be,null),showUI:!0}:(console.error("Something went wrong -- fell through the other cases"),{component:I.a.createElement(Ne,null),showUI:!0}):{component:I.a.createElement(de.a,{messageBarType:fe.a.severeWarning},'This page must be opened from a link that contains a "key" parameter in the URL. Please go back to the sign-in dialog in the code editor, and be sure to copy the full URL.'),showUI:!0}}(),n=t.component;return t.showUI&&Object(C.hideSplashScreen)(),I.a.createElement(me.a,{host:he.HostType.WEB},I.a.createElement(Ge.a,{hidden:!1,minWidth:"350px",dialogContentProps:{type:He.a.normal,title:"Script Lab \u2013 Sign in with GitHub"},modalProps:{isBlocking:!0}},n))}}]),t}(I.a.Component);function qe(e){return new Promise(function(){var t=Object(k.a)(A.a.mark(function t(n,r){var o;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,crypto.subtle.importKey("spki",Object(ze.hexStringToBuffer)(e),{name:"RSA-OAEP",hash:{name:"SHA-256"}},!1,["encrypt"]);case 3:return o=t.sent,t.abrupt("return",n(o));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",r(t.t0));case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e,n){return t.apply(this,arguments)}}())}var Ve=n(449),Ye=n.n(Ve);function Qe(){return $e("launchCode",function(e){return nt()?(Object(C.hideSplashScreen)(),tt(Ze,e)):et(Ze,e,{width:75,height:75,displayInIframe:!1})}),$e("launchTutorial",function(e){return nt()?(Object(C.hideSplashScreen)(),tt(Xe,e)):et(Xe,e,{width:35,height:45})}),$e("launchHelp",function(e){return tt(Ye.a.playground_help,e)}),$e("launchAsk",function(e){return tt(Ye.a.ask,e)}),$e("launchApiDocs",function(e){return Office.context.requirements.isSetSupported("ExcelApi")?tt(Ye.a.excel_api,e):Office.context.requirements.isSetSupported("WordApi")?tt(Ye.a.word_api,e):Office.context.requirements.isSetSupported("OneNoteApi")?tt(Ye.a.onenote_api,e):he.Utilities.host===he.HostType.POWERPOINT?tt(Ye.a.powepoint_api,e):he.Utilities.host===he.HostType.PROJECT?tt(Ye.a.project_api,e):he.Utilities.host===he.HostType.OUTLOOK?tt(Ye.a.outlook_api,e):tt(Ye.a.generic_api,e)}),Office.onReady()}function $e(e,t){window[e]=t}var Xe="".concat(window.location.origin,"/tutorial.html"),Ze="".concat(window.location.origin,"/?mode=").concat(he.Utilities.host);function et(e,t,n,r){(n=n||{}).width=n.width||60,n.height=n.height||60,"undefined"===typeof n.displayInIframe&&(n.displayInIframe=!0),Office.context.ui.displayDialogAsync(e,n,function(e){he.Utilities.host===he.HostType.OUTLOOK&&(e.status===Office.AsyncResultStatus.Failed&&t.completed(),e.value.addEventHandler(Office.EventType.DialogEventReceived,function(){t&&t.completed()}));r&&e.status===Office.AsyncResultStatus.Succeeded&&r(e.value)}),t&&he.Utilities.host!==he.HostType.OUTLOOK&&t.completed()}function tt(e,t){!function(e,t,n,r){et(rt(e)?e:"".concat(window.location.origin,"/#/external-page?destination=").concat(encodeURIComponent(e)),t,n,r)}(e,t,rt(e)?{displayInIframe:!1,width:60,height:60}:{displayInIframe:!0,width:30,height:30},function(e){e.addEventHandler(Office.EventType.DialogMessageReceived,function(t){"close"===t.message&&e.close()})})}function nt(){return he.Utilities.host===he.HostType.OUTLOOK&&he.Utilities.platform==he.PlatformType.OFFICE_ONLINE}function rt(e){return nt()&&(e===Ze||e===Xe)}var ot=function(){return I.a.createElement(We.RunOnLoad,{funcToRun:Qe})},at=n(450),it=n.n(at),ct=n(107),st="\n!function(modules)%20%7B%0A%20%20%20%20function%20__webpack_require__(moduleId)%20%7B%0A%20%20%20%20%20%20%20%20if%20(installedModules%5BmoduleId%5D)%20return%20installedModules%5BmoduleId%5D.exports%3B%0A%20%20%20%20%20%20%20%20var%20module%20%3D%20installedModules%5BmoduleId%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%3A%20moduleId%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20l%3A%20!1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20exports%3A%20%7B%7D%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20modules%5BmoduleId%5D.call(module.exports%2C%20module%2C%20module.exports%2C%20__webpack_require__)%2C%20%0A%20%20%20%20%20%20%20%20module.l%20%3D%20!0%2C%20module.exports%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20installedModules%20%3D%20%7B%7D%3B%0A%20%20%20%20__webpack_require__.m%20%3D%20modules%2C%20__webpack_require__.c%20%3D%20installedModules%2C%20__webpack_require__.i%20%3D%20function(value)%20%7B%0A%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%7D%2C%20__webpack_require__.d%20%3D%20function(exports%2C%20name%2C%20getter)%20%7B%0A%20%20%20%20%20%20%20%20__webpack_require__.o(exports%2C%20name)%20%7C%7C%20Object.defineProperty(exports%2C%20name%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20configurable%3A%20!1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20enumerable%3A%20!0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20get%3A%20getter%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%2C%20__webpack_require__.n%20%3D%20function(module)%20%7B%0A%20%20%20%20%20%20%20%20var%20getter%20%3D%20module%20%26%26%20module.__esModule%20%3F%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20module.default%3B%0A%20%20%20%20%20%20%20%20%7D%20%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20module%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20return%20__webpack_require__.d(getter%2C%20%22a%22%2C%20getter)%2C%20getter%3B%0A%20%20%20%20%7D%2C%20__webpack_require__.o%20%3D%20function(object%2C%20property)%20%7B%0A%20%20%20%20%20%20%20%20return%20Object.prototype.hasOwnProperty.call(object%2C%20property)%3B%0A%20%20%20%20%7D%2C%20__webpack_require__.p%20%3D%20%22%22%2C%20__webpack_require__(__webpack_require__.s%20%3D%203)%3B%0A%7D(%5B%20function(module%2C%20exports%2C%20__webpack_require__)%20%7B%0A%20%20%20%20%22use%20strict%22%3B%0A%20%20%20%20(function(global)%20%7B%0A%20%20%20%20%20%20%20%20function%20writeToAsyncStorage(entry)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20__awaiter(this%2C%20void%200%2C%20void%200%2C%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20e_2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20__generator(this%2C%20function(_a)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(_a.label)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_a.trys.push(%5B%200%2C%202%2C%20%2C%203%20%5D)%2C%20%5B%204%2C%20OfficeRuntime.AsyncStorage.setItem(StorageKeys.logHash%20%2B%20logCounter%2B%2B%2C%20JSON.stringify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20severity%3A%20entry.severity%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%3A%20standalone_log_helper_1.stringifyPlusPlus(entry.message)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D))%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_a.sent()%2C%20%5B%203%2C%203%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20e_2%20%3D%20_a.sent()%2C%20console.error(%22Error%20writing%20to%20AsyncStorage%22)%2C%20console.error(e_2)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%203%2C%203%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%5B%202%20%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20function%20shouldIgnore()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20args%20%3D%20%5B%5D%2C%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B)%20args%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201%20%3D%3D%3D%20args.length%20%26%26%20SHOULD_IGNORE_REGEX.test(args%5B0%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20__assign%20%3D%20this%20%26%26%20this.__assign%20%7C%7C%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20__assign%20%3D%20Object.assign%20%7C%7C%20function(t)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20s%2C%20i%20%3D%201%2C%20n%20%3D%20arguments.length%3B%20i%20%3C%20n%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20s%20%3D%20arguments%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20p%20in%20s)%20Object.prototype.hasOwnProperty.call(s%2C%20p)%20%26%26%20(t%5Bp%5D%20%3D%20s%5Bp%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20__assign.apply(this%2C%20arguments)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20__awaiter%20%3D%20this%20%26%26%20this.__awaiter%20%7C%7C%20function(thisArg%2C%20_arguments%2C%20P%2C%20generator)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20new%20(P%20%7C%7C%20(P%20%3D%20Promise))(function(resolve%2C%20reject)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function%20fulfilled(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20step(generator.next(value))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20reject(e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function%20rejected(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20step(generator.throw(value))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20reject(e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function%20step(result)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result.done%20%3F%20resolve(result.value)%20%3A%20new%20P(function(resolve)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20resolve(result.value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D).then(fulfilled%2C%20rejected)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20step((generator%20%3D%20generator.apply(thisArg%2C%20_arguments%20%7C%7C%20%5B%5D)).next())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20__generator%20%3D%20this%20%26%26%20this.__generator%20%7C%7C%20function(thisArg%2C%20body)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20verb(n)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20function(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20step(%5B%20n%2C%20v%20%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20step(op)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(f)%20throw%20new%20TypeError(%22Generator%20is%20already%20executing.%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(%3B_%3B%20)%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(f%20%3D%201%2C%20y%20%26%26%20(t%20%3D%202%20%26%20op%5B0%5D%20%3F%20y.return%20%3A%20op%5B0%5D%20%3F%20y.throw%20%7C%7C%20((t%20%3D%20y.return)%20%26%26%20t.call(y)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200)%20%3A%20y.next)%20%26%26%20!(t%20%3D%20t.call(y%2C%20op%5B1%5D)).done)%20return%20t%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(y%20%3D%200%2C%20t%20%26%26%20(op%20%3D%20%5B%202%20%26%20op%5B0%5D%2C%20t.value%20%5D)%2C%20op%5B0%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%20op%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%204%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_.label%2B%2B%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%3A%20op%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20done%3A%20!1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%205%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_.label%2B%2B%2C%20y%20%3D%20op%5B1%5D%2C%20op%20%3D%20%5B%200%20%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%207%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20op%20%3D%20_.ops.pop()%2C%20_.trys.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%3D%20_.trys%2C%20!(t%20%3D%20t.length%20%3E%200%20%26%26%20t%5Bt.length%20-%201%5D)%20%26%26%20(6%20%3D%3D%3D%20op%5B0%5D%20%7C%7C%202%20%3D%3D%3D%20op%5B0%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(3%20%3D%3D%3D%20op%5B0%5D%20%26%26%20(!t%20%7C%7C%20op%5B1%5D%20%3E%20t%5B0%5D%20%26%26%20op%5B1%5D%20%3C%20t%5B3%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_.label%20%3D%20op%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(6%20%3D%3D%3D%20op%5B0%5D%20%26%26%20_.label%20%3C%20t%5B1%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_.label%20%3D%20t%5B1%5D%2C%20t%20%3D%20op%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(t%20%26%26%20_.label%20%3C%20t%5B2%5D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_.label%20%3D%20t%5B2%5D%2C%20_.ops.push(op)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%5B2%5D%20%26%26%20_.ops.pop()%2C%20_.trys.pop()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20op%20%3D%20body.call(thisArg%2C%20_)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20op%20%3D%20%5B%206%2C%20e%20%5D%2C%20y%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20finally%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%20%3D%20t%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(5%20%26%20op%5B0%5D)%20throw%20op%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value%3A%20op%5B0%5D%20%3F%20op%5B1%5D%20%3A%20void%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20done%3A%20!0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20f%2C%20y%2C%20t%2C%20g%2C%20_%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sent%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(1%20%26%20t%5B0%5D)%20throw%20t%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20t%5B1%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20trys%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ops%3A%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20g%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20next%3A%20verb(0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%3A%20verb(1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3A%20verb(2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20%22function%22%20%3D%3D%20typeof%20Symbol%20%26%26%20(g%5BSymbol.iterator%5D%20%3D%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20g%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20Object.defineProperty(exports%2C%20%22__esModule%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3A%20!0%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20var%20standalone_log_helper_1%20%3D%20__webpack_require__(2)%3B%0A%20%20%20%20%20%20%20%20!function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20__awaiter(this%2C%20void%200%2C%20void%200%2C%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20oldKeysToRemove%2C%20e_1%2C%20oldConsole%2C%20logTypes%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20__generator(this%2C%20function(_a)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20switch%20(_a.label)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_a.trys.push(%5B%200%2C%203%2C%20%2C%204%20%5D)%2C%20%5B%204%2C%20OfficeRuntime.AsyncStorage.getAllKeys()%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20oldKeysToRemove%20%3D%20_a.sent().filter(function(key)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20key.startsWith(StorageKeys.logHash)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20%5B%204%2C%20OfficeRuntime.AsyncStorage.multiRemove(oldKeysToRemove)%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20_a.sent()%2C%20%5B%203%2C%204%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%203%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20e_1%20%3D%20_a.sent()%2C%20console.error(%22Error%20clearing%20out%20initial%20AsyncStorage%22)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(e_1)%2C%20%5B%203%2C%204%20%5D%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20case%204%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20OfficeExtensionBatch.CoreUtility._logEnabled%20%3D%20!1%2C%20oldConsole%20%3D%20console%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logTypes%20%3D%20%5B%20%22log%22%2C%20%22info%22%2C%20%22warn%22%2C%20%22error%22%20%5D%2C%20console%20%3D%20__assign(%7B%7D%2C%20oldConsole)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20logTypes.forEach(function(methodName)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console%5BmethodName%5D%20%3D%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20(var%20args%20%3D%20%5B%5D%2C%20_i%20%3D%200%3B%20_i%20%3C%20arguments.length%3B%20_i%2B%2B)%20args%5B_i%5D%20%3D%20arguments%5B_i%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20shouldIgnore.apply(void%200%2C%20args)%20%7C%7C%20(oldConsole%5BmethodName%5D.apply(oldConsole%2C%20args)%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20writeToAsyncStorage(standalone_log_helper_1.generateLogString(args%2C%20methodName)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%20%5B%202%20%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D()%2C%20global.__generateFunctionBinding__%20%3D%20function(funcName%2C%20func)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20function%20handleError(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(funcName%20%2B%20%22%20threw%20an%20error%3A%20%22%20%2B%20e)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20args%20%3D%20arguments%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20result%20%3D%20func.apply(global%2C%20args)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%22object%22%20%3D%3D%20typeof%20result%20%26%26%20result.then%20%3F%20result.then(function(value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D).catch(function(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20handleError(e)%2C%20e%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%20%3A%20result%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20handleError(e)%2C%20e%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%2C%20global.__generateErrorFunction__%20%3D%20function(funcName%2C%20error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20errorText%20%3D%20funcName%20%2B%20%22%20could%20not%20be%20registered%20due%20to%20an%20error%20while%20loading%20the%20snippet%3A%20%22%20%2B%20error%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20console.error(errorText)%2C%20new%20Error(errorText)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20var%20logCounter%20%3D%200%2C%20StorageKeys%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20logHash%3A%20%22cf_logs%23%22%0A%20%20%20%20%20%20%20%20%7D%2C%20SHOULD_IGNORE_REGEX%20%3D%20%2F%5E%5Cw%2B%20CustomFunctions%20%5C%5BExecution%5C%5D%20%5C%5B(Begin%7CEnd)%5C%5D.*%2F%3B%0A%20%20%20%20%7D).call(exports%2C%20__webpack_require__(1))%3B%0A%7D%2C%20function(module%2C%20exports)%20%7B%0A%20%20%20%20var%20g%3B%0A%20%20%20%20g%20%3D%20function()%20%7B%0A%20%20%20%20%20%20%20%20return%20this%3B%0A%20%20%20%20%7D()%3B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20g%20%3D%20g%20%7C%7C%20Function(%22return%20this%22)()%20%7C%7C%20(0%2C%20eval)(%22this%22)%3B%0A%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%22object%22%20%3D%3D%20typeof%20window%20%26%26%20(g%20%3D%20window)%3B%0A%20%20%20%20%7D%0A%20%20%20%20module.exports%20%3D%20g%3B%0A%7D%2C%20function(module%2C%20exports%2C%20__webpack_require__)%20%7B%0A%20%20%20%20%22use%20strict%22%3B%0A%20%20%20%20function%20generateLogString(args%2C%20severityType)%20%7B%0A%20%20%20%20%20%20%20%20var%20message%20%3D%20%22%22%2C%20isSuccessfulMsg%20%3D%20!0%3B%0A%20%20%20%20%20%20%20%20return%20args.forEach(function(element%2C%20index%2C%20array)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%20%2B%3D%20stringifyPlusPlus(element)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20isSuccessfulMsg%20%3D%20!1%2C%20message%20%2B%3D%20%22%3CUnable%20to%20log%3E%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20message%20%2B%3D%20%22%5Cn%22%3B%0A%20%20%20%20%20%20%20%20%7D)%2C%20message.length%20%3E%200%20%26%26%20(message%20%3D%20message.trim())%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20message%3A%20message%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20severity%3A%20isSuccessfulMsg%20%3F%20severityType%20%3A%20%22error%22%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20stringifyPlusPlus(object)%20%7B%0A%20%20%20%20%20%20%20%20if%20(null%20%3D%3D%3D%20object)%20return%20%22null%22%3B%0A%20%20%20%20%20%20%20%20if%20(void%200%20%3D%3D%3D%20object)%20return%20%22undefined%22%3B%0A%20%20%20%20%20%20%20%20if%20(%22string%22%20%3D%3D%20typeof%20object)%20return%20object%3B%0A%20%20%20%20%20%20%20%20if%20(object%20instanceof%20Error)%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22ERROR%3A%20%5Cn%22%20%2B%20jsonStringify(object)%3B%0A%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20stringifyPlusPlus(object.toString())%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%22%5Bobject%20Object%5D%22%20!%3D%3D%20object.toString()%20%3F%20object.toString()%20%3A%20jsonStringify(object)%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20jsonStringify(object)%20%7B%0A%20%20%20%20%20%20%20%20function%20getStringifiableSnapshot(object)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20function%20tryAddName(name)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20hasOwnProperty%20%3D%20Object.prototype.hasOwnProperty%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name.indexOf(%22%20%22)%20%3C%200%20%26%26%20!hasOwnProperty.call(snapshot%2C%20name)%20%26%26%20Object.defineProperty(snapshot%2C%20name%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20configurable%3A%20!0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20enumerable%3A%20!0%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20get%3A%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20object%5Bname%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20snapshot%20%3D%20%7B%7D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20current%20%3D%20object%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Object.keys(current).forEach(tryAddName)%2C%20current%20%3D%20Object.getPrototypeOf(current)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20while%20(current)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20snapshot%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20object%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20JSON.stringify(object%2C%20function(key%2C%20value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20value%20%26%26%20%22object%22%20%3D%3D%20typeof%20value%20%26%26%20!Array.isArray(value)%20%3F%20getStringifiableSnapshot(value)%20%3A%20value%3B%0A%20%20%20%20%20%20%20%20%7D%2C%204)%3B%0A%20%20%20%20%7D%0A%20%20%20%20Object.defineProperty(exports%2C%20%22__esModule%22%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20!0%0A%20%20%20%20%7D)%2C%20exports.generateLogString%20%3D%20generateLogString%2C%20exports.stringifyPlusPlus%20%3D%20stringifyPlusPlus%3B%0A%7D%2C%20function(module%2C%20exports%2C%20__webpack_require__)%20%7B%0A%20%20%20%20module.exports%20%3D%20__webpack_require__(0)%3B%0A%7D%20%5D)%3B\n",ut=n(14),lt=n(344),dt=n.n(lt),ft=n(455),pt="userSettings";function mt(){return JSON.parse(localStorage.getItem(pt)||"{}")}var ht=/(@\w+\.customfunction\s*\(\s*")(.*)(".*)/,gt=/[^0-9A-Za-z_ ]/g;function bt(e){return e.replace(gt,"").split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join("")}function yt(e){var t=e.solution,n=e.namespace,r=e.fileContent;if(dt.a.transpileModule(r,{reportDiagnostics:!0,compilerOptions:{target:dt.a.ScriptTarget.ES5,allowJs:!0,lib:["dom","es2015"]}}).diagnostics.length>0)return[{javascriptFunctionName:"compileError",nonCapitalizedFullName:n+".CompileError",status:"error",errors:["Could not compile the snippet. Please go back to the code editor to fix any syntax errors."],metadata:null}];var o=Object(ft.parseTree)(r,t.name,Ot());if(o.functions.length!==o.extras.length)throw new Error("Internal error while parsing custom function snippets.");var a=o.functions.map(function(e,r){var a=o.extras[r],i=a.javascriptFunctionName,c=n+"."+(i.toUpperCase()===e.name.toUpperCase()?i:e.name);return e.name=n.toUpperCase()+"."+e.name,e.id=n.toUpperCase()+"."+e.id,Object(le.strictType)({javascriptFunctionName:i,nonCapitalizedFullName:c,status:a.errors.length>0?"error":t.options.isUntrusted?"untrusted":"good",errors:Object(ge.a)(t.options.isUntrusted?["You must trust the snippet before its functions can be registered"]:[]).concat(Object(ge.a)(a.errors)),metadata:e})});return a.forEach(function(e,t){a.forEach(function(n,r){t!==r&&e.javascriptFunctionName===n.javascriptFunctionName&&(e.status="error",e.errors=['Duplicate implementation for function "'.concat(e.javascriptFunctionName,'"')])})}),a.forEach(function(e,t){a.forEach(function(n,r){t!==r&&e.metadata.name.toUpperCase()===n.metadata.name.toUpperCase()&&(e.status="error",e.errors=['Duplicate function names "'.concat(e.metadata.name,'"')])})}),a.find(function(e){return"error"===e.status})&&a.forEach(function(e){"good"===e.status&&(e.status="skipped",e.errors=["Skipping due to errors in other functions in the same snippet."])}),a}function Ot(){var e=mt();return{experimental:{allowRepeatingParameters:Boolean(e["experimental.customFunctions.allowRepeatingParameters"])}}}function vt(e){var t={functions:e.filter(function(e){return"good"===e.status}).map(function(e){return e.metadata})};return JSON.stringify(t,null,4)}function jt(e,t){return St.apply(this,arguments)}function St(){return(St=Object(k.a)(A.a.mark(function e(t,n){var r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=vt(t),!Office.context.requirements.isSetSupported("CustomFunctions",1.6)){e.next=6;break}return e.next=4,Excel.CustomFunctionManager.register(r,n);case 4:e.next=8;break;case 6:return e.next=8,Excel.run(function(){var e=Object(k.a)(A.a.mark(function e(t){var o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Office.context.platform===Office.PlatformType.OfficeOnline?(o=("ScriptLab"+("local"===Object(we.getCurrentEnv)()?"Dev":"")).toUpperCase(),t.workbook.registerCustomFunctions(o,r,"","en-us",o)):Excel.CustomFunctionManager.newObject(t).register(r,n),e.next=3,t.sync();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function _t(){return wt.apply(this,arguments)}function wt(){return(wt=Object(k.a)(A.a.mark(function e(){var t,n,r,o,a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=function(){return(a=Object(k.a)(A.a.mark(function e(t){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.abrupt("return",Excel.run(function(){var e=Object(k.a)(A.a.mark(function e(n){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 5:if(e.prev=5,e.t0=e.catch(1),!(e.t0 instanceof OfficeExtension.Error&&e.t0.code===Excel.ErrorCodes.invalidOperationInCellEditMode)){e.next=14;break}return e.next=11,Object(le.pause)(2e3);case 11:return e.abrupt("continue",0);case 14:return e.abrupt("return",{enabled:!1});case 15:e.next=0;break;case 17:case"end":return e.stop()}},e,this,[[1,5]])}))).apply(this,arguments)},o=function(e){return a.apply(this,arguments)},r=function(){return(r=Object(k.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Office.context.requirements.isSetSupported("CustomFunctions",1.6)){e.next=7;break}return e.next=3,Excel.CustomFunctionManager.getStatus();case 3:return t=e.sent,e.abrupt("return",{enabled:t.enabled,nativeRuntime:t.nativeRuntime});case 7:return e.abrupt("return",o(function(){var e=Object(k.a)(A.a.mark(function e(t){var n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Excel.CustomFunctionManager.newObject(t).load("status"),e.next=3,t.sync();case 3:return e.abrupt("return",{enabled:n.status.enabled,nativeRuntime:n.status.nativeRuntime});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)},n=function(){return r.apply(this,arguments)},e.prev=4,Office.context.requirements.isSetSupported("CustomFunctions",1.4)){e.next=7;break}return e.abrupt("return",{enabled:!1});case 7:if(t=Office.context.platform,!(t===Office.PlatformType.PC||t===Office.PlatformType.Mac||t===Office.PlatformType.OfficeOnline)){e.next=11;break}return e.abrupt("return",n());case 11:return e.abrupt("return",{enabled:!1});case 14:return e.prev=14,e.t0=e.catch(4),console.error('Could not perform a "getCustomFunctionEngineStatus" check'),console.error(e.t0),e.abrupt("return",{enabled:!1});case 19:case"end":return e.stop()}},e,this,[[4,14]])}))).apply(this,arguments)}function Et(e){var t=[],n=[decodeURIComponent(st.trim())];return e.forEach(function(e){if(0!==e.name.length&&Object(ut.findScript)(e)){var r,o=bt(e.name),a=Object(ut.findScript)(e).content,i=yt({solution:e,namespace:o,fileContent:a}),c=i.some(function(e){return"error"===e.status});if(!c)try{r=it()(a),n.push(function(e,t){var n="\n        ";return Object(ct.stripSpaces)("\n    (function () {\n      try {\n        // TODO external code\n        ".concat(e.split("\n").map(function(e){return n+e}).join(""),"\n        ").concat(r(!0),"\n      } catch (e) {\n        ").concat(r(!1),"\n      }\n    })();\n  ")).split("\n").map(function(e){return e.trimRight()}).join("\n");function r(e){return t.map(function(t){return'CustomFunctions.associate("'.concat(t.fullId,'", ').concat(e?'__generateFunctionBinding__("'.concat(t.fullDisplayName,'", ').concat(t.javascriptFunctionName,")"):'__generateErrorFunction__("'.concat(t.fullDisplayName,'", e)'),");")}).join(n)}}(r,i.map(function(e){return{fullId:e.metadata.id,fullDisplayName:e.metadata.name,javascriptFunctionName:e.javascriptFunctionName}})))}catch(s){i.forEach(function(e){e.status="error",e.errors=e.errors||[],e.errors.unshift("Snippet compiler error")}),c=!0}i.forEach(function(e){return t.push(e)})}}),{parseResults:t,code:n.join("\n\n")}}var xt=function(e){return e.filter(function(e){return e.options.isCustomFunctionsSolution})},At=n(99);function kt(){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(k.a)(A.a.mark(function e(){var t,n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,OfficeRuntime.AsyncStorage.getAllKeys();case 2:return e.t0=function(e){return e.startsWith(Ee.CF_LOGS_ROOT)},t=e.sent.filter(e.t0),e.next=6,OfficeRuntime.AsyncStorage.multiGet(t);case 6:return e.t1=function(e){var t=Object(At.a)(e,2),n=(t[0],t[1]);return JSON.parse(n)},n=e.sent.map(e.t1),e.next=10,OfficeRuntime.AsyncStorage.multiRemove(t);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Tt=n(189),It=n.n(Tt),Dt=n(19),Lt=function(e,t){var n=e.solutions.metadata[t];if(!n)return null;var r=n.options.isCustomFunctionsSolution,o=n.files.map(function(t){return Mt(e,t)}).filter(function(e){return e.name===ut.SCRIPT_FILE_NAME})[0],a=o&&"python"===o.language,i=n.files.map(function(t){return Mt(e,t)}).filter(function(e){return r?[ut.SCRIPT_FILE_NAME].concat(Object(ge.a)(a?[]:[ut.LIBRARIES_FILE_NAME])).includes(e.name):!a||e.name===ut.SCRIPT_FILE_NAME});return Object(be.a)({},n,{files:i})},Bt=function(e,t){var n=e.solutions.metadata[t];if(!n)return null;var r=n.files.map(function(t){return Mt(e,t)});return Object(be.a)({},n,{files:r})},Pt=function(e){return Object.values(e.solutions.metadata).filter(function(t){return t.host===e.host||"ALL"===t.host}).filter(function(e){var t=e.id;return![z,F].includes(t)}).map(function(t){return Object(be.a)({},t,{files:t.files.map(function(t){return Mt(e,t)})})})},Rt=function(e){return Pt(e).sort(function(e,t){return t.dateLastModified-e.dateLastModified})},Nt=function(e){return Pt(e).sort(function(e,t){return t.dateLastOpened-e.dateLastOpened})},Ut=function(e){var t=Rt(e);return t.length>0?t[0].dateLastModified:0},Ft=function(e){var t=xt(Rt(e));return t.length>0?t[0].dateLastModified:0},Mt=function(e,t){return e.solutions.files[t]},Gt=function(e,t){return t.map(function(t){return Mt(e,t)})},Ht=n(108),Wt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{withHiddenFiles:!1},n=e.editor.active.solutionId;if(n){var r=(t.withHiddenFiles?Bt:Lt)(e,n);if(r)return r}return K},zt=function(e){var t=Rt(e);return t.length>0?t[0].dateLastModified:0},Kt=function(e){var t=Wt(e),n=t.files.find(function(t){return t.id===e.editor.active.fileId});return n||(!n&&t.files.length>0?t.files[0]:W)},Jt=function(e){return e.editor.intellisenseFiles},qt=function(e){var t=Wt(e);return!!t&&t.options.isCustomFunctionsSolution},Vt=function(e){var t=Wt(e);if(!t)return!1;var n=Object(ut.findScript)(t);return!!n&&n.language===Ht.languageMapLowercased.python},Yt=Object(Dt.createSelector)([Wt],function(e){return!e.options.isUntrusted}),Qt=n(174),$t=function(e){return e.host},Xt=function(e){return he.Utilities.host===he.HostType.WEB},Zt=function(e){return he.Utilities.platform===he.PlatformType.PC},en=Object(Dt.createSelector)([$t,function(e){return e.host===he.Utilities.host}],function(e,t){return e!==he.HostType.OUTLOOK&&t&&!Object(Qt.isPoppedOut)()}),tn=n(562),nn=function(e){return e.github.loginInfo?e.github.loginInfo.token:null},rn=function(e){return e.github.loginInfo?e.github.loginInfo.profilePicUrl:null},on=function(e){return e.github.loginInfo?e.github.loginInfo.username:null},an=function(e){return e.github.isLoggingInOrOut},cn=function(e){return e.github.isAuthDialogVisible},sn=Object(Dt.createSelector)([nn],function(e){return!!e}),un=function(e){return e.screen.width},ln=function(e){return e.screen.height},dn=Object(Dt.createSelector)([un],function(e){return e<475}),fn=n(4),pn=Object(fn.createAction)("DIALOG_SHOW",function(e){return function(t){var n=t.title,r=t.subText,o=t.buttons,a=t.style,i=void 0===a?He.a.largeHeader:a,c=t.isBlocking;return e({title:n,subText:r,buttons:o,style:i,isBlocking:void 0!==c&&c})}}),mn=Object(fn.createAction)("DIALOG_DISMISS"),hn=Object(fn.createAction)("DIALOG_HIDE"),gn=Object(fn.createAction)("DIALOG_RESET"),bn=Object(fn.createAction)("EDITOR_OPEN"),yn=Object(fn.createAction)("EDITOR_HIDE"),On=Object(fn.createAction)("BACKSTAGE_OPEN"),vn=Object(fn.createAction)("BACKSTAGE_HIDE"),jn=Object(fn.createAction)("EDITOR_OPEN_FILE",function(e){return function(t){return e(t)}}),Sn=Object(fn.createAction)("EDITOR_SET_ACTIVE",function(e){return function(t){return e(t)}}),_n=Object(fn.createAction)("EDITOR_ON_MOUNT",function(e){return function(t){return e(t)}}),wn=Object(fn.createAction)("EDITOR_APPLY_MONACO_OPTIONS"),En=Object(fn.createAsyncAction)("EDITOR_SET_INTELLISENSE_FILES_REQUEST","EDITOR_SET_INTELLISENSE_FILES_SUCCESS","EDITOR_SET_INTELLISENSE_FILES_FAILURE")(),xn=Object(fn.createAction)("EDITOR_REMOVE_INTELLISENSE_FILES",function(e){return function(t){return e(t)}}),An=Object(fn.createAction)("APPLY_FORMATTING"),kn=Object(fn.createAction)("NEW_SOLUTION_OPENED",function(e){return function(t){return e(t)}}),Cn=Object(fn.createAction)("NEW_FILE_OPENED",function(e){return function(t,n){return e({solution:t,file:n})}}),Tn=Object(fn.createAction)("NAVIGATE_TO_RUN"),In=Object(fn.createAction)("EDITOR_SHOULD_UPDATE_INTELLISENSE"),Dn=Object(fn.createAsyncAction)("IMPORT_GIST_REQUEST","IMPORT_GIST_SUCCESS","IMPORT_GIST_FAILURE")(),Ln=Object(fn.createAsyncAction)("CREATE_GIST_REQUEST","CREATE_GIST_SUCCESS","CREATE_GIST_FAILURE")(),Bn=Object(fn.createAsyncAction)("UPDATE_GIST_REQUEST","UPDATE_GIST_SUCCESS","UPDATE_GIST_FAILURE")(),Pn=Object(fn.createAsyncAction)("FETCH_GIST_METADATA_REQUEST","FETCH_GIST_METADATA_SUCCESS","FETCH_GIST_METADATA_FAILURE")(),Rn=Object(fn.createAsyncAction)("GET_GIST_REQUEST","GET_GIST_SUCCESS","GET_GIST_FAILURE")(),Nn=Object(fn.createAction)("GITHUB_LOGIN_SHOW_DIALOG"),Un=Object(fn.createAction)("GITHUB_LOGIN_SUCCESS",function(e){return function(t){return e(t)}}),Fn=Object(fn.createAction)("GITHUB_LOGIN_CANCEL"),Mn=Object(fn.createAction)("GITHUB_LOGOUT"),Gn=Object(fn.createAction)("HOST_CHANGE",function(e){return function(t){return e(t)}}),Hn=Object(fn.createAction)("MESSAGE_BAR_SHOW",function(e){return function(t){var n=Object(be.a)({isVisible:!0,style:fe.a.info,link:null},t);return e(n)}}),Wn=Object(fn.createAction)("MESSAGE_BAR_HIDE"),zn=Object(fn.createAction)("INITIALIZING"),Kn=Object(fn.createAction)("SWITCH_ENVIRONMENT",function(e){return function(t){return e(t)}}),Jn=Object(fn.createAction)("CONFIRM_SWITCH_ENVIRONMENT",function(e){return function(t){return e(t)}}),qn=Object(fn.createAction)("HIDE_LOADING_SPLASH_SCREEN"),Vn=Object(fn.createAction)("POP_OUT_EDITOR"),Yn=Object(fn.createAction)("GOTO_CUSTOM_FUNC_DASH"),Qn=Object(fn.createAsyncAction)("FETCH_ALL_SAMPLES_METADATA_REQUEST","FETCH_ALL_SAMPLES_METADATA_SUCCESS","FETCH_ALL_SAMPLES_METADATA_FAILURE")(),$n=Object(fn.createAsyncAction)("GET_SAMPLE_REQUEST","GET_SAMPLE_SUCCESS","GET_SAMPLE_FAILURE")(),Xn=Object(fn.createAction)("SCREEN_UPDATE_SIZE",function(e){return function(t){return e(t)}}),Zn=Object(fn.createAsyncAction)("SETTINGS_EDIT_REQUEST_NOT_USED","SETTINGS_EDIT_SUCCESS","SETTINGS_EDIT_FAILURE")(),er=Object(fn.createAction)("SETTINGS_SET_LAST_ACTIVE",function(e){return function(t){return e(t)}}),tr=Object(fn.createAction)("SETTINGS_OPEN"),nr=Object(fn.createAction)("SETTINGS_CLOSE"),rr=Object(fn.createAction)("SETTINGS_EDIT",function(e){return function(t){return e(t)}}),or=Object(fn.createAction)("SETTINGS_CYCLE_EDITOR_THEME"),ar=Object(fn.createAction)("SOLUTIONS_CREATE_NEW"),ir=Object(fn.createAction)("SOLUTIONS_ADD",function(e){return function(t){return e(t)}}),cr=Object(fn.createAction)("SOLUTIONS_EDIT",function(e){return function(t){var n=t.id,r=t.solution,o=t.fileId,a=t.file;return e({id:n,solution:r,fileId:o,file:a,timestamp:Date.now()})}}),sr=Object(fn.createAction)("SOLUTION_CHANGE_LANGUAGE",function(e){return function(t){var n=t.solutionId,r=t.fileId,o=t.language;return e({solutionId:n,fileId:r,language:o})}}),ur=Object(fn.createAction)("SOLUTIONS_UPDATE_LAST_OPENED",function(e){return function(t){var n=t.solutionId,r=t.fileId;return e({solutionId:n,fileId:r,timestamp:Date.now()})}}),lr=Object(fn.createAction)("SOLUTIONS_REMOVE",function(e){return function(t){return e(t)}}),dr=Object(fn.createAction)("SOLUTIONS_DELETE",function(e){return function(t){return e(t)}}),fr=Object(fn.createAsyncAction)("GET_DEFAULT_SAMPLE_REQUEST","GET_DEFAULT_SAMPLE_SUCCESS","GET_DEFAULT_SAMPLE_FAILURE")(),pr=Object(fn.createAction)("SOLUTIONS_UPDATE_OPTIONS",function(e){return function(t){return e(t)}}),mr=Object(fn.createAction)("SOLUTION_SCRIPT_NEEDS_PARSING",function(e){return function(t){return e(t)}}),hr={dialog:s,editor:u,gists:l,github:d,host:f,messageBar:p,misc:m,samples:h,screen:g,settings:b,solutions:y},gr={dialog:s,editor:u,gists:l,github:d,messageBar:p,misc:m,solutions:y,settings:b},br=Object(Dt.createSelector)([Wt],function(e){switch(e.id){case z:return"null-solution";case F:return"settings";default:return"normal"}});P.a.parse(window.location.search).commands&&(sessionStorage.should_split_run_button=!0);var yr=Object(Dt.createSelector)([Wt,en,qt,Yt],function(e,t,n,r){var o=gr.messageBar.show({style:fe.a.error,text:"You must trust the snippet before you can run it.",button:{text:"Trust",action:gr.solutions.updateOptions({id:e.id,options:{isUntrusted:!1}})}});return t?n?[{key:"register-cf",text:"Register",iconProps:{iconName:"Play"},actionCreator:gr.misc.goToCustomFunctionsDashboard}]:[Object(be.a)({key:"run",text:"Run",iconProps:{iconName:"Play"}},sessionStorage.getItem("should_split_run_button")?{subMenuProps:{items:[{key:"run-in-this-pane",text:"Run in this pane",iconProps:{iconName:"Play"},actionCreator:r?gr.editor.navigateToRun:function(){return o}},{key:"run-side-by-side",text:"Run side-by-side",iconProps:{iconName:"OpenPaneMirrored"},actionCreator:r?function(){return gr.dialog.show({title:"Run side-by-side with editor",subText:'To run the snippet side-by-side with the editor, choose "Run" in the Ribbon.\n  Running side-by-side offers both a quicker refresh, and the added advantage of keeping your position and undo-history in the editor.',buttons:[{key:"got-it-button",text:"Got it",isPrimary:!0,action:gr.dialog.dismiss()}]})}:function(){return o}}]}}:{actionCreator:r?gr.editor.navigateToRun:function(){return o}})]:[]}),Or=gr.dialog.show({title:"Please sign in to GitHub",subText:"In order to use the gist functionality, you must first sign in to GitHub.",buttons:[{key:"sign-in",text:"Sign in",action:gr.github.showLoginDialog(),isPrimary:!0},{key:"cancel",text:"Cancel",action:s.dismiss(),isPrimary:!1}]}),vr=Object(Dt.createSelector)([br,Wt,dn,sn,yr],function(e,t,n,r,o){var a={style:{paddingRight:n?"0":"3rem"},iconProps:n?{iconName:"OfficeAddinsLogo"}:{},iconOnly:n};switch(e){case"null-solution":return[];case"settings":return[{key:"back",ariaLabel:"Back",iconOnly:!0,iconProps:{iconName:"Back"},actionCreator:gr.settings.close},Object(be.a)({key:"settings-title",text:t.name},a)];case"normal":var i=t.id;return[{key:"nav",ariaLabel:"Backstage",iconOnly:!0,iconProps:{iconName:"GlobalNavButton"},actionCreator:gr.editor.openBackstage},Object(be.a)({key:"solution-name",text:t.name},a)].concat(Object(ge.a)(o),[{key:"delete",text:"Delete",iconProps:{iconName:"Delete"},iconOnly:n,actionCreator:function(){return gr.dialog.show({title:"Delete Snippet?",subText:"Are you sure you want to delete '".concat(t.name,"'?"),buttons:[{key:"yes-button",isPrimary:!0,text:"Yes",action:gr.solutions.remove(t)},{key:"no-button",isPrimary:!1,text:"No",action:gr.dialog.dismiss()}]})}},{key:"share",text:"Share",iconProps:{iconName:"Share"},iconOnly:n,subMenuProps:{items:[{hidden:!(t.source&&"gist"===t.source.origin&&r),key:"update-gist",text:"Update existing gist",iconProps:{iconName:"Save"},actionCreator:function(){return gr.gists.update.request({solutionId:i})}},{key:"new-public-gist",text:"New public gist",iconProps:{iconName:"PageCheckedIn"},actionCreator:r?function(){return gr.gists.create.request({solutionId:i,isPublic:!0})}:function(){return Or}},{key:"new-secret-gist",text:"New secret gist",iconProps:{iconName:"ProtectedDocument"},actionCreator:r?function(){return gr.gists.create.request({solutionId:i,isPublic:!1})}:function(){return Or}},{key:"export-to-clipboard",text:"Copy to clipboard",iconProps:{iconName:"ClipboardSolid"},className:"export-snippet-to-clipboard"}].filter(function(e){return!e.hidden}).map(function(e){e.hidden;return Object(tn.a)(e,["hidden"])})}}]);default:throw new Error("Unknown mode: ".concat(e))}}),jr=Object(Dt.createSelector)([br,sn,an],function(e,t,n){switch(e){case"null-solution":case"settings":return[];case"normal":return[{key:"account",ariaLabel:t?"Logout":"Login",subMenuProps:t?{items:[{key:"logout",text:"Logout",actionCreator:gr.github.logout}]}:void 0,iconOnly:!0,actionCreator:n?void 0:gr.github.showLoginDialog},Object(Qt.shouldShowPopoutControl)("editor")?{key:"pop-out",ariaLabel:"Pop out editor",iconOnly:!0,iconProps:{iconName:"OpenInNewWindow"},actionCreator:gr.misc.popOutEditor}:null].filter(function(e){return null!=e});default:throw new Error("Unknown mode: ".concat(e))}}),Sr=n(228),_r={"editor.theme":"dark","editor.fontFamily":"Menlo","editor.fontSize":14,"editor.minimap":!1,"editor.tabSize":2,"editor.prettier":!0,"editor.prettier.autoFormat":!0,"editor.folding":!0,"editor.wordWrap":"bounded"},wr={"jupyter.url":"","jupyter.token":"","jupyter.notebook":"","jupyter.clearOnRegister":"","experimental.customFunctions.allowRepeatingParameters":"",customFunctionsRuntimeUrl:""},Er={"editor.theme":["dark","light","high-contrast"],"editor.fontFamily":["Menlo","Consolas","Courier New","Source Code Pro"],"editor.wordWrap":["bounded","on","off"],"editor.tabSize":[2,4]},xr=function(e){return e&&e["editor.tabSize"]?e["editor.tabSize"]:_r["editor.tabSize"]},Ar=function(e){var t=xr(e);return Oe.a.safeDump(_r,{indent:t})},kr=function(e){if(0===Object.keys(e).length)return"";var t=xr(e);return Oe.a.safeDump(e,{indent:t})},Cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Date.now(),n=function(e,t){return[{id:M,name:"User Settings",dateCreated:e,dateLastModified:e,dateLastOpened:e,language:"YAML",content:kr(t)},{id:G,name:"Default Settings",dateCreated:e,dateLastModified:e,dateLastOpened:e,language:"YAML",content:Ar(t)},{id:"about",name:"About",dateCreated:e,dateLastModified:e,dateLastOpened:e,language:"plaintext",content:["Last Updated: ".concat("Mon, 29 Mar 2021 22:49:00 GMT"),"Commit: https://github.com/OfficeDev/script-lab-react/commits/".concat("8eb2f132f3092cebcc5e3e4e736dcd104eaf0574"),"Environment: ".concat(we.environmentDisplayName)].join("\n")}]}(t,e);return{solution:function(e,t){return{id:F,name:"Settings",options:{},dateCreated:t,dateLastModified:t,dateLastOpened:t,host:"ALL",files:e.map(function(e){return e.id})}}(n,t),files:n}},Tr=function(e){return Wt(e).id===F},Ir=function(e){return Object(be.a)({},_r,e.settings.userSettings)},Dr=function(e){return e.settings.userSettings},Lr=function(e){return{light:"vs",dark:"vs-dark","high-contrast":"hc-black"}[Ir(e)["editor.theme"]]},Br=function(e){return{light:"Light",dark:"Dark","high-contrast":"High Contrast"}[Ir(e)["editor.theme"]]},Pr=function(e){var t=$t(e),n=Object(Sr.getTheme)(t);return{light:n.white,dark:n.neutralDarker,"high-contrast":n.black}[Ir(e)["editor.theme"]]},Rr=function(e){return Ir(e)["editor.tabSize"]},Nr=function(e){return Ir(e)["editor.prettier"]},Ur=function(e){return Ir(e)["editor.prettier.autoFormat"]},Fr=function(e){var t=Ir(e);return{theme:Lr(e),fontSize:t["editor.fontSize"],lineHeight:1.35*t["editor.fontSize"],fontFamily:[t["editor.fontFamily"],"Menlo","Source Code Pro","Consolas","Courier New","monospace"].map(function(e){return e.includes(" ")?JSON.stringify(e):e}).join(", "),readOnly:J.includes(Kt(e).id),lineNumbers:"about"!==Kt(e).id?"on":"off",minimap:{enabled:t["editor.minimap"]},folding:t["editor.folding"],wordWrap:t["editor.wordWrap"],scrollbar:{vertical:"visible",arrowSize:15},formatOnPaste:!0,glyphMargin:!1,fixedOverflowWidgets:!0,ariaLabel:"editor",wordWrapColumn:120,wrappingIndent:"indent",selectOnLineNumbers:!0}};function Mr(){var e=mt(),t=["jupyter.url","jupyter.token","jupyter.notebook"].map(function(t){return e[t]});if(t.filter(function(e){return e&&e.length>0}).length<t.length)return null;var n=Object(At.a)(t,3);return{url:n[0],token:n[1],notebook:n[2]}}var Gr={dialog:s,editor:u,gists:l,github:d,host:f,messageBar:p,misc:m,solutions:y,settings:b},Hr=Object(Dt.createSelector)([br,Xt,$t],function(e,t,n){return[{hidden:!t,"data-testid":"host-selector",key:"host-selector",text:n,subMenuProps:{isBeakVisible:!0,shouldFocusOnMount:!0,items:Object.keys(he.HostType).map(function(e){return he.HostType[e]}).filter(function(e){return e!==n}).map(function(e){return{key:e,text:e,actionCreator:function(){return Gr.host.change(e)}}})}},{hidden:"settings"!==e,key:"environment-switcher",text:we.environmentDisplayName,subMenuProps:{items:Object(we.getVisibleEnvironmentKeysToSwitchTo)().map(function(e){return{key:e,text:we.environmentDisplayNames[e],actionCreator:function(){return Gr.misc.switchEnvironment(e)}}})}}]}),Wr=Object(Dt.createSelector)([br,Wt,Kt,Br],function(e,t,n,r){return[{hidden:!Ht.languageMapLowercased[n.language],key:"editor-language",text:Ht.languageMapDisplayNames[n.language],subMenuProps:n.name===ut.SCRIPT_FILE_NAME&&Mr()?{isBeakVisible:!0,items:[Ht.languageMapLowercased.typescript,Ht.languageMapLowercased.python].map(function(e){return{key:e,text:Ht.languageMapDisplayNames[e],actionCreator:function(){return Gr.solutions.changeLanguage({solutionId:t.id,fileId:n.id,language:e})}}})}:null},{hidden:"settings"===e,key:"cycle-theme",iconProps:{iconName:"Color",styles:{root:{fontSize:"1.2rem"}}},text:r,ariaLabel:"Cycle editor theme",actionCreator:Gr.settings.cycleEditorTheme},{hidden:"cdn"===Object(we.getCurrentEnv)(),key:"report-an-issue",iconOnly:!0,iconProps:{iconName:"Emoji2"},href:q,target:"_blank",text:"Report an Issue",ariaLabel:"Report an issue"},{key:"settings",iconOnly:!0,iconProps:{iconName:"Settings"},text:"Settings",ariaLabel:"Settings",actionCreator:Gr.settings.open}]}),zr=function(e){return Object.values(e.gists).filter(function(t){return t.host===e.host})},Kr=function(e){return Object.values(e.samples||{}).filter(function(t){return t.host===e.host}).reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.group,Object(ge.a)(e[t.group]||[]).concat([t])))},{})},Jr={editor:o,footer:S,gists:_,github:i,header:v,host:a,samples:w,screen:c,settings:j,solutions:r},qr=n(177),Vr=n.n(qr),Yr=function(e){return[{name:ut.SCRIPT_FILE_NAME,language:"TypeScript",content:'$("#run").click(() => tryCatch(run));\n\nasync function run() {\n    console.log("Hello World");\n}\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n    try {\n        await callback();\n    }\n    catch (error) {\n        OfficeHelpers.UI.notify(error);\n        OfficeHelpers.Utilities.log(error);\n    }\n}\n'},{name:"index.html",language:"HTML",content:'<p class="ms-font-m">Executes a simple code snippet.</p>\n<button id="run" class="ms-Button">\n    <span class="ms-Button-label">Run code</span>\n</button>\n'},{name:"index.css",language:"CSS",content:""},{name:ut.LIBRARIES_FILE_NAME,language:"libraries",content:"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\nhttps://appsforoffice.microsoft.com/lib/1/hosted/office.d.ts\n\noffice-ui-fabric-js@1.4.0/dist/css/fabric.min.css\noffice-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css\n\ncore-js@2.4.1/client/core.min.js\n@types/core-js\n\n@microsoft/office-js-helpers@0.7.4/dist/office.helpers.min.js\n@microsoft/office-js-helpers@0.7.4/dist/office.helpers.d.ts\n\njquery@3.1.1\n@types/jquery"}].map(function(t){return Object(be.a)({},t,{id:Vr()(),dateCreated:e,dateLastModified:e,dateLastOpened:e})})},Qr=function(e){var t=Date.now();return function(e,t,n){return{id:Vr()(),name:"Blank Snippet",host:e,dateCreated:n,dateLastModified:n,dateLastOpened:n,options:{},files:t}}(e,Yr(t),t)};var $r=function(e){var t,n=e.name,r=e.description,o=e.script,a=e.template,i=e.style,c=e.libraries,s=e.host,u=Yr(Date.now()),l=Object.entries((t={},Object(R.a)(t,ut.SCRIPT_FILE_NAME,o),Object(R.a)(t,"index.html",a),Object(R.a)(t,"index.css",i),Object(R.a)(t,ut.LIBRARIES_FILE_NAME,{content:c,language:"libraries"}),t)).map(function(e){var t=Object(At.a)(e,2),n=t[0],r=t[1];return r?function(e,t){var n=t.content,r=t.language;return{id:Vr()(),name:e,content:n,language:r,dateCreated:Date.now(),dateLastModified:Date.now(),dateLastOpened:Date.now()}}(n,r):u.find(function(e){return e.name===n})});return{id:Vr()(),name:n,host:s,description:r,options:{},files:l,dateCreated:Date.now(),dateLastModified:Date.now(),dateLastOpened:Date.now()}},Xr=function(e){var t=e.name,n=e.description,r=e.host,o=e.files,a=Object(ut.findScript)(e),i=a.language===Ht.languageMapLowercased.python?{script:{content:a.content,language:a.language}}:Object.entries({script:function(e){return e.name===ut.SCRIPT_FILE_NAME},template:function(e){return"index.html"===e.name},style:function(e){return"index.css"===e.name},libraries:function(e){return e.name===ut.LIBRARIES_FILE_NAME}}).map(function(e){var t=Object(At.a)(e,2),n=t[0],r=t[1];return[n,o.find(r)]}).filter(function(e){var t=Object(At.a)(e,2);t[0];return void 0!==t[1]}).reduce(function(e,t){var n=Object(At.a)(t,2),r=n[0],o=n[1];return Object(be.a)({},e,Object(R.a)({},r,o.name===ut.LIBRARIES_FILE_NAME?o.content||"":{content:o.content,language:o.language}))},{});return Object(be.a)({name:t,description:n,host:r,api_set:{}},i)},Zr=n(55),eo=n(5),to=n(924),no=n.n(to),ro=A.a.mark(so),oo=A.a.mark(lo),ao=A.a.mark(fo),io=A.a.mark(po),co=A.a.mark(mo);function so(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(b.editFile),lo);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(b.open),fo);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(b.close),po);case 6:return e.next=8,Object(eo.e)(Object(fn.getType)(b.cycleEditorTheme),mo);case 8:case"end":return e.stop()}},ro,this)}var uo=function(e){var t=Object(ge.a)(Object.keys(_r)).concat(Object(ge.a)(Object.keys(wr))),n=Object.keys(e),r=Object.keys(Er),o=n.filter(function(e){return!t.includes(e)});if(o.length>0)throw new Error("Unrecognized keys: ".concat(o.join(", ")));var a={};return Object.keys(e).forEach(function(t){if(r.includes(t)&&!Er[t].includes(e[t]))throw new Error("'".concat(e[t],"' is not an allowed value for '").concat(t,"'. ")+"Allowed values include: ".concat(Er[t].map(function(e){return'"'.concat(e,'"')}).join(", "),"."));a[t]=e[t]}),a};function lo(e){var t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t=""===e.payload.newSettings.trim(),n=t?{}:uo(Oe.a.safeLoad(e.payload.newSettings)),r=Object(be.a)({},_r,n)["editor.tabSize"],a.next=6,Object(eo.d)(Jr.solutions.getFile,M);case 6:return(o=a.sent).content=t?"":Oe.a.safeDump(n,{indent:r}),a.next=10,Object(eo.c)(b.edit.success({userSettings:n}));case 10:return a.next=12,Object(eo.c)(y.edit({id:F,fileId:M,file:o}));case 12:a.next=18;break;case 14:return a.prev=14,a.t0=a.catch(0),a.next=18,Object(eo.c)(b.edit.failure(a.t0));case 18:case"end":return a.stop()}},oo,this,[[0,14]])}function fo(e){var t,n,r,o,a,i,c;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.d)();case 2:if(t=e.sent,n=t.editor,r=n.active,o=r.solutionId,a=r.fileId,o===F){e.next=15;break}return e.next=9,Object(eo.c)(b.setLastActive({solutionId:o,fileId:a}));case 9:return e.next=11,Object(eo.d)(Jr.settings.getUser);case 11:return i=e.sent,c=no()(i,{})?G:M,e.next=15,Object(eo.c)(u.openFile({solutionId:F,fileId:c}));case 15:case"end":return e.stop()}},ao,this)}function po(e){var t,n,r,o,a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.d)();case 2:return t=e.sent,n=t.settings,r=n.lastActive,o=r.solutionId,a=r.fileId,e.next=8,Object(eo.c)(u.openFile({solutionId:o,fileId:a}));case 8:case"end":return e.stop()}},io,this)}function mo(){var e,t,n,r,o,a,i,c,s;return A.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Object(eo.d)(Jr.settings.get);case 2:return e=u.sent,t=Er["editor.theme"],n=e["editor.theme"],r=t.indexOf(n),o=(r+1)%t.length,a=t[o],u.next=10,Object(eo.d)(Jr.settings.getUser);case 10:return i=u.sent,c=Object(be.a)({},i,{"editor.theme":a}),s=e["editor.tabSize"],u.next=15,Object(eo.c)(b.editFile({newSettings:JSON.stringify(c,null,s)}));case 15:case"end":return u.stop()}},co,this)}var ho,go=n(172),bo=n.n(go);function yo(){return(yo=Object(k.a)(A.a.mark(function e(){var t,n,r,o,a,i,c,s,u;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,bo()(),t=_o(),n=t.solutions,r=t.files,o=mt(),a=uo(o),i=Cr(a),n=Object(be.a)({},n,Object(R.a)({},F,i.solution)),r=Object(be.a)({},r,i.files.reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.id,t))},{})),c={userSettings:a,lastActive:{solutionId:null,fileId:null}},e.next=11,vo();case 11:return s=e.sent,e.abrupt("return",{solutions:{metadata:n,files:r},settings:c,github:s});case 15:return e.prev=15,e.t0=e.catch(0),console.error(e.t0),u=Cr(),e.abrupt("return",{solutions:{metadata:Object(R.a)({},F,u.solution),files:u.files.reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.id,t))},{})}});case 20:case"end":return e.stop()}},e,this,[[0,15]])}))).apply(this,arguments)}var Oo=function(e){Jr.editor.getActiveSolution(e).id!==z&&Object(Ee.writeIfChanged)(function(e){return Jr.editor.getActiveSolution(e,{withHiddenFiles:!0})},function(e){return e.id},e,ho,Ee.SOLUTION_ROOT),Object(Ee.writeIfChanged)(function(e){return{profilePicUrl:Jr.github.getProfilePicUrl(e),username:Jr.github.getUsername(e),token:Jr.github.getToken(e)}},Ee.GITHUB_KEY,e,ho),Object(Ee.writeIfChanged)(Jr.settings.getUser,pt,e,ho);var t,n=Jr.host.get(e),r=Jr.editor.getActiveSolution(e,{withHiddenFiles:!0});(t=r).id!==z&&t.id!==F?Object(Ee.writeIfChanged)(function(e){return Jr.editor.getActiveSolution(e,{withHiddenFiles:!0})},function(e){return"activeSolution_".concat(e.host)},e,ho):localStorage.setItem("activeSolution_".concat(n),"null");var o=Number(localStorage.getItem(Zr.localStorageKeys.editor.customFunctionsLastUpdatedCodeTimestamp));Jr.solutions.getCustomFunctionsLastModifiedDate(e)>=o&&localStorage.setItem(Zr.localStorageKeys.editor.customFunctionsLastUpdatedCodeTimestamp,Jr.solutions.getCustomFunctionsLastModifiedDate(e).toString()),ho=e};function vo(){return jo.apply(this,arguments)}function jo(){return(jo=Object(k.a)(A.a.mark(function e(){var t,n,r,o,a,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem(Ee.GITHUB_KEY))){e.next=4;break}return n=JSON.parse(t),e.abrupt("return",{loginInfo:Object(be.a)({fullName:null},n),isLoggingInOrOut:!1,isAuthDialogVisible:!1});case 4:if(!(r=localStorage.getItem("OAuth2Tokens"))){e.next=14;break}if(!((o=JSON.parse(r))&&"GitHub"in o)){e.next=14;break}if(!(a=o.GitHub.access_token)){e.next=14;break}return e.next=12,Ce(a);case 12:return i=e.sent,e.abrupt("return",{loginInfo:i,isLoggingInOrOut:!1,isAuthDialogVisible:!1});case 14:return e.abrupt("return",{loginInfo:null,isLoggingInOrOut:!1,isAuthDialogVisible:!1});case 15:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function So(e){Object(Ee.deleteItem)(Ee.SOLUTION_ROOT,e)}function _o(){var e={},t={},n=Object(Ee.getAllLocalStorageKeys)().filter(function(e){return e.startsWith(Ee.SOLUTION_ROOT)});return n.length>0?(n.map(function(e){return e.replace(Ee.SOLUTION_ROOT,"")}).map(function(e){return function(e){var t=Object(Ee.readItem)(Ee.SOLUTION_ROOT,e),n=Qr("");t.dateLastOpened||(t.dateLastOpened=t.dateLastModified);return t.files=t.files.map(function(e){return e.dateLastOpened||(e.dateLastOpened=e.dateLastModified),e}),Object(be.a)({},n,t)}(e)}).forEach(function(n){n.files.forEach(function(e){t[e.id]=e}),e[n.id]=Object(be.a)({},n,{files:n.files.map(function(e){return e.id})})}),e=wo(e)):(e=JSON.parse(localStorage.getItem("solutions")||"{}"),t=JSON.parse(localStorage.getItem("files")||"{}"),0===Object.keys(e).length&&It()(Object.keys(he.HostType).map(function(e){return he.HostType[e]}).map(function(e){var t=JSON.parse(localStorage.getItem("playground_".concat(e,"_snippets"))||"{}");return Object.keys(t).map(function(e){return t[e]}).map(function(e){return $r(e)})})).forEach(function(n){n.files.forEach(function(e){t[e.id]=e}),e[n.id]=Object(be.a)({},n,{files:n.files.map(function(e){return e.id})})}),e=wo(e),Object.keys(e).map(function(t){return e[t]}).map(function(e){return Object(be.a)({},e,{files:e.files.map(function(e){return t[e]})})}).map(function(e){return Object(Ee.writeItem)(Ee.SOLUTION_ROOT,e.id,e)})),localStorage.removeItem("solutions"),localStorage.removeItem("files"),Object.keys(he.HostType).map(function(e){return he.HostType[e]}).forEach(function(e){return localStorage.removeItem("playground_".concat(e,"_snippets"))}),["playground_log","playground_settings","playground_trusted_snippets"].forEach(function(e){return localStorage.removeItem(e)}),{solutions:e,files:t}}function wo(e){var t=Qr("");return Object.keys(e).filter(function(e){return e!==z}).map(function(t){return e[t]}).reduce(function(e,n){return Object(be.a)({},e,Object(R.a)({},n.id,Object(be.a)({},t,n)))},{})}var Eo=n(103),xo=n(456),Ao=n(143),ko="#######################################",Co=function(e,t){return["import customfunctionmanager",t.clearOnRegister?"customfunctionmanager.clear()":null,"",ko,""].concat(Object(ge.a)(It()(e.filter(function(e){return!e.options.isUntrusted}).map(function(e){return function(e,t){var n=new RegExp(ht,"gm");return e.replace(n,function(e,n,r,o){return n+"".concat(t,".").concat(r)+o})}(Object(ut.findScript)(e).content,bt(e.name))}).map(function(e){return[e,ko,""]}))),["customfunctionmanager.generateMetadata()"]).filter(function(e){return null!==e}).join("\n")};var To=function(e){return function(t){function n(e){var t;return Object(ae.a)(this,n),(t=Object(ce.a)(this,Object(se.a)(n).call(this,e))).fetchLogs=Object(k.a)(A.a.mark(function e(){var n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.state.engineStatus){e.next=2;break}return e.abrupt("return");case 2:if(!(t.state.engineStatus.nativeRuntime&&window.Office&&window.Office.context&&window.Office.context.requirements&&window.Office.context.requirements.isSetSupported("CustomFunctions",1.4))){e.next=9;break}return e.next=6,kt();case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=Object(Ee.getCustomFunctionLogsFromLocalStorage)();case 10:n=e.t0,t.setState({logs:Object(ge.a)(t.state.logs).concat(Object(ge.a)(n))});case 12:case"end":return e.stop()}},e,this)})),t.clearLogs=function(){return t.setState({logs:[]})},t.state={runnerLastUpdated:Date.now(),customFunctionsSolutionLastModified:Object(Ee.getCustomFunctionCodeLastUpdated)(),isStandalone:!P.a.parse(window.location.href.split("?").slice(-1)[0]).backButton,logs:[]},t}return Object(ue.a)(n,t),Object(ie.a)(n,[{key:"componentDidMount",value:function(){var e=Object(k.a)(A.a.mark(function e(){var t,n,r,o=this;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_t();case 3:return t=e.sent,n=Io(),e.next=7,Do(n);case 7:if(r=e.sent,this.setState({engineStatus:t,customFunctionsSummaryItems:r.parseResults,customFunctionsCode:r.code}),!(this.state.customFunctionsSummaryItems.length>0)){e.next=12;break}return e.next=12,jt(this.state.customFunctionsSummaryItems,this.state.customFunctionsCode);case 12:Object(C.hideSplashScreen)(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),Object(C.invokeGlobalErrorHandler)(e.t0);case 18:this.localStoragePollingInterval=setInterval(function(){return o.setState({customFunctionsSolutionLastModified:Object(Ee.getCustomFunctionCodeLastUpdated)()})},500);case 19:case"end":return e.stop()}},e,this,[[0,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.localStoragePollingInterval)}},{key:"render",value:function(){return I.a.createElement(e,Object.assign({},this.state,{fetchLogs:this.fetchLogs,clearLogs:this.clearLogs}))}}]),n}(T.Component)};function Io(){var e=_o(),t=e.solutions,n=e.files,r=Object.values(t).map(function(e){var t=Object.values(n).filter(function(t){return e.files.includes(t.id)});return Object(be.a)({},e,{files:t})});return xt(r)}function Do(e){return Lo.apply(this,arguments)}function Lo(){return(Lo=Object(k.a)(A.a.mark(function e(t){var n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=t.map(function(e){return{solution:e,script:Object(ut.findScript)(e)}}).filter(function(e){return"python"===e.script.language}).map(function(e){return e.solution})).length>0)){e.next=5;break}return e.abrupt("return",Bo(n));case 5:return e.abrupt("return",Et(t));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Bo(e){return Po.apply(this,arguments)}function Po(){return(Po=Object(k.a)(A.a.mark(function e(t){var n,r,o,a,i,c;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Mr()){e.next=3;break}throw new Eo.ScriptLabError('To support Python custom functions, you must enter the required settings in the editor\'s "Settings" page. Please close this pane, add the necessary settings, and try again.',null,{hideCloseButton:!0});case 3:return r=mt()["jupyter.clearOnRegister"]||!1,o=new xo.JupyterNotebook({baseUrl:n.url,token:n.token},n.notebook),Object(C.showSplashScreen)("Attempting to connect to your Jupyter notebook, to allow execution of Python custom functions. Please wait..."),e.prev=6,a=Co(t,{clearOnRegister:r}),Ao.isLoggerEnabled("Jupyter",Ao.levels.INFO)&&console.log(a),e.t0=JSON,e.t1=xo.PythonCodeHelper,e.next=13,o.executeCode(a);case 13:return e.t2=e.sent,e.t3=e.t1.parseFromPythonLiteral.call(e.t1,e.t2),i=e.t0.parse.call(e.t0,e.t3),c=i.functions.map(function(e){return{javascriptFunctionName:null,nonCapitalizedFullName:e.name,metadata:Object(be.a)({},e,{name:e.name.toUpperCase()}),status:"good"}}),e.abrupt("return",{code:"",parseResults:c});case 20:return e.prev=20,e.t4=e.catch(6),Object(C.invokeGlobalErrorHandler)(new Eo.ScriptLabError("Could not connect to Jupyter notebook. Please ensure that you've entered the correct Jupyter settings and that Jupyter is running",e.t4)),e.abrupt("return",{code:"",parseResults:[]});case 24:case"end":return e.stop()}},e,this,[[6,20]])}))).apply(this,arguments)}var Ro=n(347),No=n.n(Ro),Uo=n(190),Fo=n.n(Uo),Mo=n(175),Go=n.n(Mo),Ho=n(114),Wo=n(567),zo=n(12),Ko=n(11);function Jo(){var e=Object(zo.a)(["\n  white-space: pre-line;\n  background: ",";\n  padding: 0.6rem;\n  margin-top: 0.8rem;\n"]);return Jo=function(){return e},e}function qo(){var e=Object(zo.a)(["\n  margin-bottom: 2.6rem;\n"]);return qo=function(){return e},e}function Vo(){var e=Object(zo.a)([""]);return Vo=function(){return e},e}function Yo(){var e=Object(zo.a)(["\n  margin-bottom: 1.9rem;\n"]);return Yo=function(){return e},e}function Qo(){var e=Object(zo.a)(["\n  max-width: 33rem;\n  text-align: left;\n"]);return Qo=function(){return e},e}function $o(){var e=Object(zo.a)(["\n  width: 14.1rem;\n  margin-top: 2.4rem;\n  margin-bottom: 3.2rem;\n  color: ",";\n"]);return $o=function(){return e},e}function Xo(){var e=Object(zo.a)(["\n  margin-top: 0.7rem;\n  line-height: 1.7rem;\n  color: ",";\n  max-width: 20rem;\n  text-align: center;\n"]);return Xo=function(){return e},e}function Zo(){var e=Object(zo.a)(["\n  line-height: 5.6rem;\n  color: ",";\n"]);return Zo=function(){return e},e}function ea(){var e=Object(zo.a)(["\n  flex: 1;\n  overflow-y: auto;\n  padding: 50px 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return ea=function(){return e},e}var ta=Ko.default.div(ea()),na=Ko.default.h1.attrs({className:"ms-font-su"})(Zo(),function(e){return e.theme.neutralPrimary}),ra=Ko.default.h3.attrs({className:"ms-font-s-plus"})(Xo(),function(e){return e.theme.neutralPrimary}),oa=Ko.default.hr($o(),function(e){return e.theme.neutralLight}),aa=Ko.default.section(Qo()),ia=Ko.default.h3.attrs({className:"ms-font-s-plus"})(Yo()),ca=Ko.default.ol.attrs({className:"ms-font-s"})(Vo()),sa=Ko.default.li(qo()),ua=Ko.default.div.attrs({className:"ms-font-xs"})(Jo(),function(e){return e.theme.neutralLight}),la=function(){return window.location.reload()},da=function(e){var t=e.isRefreshEnabled;return I.a.createElement(ta,null,I.a.createElement(na,null,"Welcome"),I.a.createElement(ra,null,"Discover what custom functions can do for you today!"),I.a.createElement(oa,null),I.a.createElement(aa,null,I.a.createElement(ia,null,"Get started with your first custom function."),I.a.createElement(ca,null,I.a.createElement(sa,null,"Open the code editor."),I.a.createElement(sa,null,"Copy the following script and paste it into the editor.",I.a.createElement(ua,null,I.a.createElement("pre",null,"/** @CustomFunction */"),I.a.createElement("pre",null,"function add10(x: number): number ","{"),I.a.createElement("pre",null," return x + 10;"),I.a.createElement("pre",null,"}"))),I.a.createElement(sa,null,"After pasting, click the ",I.a.createElement("strong",null,"Refresh")," button below.")),I.a.createElement(Ho.a,{primary:!0,disabled:!t,onClick:la,text:"Refresh",style:{display:"block",margin:"0 auto"}})))};function fa(){var e=Object(zo.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]);return fa=function(){return e},e}var pa=Ko.default.div(fa()),ma=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={selectedKey:Object.keys(n.props.items).length>0?Object.keys(n.props.items)[0]:""},n.setSelectedKey=function(e){return n.setState({selectedKey:e})},n.reload=function(){return window.location.reload()},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.state.selectedKey,t=this.props,n=t.hasAny,r=t.items,o=t.isStandalone,a=t.shouldPromptRefresh,i={key:"go-back",iconOnly:!0,iconProps:{iconName:"Back"},onClick:o?null:function(){window.location.href=we.currentEditorUrl+"/redirect-to-editor.html"}},c={key:"title",text:"Custom Functions (Preview)",onRenderIcon:function(){return I.a.createElement(Wo.a,{iconName:"Refresh",style:{padding:".4rem"}})},onClick:this.reload},s=o?[c]:[i,c];return I.a.createElement(Fo.a,{fullscreen:!0,header:I.a.createElement(I.a.Fragment,null,I.a.createElement(No.a,{items:s}),I.a.createElement(Re.a,{when:n},I.a.createElement(Go.a,{items:Object.keys(r).map(function(e){return{key:e,text:e,itemCount:r[e].itemCount}}),selectedKey:e,onSelect:this.setSelectedKey}))),footer:null},I.a.createElement(pa,null,a?I.a.createElement(de.a,{messageBarType:fe.a.info,isMultiline:!0,actions:I.a.createElement("div",null,I.a.createElement(Ho.a,{primary:!0,onClick:this.reload},"Reload"))},"You have made changes to your Custom Functions. Would you like to re-register?"):null,n?I.a.createElement(pa,null,r[e].component):I.a.createElement(da,{isRefreshEnabled:a})))}}]),t}(I.a.Component);function ha(){var e=Object(zo.a)(["\n  position: absolute;\n  bottom: 0.2rem;\n  right: 0.5rem;\n\n  color: ",";\n\n  font-variant: small-caps;\n  white-space: nowrap;\n"]);return ha=function(){return e},e}function ga(){var e=Object(zo.a)(["\n  padding: 0rem 2rem 2rem 2.5rem;\n\n  & > ",":first-child {\n    margin-top: 0;\n  }\n"]);return ga=function(){return e},e}function ba(){var e=Object(zo.a)(["\n  color: red;\n  margin-top: 0.8rem;\n"]);return ba=function(){return e},e}function ya(){var e=Object(zo.a)([""]);return ya=function(){return e},e}function Oa(){var e=Object(zo.a)(["\n  display: flex;\n  align-items: center;\n\n  min-height: 4.25rem;\n  line-height: 4.25rem;\n"]);return Oa=function(){return e},e}function va(){var e=Object(zo.a)(["\n  position: relative;\n  padding: 0rem 1.8rem;\n\n  border-top: 0.5px solid ",";\n  border-bottom: 0.5px solid ",";\n"]);return va=function(){return e},e}var ja=Ko.default.div(va(),function(e){return e.theme.neutralLight},function(e){return e.theme.neutralLight}),Sa=Ko.default.div(Oa()),_a=Ko.default.h4.attrs({className:"ms-font-s"})(ya()),wa=Ko.default.div.attrs({className:"ms-font-xs"})(ba()),Ea=Ko.default.div(ga(),wa),xa=Ko.default.div.attrs({className:"ms-font-s"})(ha(),function(e){return e.theme.neutralSecondaryLight}),Aa=function(e){var t,n=e.status,r=e.nonCapitalizedFullName,o=e.errors,a=(t={},Object(R.a)(t,"good",{iconName:"Completed",color:"#107C10"}),Object(R.a)(t,"skipped",{iconName:"Warning",color:"#F0C784"}),Object(R.a)(t,"error",{iconName:"ErrorBadge",color:"red"}),Object(R.a)(t,"untrusted",{iconName:"ReportHacked",color:"gray"}),t)[n],i=a.iconName,c=a.color;return I.a.createElement(ja,null,I.a.createElement(Sa,null,I.a.createElement(Wo.a,{iconName:i,styles:{root:{marginRight:"0.5rem",color:c}}}),I.a.createElement(_a,null,r.substr(r.indexOf(".")+1),"(...)")),o&&I.a.createElement(Ea,null,o.map(function(e){return I.a.createElement(wa,{key:e},e)})),I.a.createElement(xa,null,"=ScriptLab.",r,"(...)"))};function ka(){var e=Object(zo.a)(["\n  height: 100%;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return ka=function(){return e},e}function Ca(){var e=Object(zo.a)(["\n  margin-top: 1.5rem;\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"]);return Ca=function(){return e},e}function Ta(){var e=Object(zo.a)(["\n  margin: 1.3rem 1.7rem 0rem 1.7rem;\n"]);return Ta=function(){return e},e}var Ia=Ko.default.h4.attrs({className:"ms-font-m"})(Ta()),Da=Ko.default.div(Ca(),function(e){return e.theme.neutralLight},function(e){return e.theme.neutralLight}),La=Ko.default.div(ka()),Ba=n(1368),Pa=n(543),Ra=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).moreErrorInfo=function(){Object(C.invokeGlobalErrorHandler)(n.props.error,{showExpanded:!0})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.error,n=e.items;return t?I.a.createElement(de.a,{messageBarType:fe.a.severeWarning,isMultiline:!0,actions:I.a.createElement("div",null,I.a.createElement(Ho.a,{primary:!0,onClick:this.moreErrorInfo},"More info"))},"An error occurred while registering your custom functions."):n?I.a.createElement("div",null,I.a.createElement(Ia,null,n.filter(function(e){return"error"===e.status}).length>0?"Some of your functions are invalid and cannot be declared. Review and fix the issues.":"The following functions have been registered successfully."),I.a.createElement(Da,null,n.map(function(e,t){return I.a.createElement(Aa,Object.assign({key:"".concat(e.nonCapitalizedFullName).concat(e.javascriptFunctionName).concat(t)},e))}))):I.a.createElement(La,null,I.a.createElement(Ba.a,{size:Pa.a.large,label:"Loading...",ariaLive:"assertive"}))}}]),t}(I.a.Component),Na=n(380),Ua={height:"100%"},Fa=function(e){var t=e.items;return I.a.createElement(Na.a,{readOnly:!0,resizable:!1,multiline:!0,value:vt(t),style:{fontFamily:"Consolas, monaco, monospace"},styles:{root:Ua,wrapper:Object(be.a)({},Ua,{border:0}),fieldGroup:Ua,field:Ua}})},Ma=n(925),Ga=n.n(Ma);function Ha(){var e=Object(zo.a)(["\n  text-align: center;\n  max-width: 90%;\n"]);return Ha=function(){return e},e}function Wa(){var e=Object(zo.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ",";\n\n  height: 100%;\n  width: 100%;\n"]);return Wa=function(){return e},e}function za(){var e=Object(zo.a)(["\n  flex: 1;\n  height: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n"]);return za=function(){return e},e}var Ka,Ja=Ko.default.div(za()),qa=Ko.default.div(Wa(),function(e){return e.theme.neutralPrimary}),Va=Ko.default.div(Ha());!function(e){e.Info="info",e.Log="log",e.Warn="warn",e.Error="error"}(Ka||(Ka={}));var Ya=function(e){function t(){return Object(ae.a)(this,t),Object(ce.a)(this,Object(se.a)(t).apply(this,arguments))}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.logs,n=e.clearLogs;return I.a.createElement(Ja,null,t.length>0?I.a.createElement(Ga.a,{logs:t,clearLogs:n}):I.a.createElement(qa,null,I.a.createElement(Va,null,"There are no logs to display. Use"," ",I.a.createElement("pre",{style:{fontFamily:"Consolas, monaco, monospace",fontWeight:"bold",display:"inline"}},"console.log()")," ","inside your functions to display logs here.")))}}]),t}(I.a.Component);function Qa(){var e=Object(zo.a)(["\n  max-width: 25rem;\n  text-align: center;\n  line-height: 1.9rem;\n  color: ",";\n"]);return Qa=function(){return e},e}function $a(){var e=Object(zo.a)(["\n  width: 11.8rem;\n  margin-top: 2.2rem;\n  margin-bottom: 2.7rem;\n  color: ",";\n"]);return $a=function(){return e},e}function Xa(){var e=Object(zo.a)(["\n  color: #d83b01;\n  margin-top: 2.4rem;\n  line-height: 5.6rem;\n  max-width: 30rem;\n  text-align: center;\n"]);return Xa=function(){return e},e}function Za(){var e=Object(zo.a)([""]);return Za=function(){return e},e}function ei(){var e=Object(zo.a)(["\n  height: 12rem;\n  width: 12rem;\n"]);return ei=function(){return e},e}function ti(){var e=Object(zo.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;\n  width: 100vw;\n"]);return ti=function(){return e},e}var ni=Ko.default.div(ti()),ri=Ko.default.img.attrs({src:"./assets/images/icon-large.svg"})(ei()),oi=Ko.default.h2.attrs({className:"ms-font-xxl"})(Za()),ai=Ko.default.h1.attrs({className:"ms-fontSize-su ms-fontWeight-light"})(Xa()),ii=Ko.default.hr($a(),function(e){return e.theme.neutralDark}),ci=Ko.default.p.attrs({className:"ms-fontSize-m ms-fontWeight-regular"})(Qa(),function(e){return e.theme.neutralDark}),si=function(){return I.a.createElement(ni,null,I.a.createElement(ri,null),I.a.createElement(oi,null,"Script Lab"),I.a.createElement(ai,null,"Custom Functions"),I.a.createElement(ii,null),I.a.createElement(ci,null,"Currently, Script Lab only supports Custom Functions (Preview) on Windows Desktop on the latest Insider builds on PC and Mac, and on Office Online.",I.a.createElement("br",null),I.a.createElement("br",null),"For more info, see"," ",I.a.createElement("a",{href:"https://aka.ms/customfunctions",target:"_blank"},"these instructions"),"."))},ui=To(function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).getShouldPromptRefresh=function(){return n.props.customFunctionsSolutionLastModified>n.props.runnerLastUpdated},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentDidMount",value:function(){this.logFetchInterval=setInterval(this.props.fetchLogs,250)}},{key:"componentWillUnmount",value:function(){clearInterval(this.logFetchInterval)}},{key:"render",value:function(){var e=this.props,t=e.customFunctionsSummaryItems,n=e.isStandalone,r=e.engineStatus,o=e.logs,a=e.clearLogs,i=e.error;return r?r.enabled?I.a.createElement(ma,{isStandalone:n,hasAny:t&&t.length>0,items:{Summary:{component:I.a.createElement(Ra,{items:t,error:i})},Metadata:{component:I.a.createElement(Fa,{items:t})},Console:{component:I.a.createElement(Ya,{logs:o,clearLogs:a}),itemCount:o.length>0?o.length:void 0}},shouldPromptRefresh:this.getShouldPromptRefresh()}):I.a.createElement(si,null):null}}]),t}(I.a.Component)),li=function(e){function t(e){var n;return Object(ae.a)(this,t),(n=Object(ce.a)(this,Object(se.a)(t).call(this,e))).state={host:null},n.state={host:he.Utilities.host},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){return this.state.host?I.a.createElement(me.a,{host:this.state.host},I.a.createElement(ui,null)):null}}]),t}(I.a.Component),di=(n(1282),n(451)),fi=n.n(di);function pi(){setInterval(function(){Object(Ee.getCustomFunctionsLastRegisteredTimestamp)()>e&&mi({type:"refresh"})},Zr.CF_HEARTBEAT_POLLING_INTERVAL);var e=Object(Ee.getCustomFunctionsLastRegisteredTimestamp)();window.onmessage=function(e){if(e.origin===we.currentRunnerUrl){var t=JSON.parse(e.data);switch(t.type){case"log":!function(e){var t=e.payload;Object(Ee.writeItem)(Ee.CF_LOGS_ROOT,t.id,t)}(t);break;default:throw new Error('Unknown message type: "'.concat(t.type))}}},mi({type:"metadata",payload:hi()})}function mi(e){window.parent.postMessage(JSON.stringify(e),we.currentRunnerUrl)}function hi(){var e=Object(Ee.getAllLocalStorageKeys)().filter(function(e){return 0===e.indexOf(Ee.SOLUTION_ROOT)}).map(function(e){return e.replace(Ee.SOLUTION_ROOT,"")}).map(function(e){return Object(Ee.readItem)(Ee.SOLUTION_ROOT,e)}).filter(function(e){return e.options.isCustomFunctionsSolution}).filter(function(e){return!e.options.isUntrusted}),t={typescript:[],python:[]};return e.forEach(function(e){var n=Object(ut.findScript)(e),r=t[n.language];if(!r)throw new Error("Invalid language specified for solution "+e.id);r.push(e)}),{typescriptMetadata:t.typescript.map(function(e){try{var t=Object(ut.findScript)(e),n=bt(e.name),r=t.content,o=e.files.find(function(e){return"libraries.txt"===e.name}).content,a=yt({solution:e,namespace:n,fileContent:r});return a.some(function(e){return"good"!==e.status})?null:Object(le.strictType)({solutionId:e.id,namespace:n,functions:a.map(function(e){return{fullId:e.metadata.id,fullDisplayName:e.metadata.name,javascriptFunctionName:e.javascriptFunctionName}}),code:it()(r),jsLibs:fi()(o,!1).scriptReferences})}catch(i){return console.error(i),null}}).filter(function(e){return null!==e}),pythonConfig:0===t.python.length?null:Mr(),customFunctionsRuntimeUrl:mt().customFunctionsRuntimeUrl}}var gi=function(){return I.a.createElement(We.RunOnLoad,{funcToRun:pi})},bi=function(){return Object(T.useEffect)(function(){window.location.href="".concat(we.currentRunnerUrl,"/#/custom-functions")}),null},yi=n(306),Oi=n(48),vi=n(1335),ji=n(444),Si=n.n(ji),_i=n(1245),wi=n(218),Ei=n(1367),xi=n(1370);function Ai(){var e=Object(zo.a)(["\n  & > * {\n    margin-bottom: 1.5rem;\n  }\n"]);return Ai=function(){return e},e}var ki,Ci=Ko.default.div(Ai()),Ti=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={name:"",description:""},n.setupForm=function(){var e=n.props.solution,t=e.name,r=e.description||"";n.setState({name:t,description:r})},n.updateSolutionName=function(e,t){return n.setState({name:t})},n.updateSolutionDescription=function(e,t){return n.setState({description:t})},n.updateSolutionMetadata=function(){var e=n.state,t=e.name,r=e.description;n.props.editSolutionMetadata(n.props.solution.id,{name:t,description:r}),n.props.closeSolutionSettings()},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentWillMount",value:function(){this.setupForm()}},{key:"componentWillReceiveProps",value:function(){this.setupForm()}},{key:"render",value:function(){var e=this.props,t=e.solution,n=e.isOpen,r=e.closeSolutionSettings,o=this.state,a=o.name,i=o.description;return I.a.createElement(Ge.a,{hidden:!n,onDismiss:r,dialogContentProps:{type:He.a.largeHeader,title:"Info"},modalProps:{isBlocking:!1}},I.a.createElement(Ci,null,I.a.createElement(Na.a,{"data-testid":"solution-name-field",label:"Name",onChange:this.updateSolutionName,value:a}),I.a.createElement(Na.a,{"data-testid":"solution-desc-field",label:"Description",multiline:!0,rows:4,onChange:this.updateSolutionDescription,value:i}),I.a.createElement(Re.a,{when:t.source&&"gist"===t.source.origin},I.a.createElement("div",null,I.a.createElement(Ei.a,null,"Gist URL"),I.a.createElement(xi.a,{target:"_blank",href:t.source&&"https://gist.github.com/".concat(t.source.id)},"Open in browser")))),I.a.createElement(_i.a,null,I.a.createElement(Ho.a,{"data-testid":"cancel",text:"Cancel",secondaryText:"Cancels the update to snippet settings",onClick:r})," ",I.a.createElement(wi.a,{"data-testid":"update",text:"Update",secondaryText:"Updates the snippet settings",onClick:this.updateSolutionMetadata})))}}]),t}(I.a.Component),Ii=Object(Oi.b)(function(e){return{solution:E.editor.getActiveSolution(e)}},function(e){return{editSolutionMetadata:function(t,n){return e(O.solutions.edit({id:t,solution:n}))}}})(Ti),Di=function(e,t){return Object(be.a)({},e,{onClick:e.actionCreator?function(){return t(e.actionCreator())}:void 0,subMenuProps:e.subMenuProps?Object(be.a)({},e.subMenuProps,{items:void 0!==e.subMenuProps.items?e.subMenuProps.items.map(function(e){return Object(be.a)({},e,{onClick:e.actionCreator?function(){return t(e.actionCreator())}:void 0})}):void 0}):void 0})},Li=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={},n.getSnippetYAML=function(){return Oe.a.safeDump(Xr(n.props.activeSolution))},n.showSolutionSettings=function(){return n.setState({isSolutionSettingsVisible:!0})},n.hideSolutionSettings=function(){return n.setState({isSolutionSettingsVisible:!1})},n.renderItem=function(e){var t=n.getCustomOnRenderIconButtons(),r=Di(e,n.props.dispatch);return e.key in t?Object(be.a)({},r,{onRenderIcon:t[e.key]}):r},n.getCustomOnRenderIconButtons=function(){var e=n.props,t=e.isLoggingInOrOut,r=e.profilePicUrl;return{account:function(){return I.a.createElement("div",{style:{width:"28px",overflow:"hidden"}},t?I.a.createElement(Ba.a,{size:Pa.a.medium}):I.a.createElement(pe.ThemeContext.Consumer,null,function(e){return I.a.createElement(vi.a,{imageUrl:r,size:Fe.c.size28,initialsColor:"white",styles:{initials:{color:e&&e.primary||"black"}}})}))}}},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.items,r=t.farItems;return I.a.createElement(I.a.Fragment,null,I.a.createElement(Si.a,{globallyUniqueSelector:".export-snippet-to-clipboard",textGetter:this.getSnippetYAML,onSuccess:this.props.notifyClipboardCopySuccess,onError:this.props.notifyClipboardCopyFailure}),I.a.createElement(No.a,{items:n.map(function(t){var n=e.renderItem(t);return"solution-name"===t.key?Object(be.a)({},n,{onClick:e.showSolutionSettings}):n}),farItems:r.map(function(t){return e.renderItem(t)})}),I.a.createElement(Ii,{isOpen:this.state.isSolutionSettingsVisible,closeSolutionSettings:this.hideSolutionSettings}))}}]),t}(T.Component),Bi=Object(Oi.b)(function(e){return{items:E.header.getItems(e),farItems:E.header.getFarItems(e),activeSolution:E.editor.getActiveSolution(e),isLoggingInOrOut:E.github.getIsLoggingInOrOut(e),profilePicUrl:E.github.getProfilePicUrl(e)||void 0}},function(e){return{dispatch:e,notifyClipboardCopySuccess:function(){return e(O.messageBar.show({text:"Snippet copied to clipboard."}))},notifyClipboardCopyFailure:function(){return e(O.messageBar.show({text:"Snippet failed to copy to clipboard.",style:fe.a.error}))}}})(Li),Pi=(ki={},Object(R.a)(ki,ut.SCRIPT_FILE_NAME,"Script"),Object(R.a)(ki,"index.html","HTML"),Object(R.a)(ki,"index.css","CSS"),Object(R.a)(ki,ut.LIBRARIES_FILE_NAME,"Libraries"),ki),Ri=Object(Oi.b)(function(e){return{files:E.editor.getActiveSolution(e).files,activeFile:E.editor.getActiveFile(e),isCustomFunctionSolution:E.editor.getIsActiveSolutionCF(e),isSolutionPython:E.editor.getIsActiveSolutionPython(e)}},function(e){return{openFile:function(t){return e(O.editor.openFile({fileId:t}))}}})(function(e){var t=e.files,n=e.activeFile,r=e.isCustomFunctionSolution,o=e.isSolutionPython,a=e.openFile;return I.a.createElement(Go.a,{items:t.filter(function(e){return o?e.name===ut.SCRIPT_FILE_NAME:!r||[ut.SCRIPT_FILE_NAME,ut.LIBRARIES_FILE_NAME].includes(e.name)}).map(function(e){return{key:e.id,text:Pi[e.name]||e.name}}),selectedKey:n.id,onSelect:a,testId:"file-switcher-pivot"})});function Ni(){var e=Object(zo.a)(["\n  height: 100%;\n\n  padding: 1rem 0;\n  box-sizing: border-box;\n  z-index: 500;\n"]);return Ni=function(){return e},e}var Ui=Ko.default.div(Ni()),Fi=n(305);function Mi(e){var t=e.solutionId,n=e.file;return monaco.Uri.file("".concat(t,"/").concat(n.language,"/").concat(n.id))}var Gi=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).container=I.a.createRef(),n.initializeMonaco=function(){if(!n.container.current)throw new Error("Trying to initialize but ref isn't even valid. This should not be reachable.");n.editor=monaco.editor.create(n.container.current,{});var e=n.getModel();e.updateOptions({tabSize:n.props.tabSize}),n.editor.setModel(e),n.editor.onDidChangeModelContent(function(){n.onValueChange()}),n.props.editorDidMount(n.editor)},n.onValueChange=function(){return n.props.onValueChange(n.props.solutionId,n.props.file.id,n.editor.getModel().getValue())},n.getCurrentUri=function(){return Mi({solutionId:n.props.solutionId,file:n.props.file})},n.getModel=function(){var e=n.getCurrentUri(),t=monaco.editor.getModel(e);return t||monaco.editor.createModel(n.props.file.content,n.props.file.language,e)},n.clearAllModels=function(){monaco.editor.getModels().forEach(function(e){return e.dispose()})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentDidMount",value:function(){var e=this;void 0!==window.monaco?this.initializeMonaco():(window.require.config({baseUrl:"/",paths:{vs:"external/monaco-editor-".concat(Fi.HYPHENATED_PACKAGE_VERSIONS["monaco-editor"],"/vs")}}),window.require(["vs/editor/editor.main"],function(){return e.initializeMonaco()}))}},{key:"componentDidUpdate",value:function(e){if(this.editor){var t=this.props,n=t.solutionId,r=t.file;n!==e.solutionId&&this.clearAllModels();var o=r.language!==e.file.language;if(r.id!==e.file.id||o){var a=this.getModel();if(a.updateOptions({tabSize:this.props.tabSize}),this.editor.setModel(a),this.props.applyFormatting(),o){var i=monaco.editor.getModel(Mi({solutionId:n,file:e.file}));i&&i.dispose()}}}}},{key:"componentWillUnmount",value:function(){this.editor&&this.editor.dispose()}},{key:"render",value:function(){return I.a.createElement("div",{ref:this.container,style:{width:"100%",height:"100%"},role:"main"})}}]),t}(T.Component),Hi=n(176),Wi=n.n(Hi),zi=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).editFile=Wi()(function(e,t,r){return n.props.editFile(e,t,{content:r})},re),n.editSettings=Wi()(function(e){return n.props.editSettings(e)},oe),n.onValueChange=function(e,t,r){return e===F?n.editSettings(r):n.editFile(e,t,r)},n.signalEditorLoaded=function(e){e.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_COMMA,n.props.openSettings,""),n.props.signalEditorLoaded(e)},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.backgroundColor,n=e.tabSize;return I.a.createElement(Ui,{style:{backgroundColor:t}},I.a.createElement(Gi,{solutionId:this.props.activeSolution.id,file:this.props.activeFile,tabSize:n,onValueChange:this.onValueChange,editorDidMount:this.signalEditorLoaded,applyFormatting:this.props.applyFormatting}))}}]),t}(T.Component),Ki=Object(Oi.b)(function(e){return{backgroundColor:E.settings.getBackgroundColor(e),activeSolution:E.editor.getActiveSolution(e),activeFile:E.editor.getActiveFile(e),tabSize:E.settings.getTabSize(e)}},function(e){return{editFile:function(t,n,r){return e(O.solutions.edit({id:t,fileId:n,file:r}))},editSettings:function(t){return e(O.settings.editFile({newSettings:t}))},openSettings:function(){return e(O.settings.open())},signalEditorLoaded:function(t){return e(O.editor.onMount(t))},applyFormatting:function(){return e(O.editor.applyFormatting())}}})(zi),Ji=n(928),qi=n.n(Ji),Vi=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).renderItem=function(e){return Di(e,n.props.dispatch)},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.items,r=t.farItems;return I.a.createElement(qi.a,{items:n.map(function(t){return e.renderItem(t)}),farItems:r.map(function(t){return e.renderItem(t)})})}}]),t}(T.Component),Yi=Object(Oi.b)(function(e){return{items:E.footer.getItems(e),farItems:E.footer.getFarItems(e)}},function(e){return{dispatch:e}})(Vi),Qi=function(e){switch(e){case fe.a.info:return{root:{background:"#F4F4F4"}};case fe.a.success:return{root:{background:"#F1F7CE"}};case fe.a.error:return{root:{background:"#FACFD3"}};case fe.a.warning:return{root:{background:"#FFF1CC"},icon:{color:"darkgray"}};default:return{root:{}}}},$i=(n(1286),function(e){return{messageBarProps:e.messageBar,screenWidth:Jr.screen.getWidth(e)}}),Xi=Object(Oi.b)($i,function(e){return{}})(Object(Oi.b)($i,function(e,t){return{buttonOnClick:t.messageBarProps.button?function(){return e(t.messageBarProps.button.action)}:function(){},dismiss:function(){return e(p.dismiss())}}})(function(e){var t=e.messageBarProps,n=e.screenWidth,r=e.buttonOnClick,o=e.dismiss;return I.a.createElement("div",{className:"message-bar ".concat(t.isVisible?"active":"")},I.a.createElement(de.a,{dismissButtonAriaLabel:"Close",messageBarType:t.style,onDismiss:o,styles:Qi(t.style),isMultiline:n<400,actions:t.button?I.a.createElement("div",null,I.a.createElement(Ho.a,{primary:!0,onClick:r},t.button.text)):void 0},t.text,t.link&&I.a.createElement(xi.a,{href:t.link.url,target:"_blank"},t.link.text)))})),Zi=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).getDispatchFunctionForOnClick=function(e){return function(){n.props.dispatch(e),n.props.dispatch(s.dismiss())}},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dialogProps,r=t.dismiss;t.dispatch;return I.a.createElement(Ge.a,{hidden:!n.isVisible,onDismiss:r,dialogContentProps:{type:n.style,title:n.title,subText:n.subText},modalProps:{isBlocking:n.isBlocking}},I.a.createElement(_i.a,null,n.buttons.map(function(t){return I.a.createElement(Ho.a,{key:t.key,"data-testid":t.key,text:t.text,onClick:e.getDispatchFunctionForOnClick(t.action),primary:t.isPrimary})})))}}]),t}(I.a.Component),ec=Object(Oi.b)(function(e){return{dialogProps:e.dialog}},function(e){return{dismiss:function(){return e(s.dismiss())}}})(Object(Oi.b)()(Zi)),tc=function(){return I.a.createElement(I.a.Fragment,null,I.a.createElement(Xi,null),I.a.createElement(ec,null))};function nc(){var e=Object(zo.a)(["\n  z-index: 1000;\n  flex: 1;\n  height: 100%;\n\n  overflow: hidden;\n\n  background: ",";\n"]);return nc=function(){return e},e}function rc(){var e=Object(zo.a)(["\n  height: 100vh;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  z-index: 1000;\n  opacity: 1;\n\n  ","\n"]);return rc=function(){return e},e}var oc=window.localStorage.getItem("SCRIPT_LAB_SPLASH_SCREEN_TRANSITION"),ac=(Ko.default.div(rc(),oc?"transition: visibility 0s, opacity ".concat(oc,"s cubic-bezier(0.25, 0.46, 0.45, 0.94);"):""),Ko.default.div(nc(),function(e){return e.theme.neutralDark})),ic=function(e){function t(){return Object(ae.a)(this,t),Object(ce.a)(this,Object(se.a)(t).apply(this,arguments))}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isVisible,n=e.hasLoaded,r=e.activeSolution,o=e.activeFile;return I.a.createElement(Fo.a,{fullscreen:!0,header:I.a.createElement(I.a.Fragment,null,I.a.createElement(Bi,null),I.a.createElement(Ri,null)),footer:I.a.createElement(Yi,null),wrapperStyle:t&&n?{visibility:"visible"}:{visibility:"hidden",opacity:n?1:0}},I.a.createElement(I.a.Fragment,null,I.a.createElement(tc,null),I.a.createElement(ac,null,I.a.createElement(Ki,{activeSolution:r,activeFiles:r.files,activeFile:o,isVisible:t&&n}))))}}]),t}(T.Component);ic.defaultProps={activeSolution:K,activeFile:W};var cc=Object(Oi.b)(function(e){return{isVisible:e.editor.isVisible,hasLoaded:e.editor.hasLoaded,activeSolution:Jr.editor.getActiveSolution(e),activeFile:Jr.editor.getActiveFile(e)}})(ic);function sc(){var e=Object(zo.a)(["\n  position: absolute;\n\n  background-color: rgba(0, 0, 0, 0.35);\n\n  top: 0;\n  left: 0;\n\n  height: 100vh;\n  width: 100%;\n\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return sc=function(){return e},e}function uc(){var e=Object(zo.a)(["\n  flex: 1;\n  position: relative;\n  overflow-y: auto;\n"]);return uc=function(){return e},e}function lc(){var e=Object(zo.a)(["\n  margin-top: 1.5rem;\n  margin-bottom: 1.5rem;\n"]);return lc=function(){return e},e}function dc(){var e=Object(zo.a)(["\n  margin-bottom: 2rem;\n"]);return dc=function(){return e},e}function fc(){var e=Object(zo.a)(["\n  height: 100%;\n  width: 100%;\n  padding: 1rem;\n  box-sizing: border-box;\n  font-size: 1.6rem;\n  overflow-y: auto;\n"]);return fc=function(){return e},e}function pc(){var e=Object(zo.a)(["\n  display: flex;\n  flex-wrap: no-wrap;\n\n  position: absolute;\n  top: 0;\n  background-color: ",";\n  height: 100vh;\n  width: 100%;\n\n  @media (max-width: 500px) {\n    flex-direction: column;\n  }\n"]);return pc=function(){return e},e}var mc=Ko.default.div(pc(),function(e){return e.theme.white}),hc=Ko.default.div(fc()),gc=Ko.default.h1.attrs({className:"ms-font-xxl"})(dc()),bc=Ko.default.h2.attrs({className:"ms-font-l"})(lc()),yc=Ko.default.div(uc()),Oc=Ko.default.div(sc()),vc=n(1371),jc=n(46),Sc=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).getNavStyles=function(e){var t=n.props.theme,r=e.isSelected;return{root:{width:"22rem",height:"100vh",background:t.primary},link:Object(jc.W)(Object(jc.L)(e.theme,void 0,void 0,void 0,t.white,void 0),{backgroundColor:t.primary,color:"".concat(t.white," !important"),height:"7rem",paddingLeft:"2rem",selectors:{".ms-Nav-compositeLink:hover &":{backgroundColor:t.primaryDark}}},r&&{backgroundColor:t.primaryDark,selectors:{"&:after":{borderLeft:"2px solid ".concat(t.white),content:'""',position:"absolute",top:0,right:0,bottom:0,left:0}}})}},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.theme,n=e.items,r=e.selectedKey;return I.a.createElement(vc.a,{selectedKey:r,groups:[{links:n.map(function(e){return{"data-testid":e["data-testid"],name:e.label||"",key:e.key,icon:e.icon,iconProps:{iconName:e.icon,styles:{root:{color:"".concat(t.white," !important"),marginRight:"1rem"}}},style:{visibility:e.isHidden?"hidden":"visible"},ariaLabel:e.ariaLabel,onClick:e.onClick,url:""}})}],styles:this.getNavStyles})}}]),t}(I.a.Component),_c=Object(Ko.withTheme)(Sc);function wc(){var e=Object(zo.a)(["\n  box-shadow: 0px 2px 4px 2px ",";\n"]);return wc=function(){return e},e}var Ec=Ko.default.div(wc(),function(e){return e.theme.neutralSecondary}),xc=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).onSelect=function(e){return n.props.items.find(function(t){return t.key===e}).onClick()},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.selectedKey,r=e.theme;return I.a.createElement(Ec,null,I.a.createElement(Go.a,{selectedKey:n,onSelect:this.onSelect,items:t.filter(function(e){return!e.isHidden}).map(function(e){var t=e.label,n=e.icon,r=e.key,o=e.ariaLabel;return["back","new"].includes(r)?{iconName:n,key:r,ariaLabel:o}:{text:t,key:r}}),backgroundColor:r.primary,selectedColor:r.primaryDark}))}}]),t}(I.a.Component),Ac=Object(Ko.withTheme)(xc),kc=function(e){function t(){return Object(ae.a)(this,t),Object(ce.a)(this,Object(se.a)(t).apply(this,arguments))}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.selectedKey;return e.isCompact?I.a.createElement(Ac,{items:t,selectedKey:n}):I.a.createElement(_c,{items:t,selectedKey:n})}}]),t}(I.a.Component),Cc=n(1369),Tc=function(e){var t=e.title,n=e.description,r=e.children;return I.a.createElement(hc,null,I.a.createElement(gc,null,t),I.a.createElement(bc,null,n),r)};function Ic(){var e=Object(zo.a)(["\n  padding: 1.2rem;\n\n  &:hover,\n  &:focus {\n    background-color: ",";\n    color: ",";\n    cursor: pointer;\n  }\n\n  &:focus {\n    outline-color: ",";\n  }\n"]);return Ic=function(){return e},e}function Dc(){var e=Object(zo.a)(["\n  padding: 1.2rem;\n  flex: 1;\n"]);return Dc=function(){return e},e}function Lc(){var e=Object(zo.a)(["\n  display: flex;\n  height: 4rem;\n  color: ",";\n  background-color: ",";\n  white-space: nowrap;\n  overflow: hidden;\n"]);return Lc=function(){return e},e}function Bc(){var e=Object(zo.a)(["\n  margin: 1.2rem 0;\n\n  &:focus {\n    outline-color: ",";\n  }\n"]);return Bc=function(){return e},e}var Pc=Ko.default.section(Bc(),function(e){return e.theme.primary}),Rc=Ko.default.div.attrs({className:"ms-font-m"})(Lc(),function(e){return e.theme.neutralDark},function(e){return e.theme.neutralLight}),Nc=Ko.default.span(Dc()),Uc=Ko.default.div(Ic(),function(e){return e.theme.primary},function(e){return e.theme.white},function(e){return e.theme.primary}),Fc=n(1356);function Mc(){var e=Object(zo.a)(["\n  opacity: 0.75;\n"]);return Mc=function(){return e},e}function Gc(){var e=Object(zo.a)([""]);return Gc=function(){return e},e}function Hc(){var e=Object(zo.a)(["\n  background-color: ",";\n  color: ",";\n"]);return Hc=function(){return e},e}function Wc(){var e=Object(zo.a)(["\n  padding: 1rem 1.5rem;\n  box-sizing: border-box;\n  user-select: none;\n\n  &:hover,\n  &:focus {\n    background-color: ",";\n    color: ",";\n    cursor: pointer;\n  }\n  &:focus {\n    outline-color: ",";\n  }\n"]);return Wc=function(){return e},e}var zc,Kc=Ko.default.article.attrs({className:"ms-font-m"})(Wc(),function(e){return e.theme.primary},function(e){return e.theme.white},function(e){return e.theme.primary}),Jc=Object(Ko.default)(Kc)(Hc(),function(e){return e.theme.primaryDarker},function(e){return e.theme.white}),qc=Ko.default.div(Gc()),Vc=Ko.default.div(Mc()),Yc=function(e){var t=e.title,n=e.description,r=e.isActive,o=e.onClick,a=r?Jc:Kc;return I.a.createElement(a,{"data-is-focusable":"true",onClick:o},I.a.createElement(qc,null,t),I.a.createElement(Vc,null,n))},Qc=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={isExpanded:!0},n.toggleExpansion=function(){return n.setState({isExpanded:!n.state.isExpanded})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.messageBar,r=e.items,o=e.testId,a=this.state.isExpanded;return I.a.createElement(Pc,null,I.a.createElement(Fc.a,null,I.a.createElement(Rc,null,I.a.createElement(Nc,null,t),I.a.createElement(Uc,{onClick:this.toggleExpansion,"data-is-focusable":!0},I.a.createElement(Wo.a,{iconName:a?"ChevronUp":"ChevronDown"}))),I.a.createElement(Re.a,{when:void 0!==n},n),I.a.createElement(Re.a,{when:a},I.a.createElement("div",{"data-testid":o},r.map(function(e){return I.a.createElement(Yc,Object.assign({key:e.key},e))})))))}}]),t}(T.Component),$c="has_dismissed_local_storage_warning",Xc=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={filterQueryLowercase:"",localStorageWarningIsVisible:!localStorage.getItem($c)},n.setFilterQuery=function(e){return n.setState({filterQueryLowercase:e.toLowerCase()})},n.hideLocalStorageWarning=function(){n.setState({localStorageWarningIsVisible:!1},function(){return localStorage.setItem($c,"true")})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.solutions,r=t.openSolution,o=t.activeSolution,a=t.gistMetadata,i=t.openGist,c=t.isSignedIn;return I.a.createElement(Tc,{title:"My Snippets",description:"Choose a snippet that you have saved"},I.a.createElement(Cc.a,{"data-testid":"solution-search",placeholder:"Search your snippets",onChange:this.setFilterQuery}),I.a.createElement(Qc,{testId:"my-solution-list",title:"My snippets on this computer",messageBar:I.a.createElement(Re.a,{when:this.state.localStorageWarningIsVisible},I.a.createElement(de.a,{messageBarType:fe.a.severeWarning,isMultiline:!0,dismissButtonAriaLabel:"Close",onDismiss:this.hideLocalStorageWarning},"Snippets you create get erased if you clear your browser cache. To save snippets permanently, export them as gists from the Share menu.")),items:n.filter(function(t){return Object(ct.matchesSearch)(e.state.filterQueryLowercase,[null,t.name,t.description])}).map(function(e){return{key:e.id,title:e.name,description:e.description,onClick:function(){return r(e.id)},isActive:o&&o.id===e.id}})}),(!c||a.length>0)&&I.a.createElement(Qc,{title:"My shared gists on GitHub",items:a.filter(function(t){return Object(ct.matchesSearch)(e.state.filterQueryLowercase,[t.title,t.description])}).map(function(e){return{key:e.id,title:e.title,description:e.description,onClick:function(){return i(e)}}})}),!c&&I.a.createElement("div",{style:{margin:"1rem",marginLeft:"2rem"}},I.a.createElement(Ei.a,null,"You must be logged in to see your gists"),I.a.createElement(Ho.a,{text:"Sign In",label:"You must be logged in to see your gists",onClick:this.props.signIn})))}}]),t}(I.a.Component),Zc=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={filterQueryLowercase:""},n.setFilterQuery=function(e){return n.setState({filterQueryLowercase:e.toLowerCase()})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.samplesByGroup,r=t.openSample,o=""!==this.state.filterQueryLowercase?Object.keys(n).reduce(function(t,r){return Object(be.a)({},t,Object(R.a)({},r,n[r].filter(function(t){return Object(ct.matchesSearch)(e.state.filterQueryLowercase,[r,t.name,t.description])})))},{}):n;return I.a.createElement(Tc,{title:"Samples",description:"Choose one of the samples below to get started."},I.a.createElement(Re.a,{when:null!==n&&Object.keys(n).length>0},I.a.createElement(I.a.Fragment,null,I.a.createElement(Cc.a,{"data-testid":"samples-search",placeholder:"Search our samples",onChange:this.setFilterQuery}),Object.keys(o).map(function(e){return o[e].length>0?I.a.createElement(Qc,{key:e,title:e,items:o[e].map(function(e){var t=e.id,n=e.name,o=e.description,a=e.rawUrl;return{key:t,title:n,description:o,onClick:function(){return r(a)}}})}):null}).filter(Boolean))),I.a.createElement(Re.a,{when:null!==n&&0===Object.keys(n).length},I.a.createElement("span",{className:"ms-font-m"},"There aren't any samples for this host yet.")))}}]),t}(T.Component),es=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={importFieldText:"",errorMessage:void 0},n.updateImportFieldText=function(e,t){return n.setState({importFieldText:t||""})},n.onImportClick=function(){var e,t,r=n.state.importFieldText.trim();try{if(r.startsWith("https://gist.github.com/"))e=r.split("/").pop();else{t=r;var o=Oe.a.safeLoad(r),a=$r(o),i=a.name,c=a.host;if(!i&&!c)throw new Error}n.props.importGist(e,t),n.setState({importFieldText:"",errorMessage:void 0})}catch(s){n.setState({errorMessage:"You must provide valid gist YAML or a valid gist url."})}},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){return I.a.createElement(Tc,{title:"Import snippet",description:"Enter the snippet's URL or paste the YAML below, then choose Import."},I.a.createElement("span",{className:"ms-font-m"},"Snippet URL or YAML"),I.a.createElement(Na.a,{multiline:!0,rows:8,onChange:this.updateImportFieldText,placeholder:"e.g.: https://gist.github.com/sampleGistId",errorMessage:this.state.errorMessage}),I.a.createElement(wi.a,{style:{marginTop:"1.5rem",float:"right"},text:"Import",onClick:this.onImportClick}))}}]),t}(T.Component),ts=n(1363),ns=n(1360);!function(e){e.Open="OPEN",e.Overwrite="OVERWRITE",e.CreateCopy="CREATE_COPY"}(zc||(zc={}));var rs={selectedChoiceOption:zc.CreateCopy,isDropdownDisabled:!0},os=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state=rs,n.closeDialog=function(){n.props.closeDialog(),n.setState(rs)},n.onOk=function(){var e=n.props,t=e.openGist,r=e.conflictingGist,o=e.existingSolutions,a=o.length>1?o[n.dropdownRef.state.selectedIndices[0]]:o[0];t(r.url,r.id,{type:n.state.selectedChoiceOption,existingSolution:a}),n.closeDialog()},n.setDropdownRef=function(e){n.dropdownRef=e},n.onChoiceChange=function(e,t){t&&(n.setState({selectedChoiceOption:t.key}),t.key===zc.Open||t.key===zc.Overwrite?n.setState({isDropdownDisabled:!1}):n.setState({isDropdownDisabled:!0}))},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.state,t=e.selectedChoiceOption,n=e.isDropdownDisabled,r=this.props.existingSolutions;return I.a.createElement(Ge.a,{hidden:!1,onDismiss:this.closeDialog,dialogContentProps:{type:He.a.largeHeader,title:"Update Existing?",subText:"You already have a version of this gist locally. Would you like to open the existing snippet, overwrite it, or create a new copy of the gist?"},modalProps:{isBlocking:!0,containerClassName:"ms-dialogMainOverride",isDarkOverlay:!0}},I.a.createElement(ts.a,{options:[{key:zc.CreateCopy,text:"Make a New Copy"},{key:zc.Open,text:"Open Existing Snippet"},{key:zc.Overwrite,text:"Overwrite Existing Snippet"}],selectedKey:t,onChange:this.onChoiceChange}),r.length>1&&I.a.createElement("div",{style:{marginTop:"1.2rem"}},I.a.createElement(ns.a,{disabled:n,label:"Select Existing Snippet:",id:"select-solution",ariaLabel:"Snippet Selector",options:r.map(function(e){return{key:e.id,text:e.name,title:e.description}}),defaultSelectedKey:r[0].id,componentRef:this.setDropdownRef})),I.a.createElement(_i.a,null,I.a.createElement(wi.a,{onClick:this.onOk,text:"OK"}),I.a.createElement(Ho.a,{onClick:this.closeDialog,text:"Cancel"})))}}]),t}(T.Component),as=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).containerDomNode=I.a.createRef(),n.state={isLoading:!1,selectedKey:n.props.solutions.length>0?"my-solutions":"samples",conflictingGist:null,existingSolutionsConflicting:null,width:0},n.setWidth=function(){var e=n.containerDomNode.current;if(e){var t=e.getBoundingClientRect().width;n.state.width!==t&&n.setState({width:t})}},n.openSolution=function(e){var t=n.props.solutions.find(function(t){return t.id===e});n.props.openSolution(e,t.files[0].id),n.setState({isLoading:!0})},n.openSample=function(e){n.props.openSample(e),n.setState({isLoading:!0})},n.openSharedGist=function(e){var t=n.props,r=t.solutions,o=t.openGist,a=e.id,i=e.url,c=r.filter(function(e){return e.source&&"gist"===e.source.origin&&e.source.id===a});c.length>0?n.showGistConflictDialog(e,c):o(i,a),n.setState({isLoading:!0})},n.showGistConflictDialog=function(e,t){return n.setState({conflictingGist:e,existingSolutionsConflicting:t})},n.hideGistConflictDialog=function(){return n.setState({conflictingGist:null,existingSolutionsConflicting:null,isLoading:!1})},n.signIn=function(){n.props.signIn(),n.setState({isLoading:!0})},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentDidMount",value:function(){this.resizeListener=window.addEventListener("resize",Wi()(this.setWidth,100)),this.setWidth()}},{key:"componentWillUnmount",value:function(){this.setState({selectedKey:"my-solutions",isLoading:!1})}},{key:"render",value:function(){var e=this,t=0!==this.props.solutions.length,n=[{"data-testid":"back",key:"back",ariaLabel:"Back",icon:t?"GlobalNavButton":"",isHidden:!t,onClick:t?this.props.goBack:function(){}},{"data-testid":"new",key:"new",label:"New Snippet",icon:"Add",onClick:function(){e.props.createNewSolution()}},{"data-testid":"my-solutions",key:"my-solutions",label:"My Snippets",icon:"DocumentSet",content:I.a.createElement(Xc,{solutions:this.props.solutions,openSolution:this.openSolution,activeSolution:this.props.activeSolution,gistMetadata:this.props.sharedGistMetadata,openGist:this.openSharedGist,isSignedIn:this.props.isSignedIn,signIn:this.props.signIn})},{"data-testid":"samples",key:"samples",label:"Samples",icon:"Dictionary",content:I.a.createElement(Zc,{openSample:this.openSample,samplesByGroup:this.props.samplesByGroup})},{"data-testid":"import",key:"import",label:"Import",icon:"Download",content:I.a.createElement(es,{importGist:this.props.importGist})}].map(function(t){return Object(be.a)({onClick:function(){return e.setState({selectedKey:t.key})}},t)}),r=this.state,o=r.selectedKey,a=r.conflictingGist,i=r.existingSolutionsConflicting,c=r.width,s=n.find(function(e){return e.key===o});return I.a.createElement("div",{ref:this.containerDomNode},I.a.createElement(mc,null,I.a.createElement(kc,{isCompact:c<=500,selectedKey:this.state.selectedKey,items:n}),I.a.createElement(yc,null,s&&s.content,I.a.createElement(Re.a,{when:this.state.isLoading},I.a.createElement(Oc,null,I.a.createElement(Ba.a,{size:Pa.a.large})))),a&&i&&I.a.createElement(os,{conflictingGist:a,existingSolutions:i,closeDialog:this.hideGistConflictDialog,openGist:this.props.openGist})))}}]),t}(T.Component),is=Object(Oi.b)(function(e){return{solutions:Jr.solutions.getInLastOpenedOrder(e),activeSolution:Jr.editor.getActiveSolution(e),sharedGistMetadata:Jr.gists.getGistMetadata(e),samplesByGroup:Jr.samples.getMetadataByGroup(e),isSignedIn:!!Jr.github.getToken(e)}},function(e){return{createNewSolution:function(){return e(y.create())},openSolution:function(t,n){return e(u.openFile({solutionId:t,fileId:n}))},openSample:function(t){return e(h.get.request({rawUrl:t}))},openGist:function(t,n,r){return e(l.get.request({rawUrl:t,gistId:n,conflictResolution:r}))},importGist:function(t,n){return e(l.importSnippet.request({gistId:t,gist:n}))},goBack:function(){return e(u.open())},signIn:function(){return e(d.showLoginDialog())}}})(as),cs=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).handleResize=function(){return n.props.updateSize(window.innerWidth,window.innerHeight)},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return null}}]),t}(I.a.Component),ss=Object(Oi.b)(null,function(e){return{updateSize:function(t,n){return e(hr.screen.updateSize({width:t,height:n}))}}})(cs),us=window.crypto||window.msCrypto,ls=function(e){function t(){var e,n;Object(ae.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(ce.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(o)))).state={},n.onDialogShown=Object(k.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.keyGenerationInProgress){e.next=22;break}return n.keyGenerationInProgress=!0,e.prev=2,e.next=5,fs(us.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["encrypt","decrypt"]));case 5:return t=e.sent,n.privateKey=t.privateKey,e.t0=n,e.t1=we.currentEditorUrl+"/#/auth?key=",e.t2=ze.bufferToHexString,e.next=12,fs(us.subtle.exportKey("spki",t.publicKey));case 12:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t5=e.t1+e.t4,e.t6={authUrl:e.t5},e.t0.setState.call(e.t0,e.t6),e.next=22;break;case 19:e.prev=19,e.t7=e.catch(2),n.setState({errorMessage:e.t7.toString()});case 22:n.setState({errorMessage:null,encodedToken:null,decodedToken:null});case 23:case"end":return e.stop()}},e,this,[[2,19]])})),n.shouldAllowOk=function(){return Boolean(!n.state.errorMessage&&n.state.encodedToken)},n.onOk=Object(k.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ce(n.state.decodedToken);case 3:t=e.sent,n.props.onLoginSuccess(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.setState({errorMessage:"The encrypted token is invalid. Please make sure you pasted the full token, and that it's from a recent invocation of the auth URL. If it still isn't working, try going through the auth flow again."});case 10:case"end":return e.stop()}},e,this,[[0,7]])})),n.onTokenInput=function(){var e=Object(k.a)(A.a.mark(function e(t,r){var o;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({encodedToken:r,errorMessage:null,decodedToken:null}),!r){e.next=11;break}return e.prev=2,e.next=5,fs(us.subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},n.privateKey,Object(ze.hexStringToBuffer)(r)));case 5:o=e.sent,n.setState({decodedToken:Object(ze.bufferToUnicodeString)(o)}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t,n){return e.apply(this,arguments)}}(),n.onEnterKeyPress=function(e){"Enter"===e.key&&n.onOk()},n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"componentDidMount",value:function(){Object(C.hideSplashScreen)()}},{key:"render",value:function(){return I.a.createElement(Ge.a,{hidden:!this.props.isOpen,onDismiss:this.props.cancel,dialogContentProps:{type:He.a.normal,title:"Action required"},modalProps:{isBlocking:!0,layerProps:{onLayerDidMount:this.onDialogShown}}},this.state.authUrl?I.a.createElement(I.a.Fragment,null,I.a.createElement(Ei.a,null,"To log in with GitHub, please open the following URL in a browser window:"),I.a.createElement(Le.a,{text:this.state.authUrl}),I.a.createElement(Ei.a,{styles:{root:{marginTop:"1.5rem"}}},"After completing the authentication flow, paste in the resulting token:"),I.a.createElement(Na.a,{placeholder:"<Paste token here>",onChange:this.onTokenInput,errorMessage:this.state.errorMessage,iconProps:this.state.decodedToken?{iconName:"Checkmark"}:{},required:!this.state.decodedToken,onKeyPress:this.onEnterKeyPress})):I.a.createElement(Ei.a,null,"Please wait while we prepare the authentication dialog. This may take a few seconds..."),I.a.createElement(_i.a,null,I.a.createElement(wi.a,{onClick:this.onOk,disabled:!this.shouldAllowOk(),text:"OK"}),I.a.createElement(Ho.a,{onClick:this.props.cancel,text:"Cancel"})))}}]),t}(I.a.Component),ds=Object(Oi.b)(Object(Dt.createStructuredSelector)({isOpen:Jr.github.getIsAuthDialogOpen}),{onLoginSuccess:O.github.loginSuccessful,cancel:O.github.cancelLogin})(ls);function fs(e){return new Promise(function(t,n){window.msCrypto?(e.onerror=function(e){return n(e)},e.oncomplete=function(e){return t(e.target.result)}):e.then(function(e){return t(e)},function(e){return n(e)})})}var ps=function(e){function t(e){var n;return Object(ae.a)(this,t),(n=Object(ce.a)(this,Object(se.a)(t).call(this,e))).props.initialize(),n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isBackstageVisible,n=e.host;return I.a.createElement(me.a,{host:n},I.a.createElement(Re.a,{when:t},I.a.createElement(is,null)),I.a.createElement(cc,null),I.a.createElement(ss,null),I.a.createElement(ds,null))}}]),t}(I.a.Component),ms=Object(Oi.b)(function(e){return{host:E.host.get(e),isBackstageVisible:e.editor.isBackstageVisible}},{initialize:O.misc.initialize})(ps),hs=n(84),gs={isVisible:!1,style:He.a.largeHeader,title:"",subText:"",isBlocking:!1,buttons:[]},bs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gs,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(hr.dialog.show):return{isVisible:!0,style:t.payload.style,title:t.payload.title,subText:t.payload.subText,isBlocking:t.payload.isBlocking,buttons:t.payload.buttons};case Object(fn.getType)(hr.dialog.hide):return Object(be.a)({},e,{isVisible:!1});case Object(fn.getType)(hr.dialog.reset):return gs;default:return e}},ys=n(929),Os=n.n(ys),vs=Object(hs.combineReducers)({isVisible:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case Object(fn.getType)(u.open):return!0;case Object(fn.getType)(u.hide):case Object(fn.getType)(u.openBackstage):return!1;case Object(fn.getType)(u.hideBackstage):return!0;default:return e}},isBackstageVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case Object(fn.getType)(u.openBackstage):return!0;case Object(fn.getType)(u.hideBackstage):case Object(fn.getType)(u.open):return!1;default:return e}},hasLoaded:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case Object(fn.getType)(u.onMount):return!0;default:return e}},intellisenseFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(u.setIntellisenseFiles.success):return Object(be.a)({},e,t.payload);case Object(fn.getType)(u.removeIntellisenseFiles):return Os()(Object(be.a)({},e),t.payload);default:return e}},active:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{solutionId:null,fileId:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(u.setActive):return t.payload;default:return e}}}),js=Object(hs.combineReducers)({loginInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(d.loginSuccessful):return t.payload;case Object(fn.getType)(d.logout):return null;case Object(fn.getType)(l.fetchMetadata.failure):return t.payload.shouldLogUserOut?null:e;default:return e}},isLoggingInOrOut:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case Object(fn.getType)(d.showLoginDialog):return!0;case Object(fn.getType)(d.cancelLogin):case Object(fn.getType)(d.loginSuccessful):return!1;default:return e}},isAuthDialogVisible:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case Object(fn.getType)(d.showLoginDialog):return!0;case Object(fn.getType)(d.cancelLogin):case Object(fn.getType)(d.loginSuccessful):return!1;default:return e}}}),Ss={isVisible:!1,style:fe.a.info,text:"",link:null},_s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ss,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(l.create.success):return{isVisible:!0,style:fe.a.success,text:"Your gist has been published.",link:{text:"View on GitHub",url:"https://gist.github.com/".concat(t.payload.gist.id)}};case Object(fn.getType)(l.update.failure):return{isVisible:!0,style:fe.a.error,text:"Error in updating gist: ".concat(t.payload),link:null};case Object(fn.getType)(l.update.success):return{isVisible:!0,style:fe.a.success,text:"Your gist has been updated.",link:{text:"View on GitHub",url:"https://gist.github.com/".concat(t.payload.gist.id)}};case Object(fn.getType)(b.edit.failure):return{isVisible:!0,style:fe.a.error,text:"Settings ".concat(t.payload),link:null};case Object(fn.getType)(l.importSnippet.failure):return{isVisible:!0,style:fe.a.error,text:"".concat(t.payload),link:null};case Object(fn.getType)(p.show):return t.payload;case Object(fn.getType)(u.newSolutionOpened):return t.payload.options.isUntrusted?{isVisible:!0,style:fe.a.warning,text:"Would you like to trust this snippet?",link:null,button:{text:"Trust",action:y.updateOptions({id:t.payload.id,options:{isUntrusted:!1}})}}:Ss;case Object(fn.getType)(u.openFile):case Object(fn.getType)(b.edit.success):case Object(fn.getType)(p.dismiss):return Ss;default:return e}},ws={solutionId:null,fileId:null},Es=Object(hs.combineReducers)({userSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_r,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(b.edit.success):return t.payload.userSettings;default:return e}},lastActive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ws,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(b.setLastActive):var n=t.payload;return{solutionId:n.solutionId,fileId:n.fileId};default:return e}}});function xs(e,t,n,r){var o=n;if(!o)return{};var a=r||e[t].host,i=Object.values(e).filter(function(e){return e.host===a&&e.id!==t}).map(function(e){return e.name});if(i.includes(o)){o=o.replace(/\(\d+\)$/gm,"").trim();for(var c=1;i.includes("".concat(o," (").concat(c,")"));)c++;o="".concat(o," (").concat(c,")")}return{name:o}}var As=Object(hs.combineReducers)({metadata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(y.add):return Object(be.a)({},e,Object(R.a)({},t.payload.id,Object(be.a)({},t.payload,xs(e,t.payload.id,t.payload.name,t.payload.host),{files:t.payload.files.map(function(e){return e.id})})));case Object(fn.getType)(y.edit):return Object(be.a)({},e,Object(R.a)({},t.payload.id,Object(be.a)({},e[t.payload.id],t.payload.solution,xs(e,t.payload.id,t.payload.solution?t.payload.solution.name:void 0),{dateLastModified:t.payload.timestamp})));case Object(fn.getType)(y.updateLastOpened):return Object(be.a)({},e,Object(R.a)({},t.payload.solutionId,Object(be.a)({},e[t.payload.solutionId],{dateLastOpened:t.payload.timestamp})));case Object(fn.getType)(y.deleteFromState):return e[t.payload.id],Object(tn.a)(e,[t.payload.id]);default:return e}},files:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(y.add):var n=t.payload.files.reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.id,t))},{});return Object(be.a)({},e,n);case Object(fn.getType)(y.edit):var r=t.payload,o=r.file,a=r.fileId;return o&&a?Object(be.a)({},e,Object(R.a)({},a,Object(be.a)({},e[a],o,{dateLastModified:t.payload.timestamp}))):e;case Object(fn.getType)(y.changeLanguage):var i=t.payload,c=i.fileId,s=i.language;return Object(be.a)({},e,Object(R.a)({},c,Object(be.a)({},e[c],{language:s})));case Object(fn.getType)(y.updateLastOpened):return Object(be.a)({},e,Object(R.a)({},t.payload.fileId,Object(be.a)({},e[t.payload.fileId],{dateLastOpened:t.payload.timestamp})));case Object(fn.getType)(y.deleteFromState):var u=t.payload.files.map(function(e){return e.id});return Object.keys(e).map(function(t){return e[t]}).reduce(function(e,t){return u.includes(t.id)||(e[t.id]=t),e},{});default:return e}}}),ks=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(l.fetchMetadata.success):return t.payload.reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.id,t))},{});case Object(fn.getType)(d.logout):return{};default:return e}},Cs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he.Utilities.host,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(f.change):return Object.keys(he.HostType).map(function(e){return he.HostType[e]}).includes(t.payload)?t.payload:e;default:return e}},Ts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(h.fetchMetadata.success):return t.payload.reduce(function(e,t){return Object(be.a)({},e,Object(R.a)({},t.id,t))},Object(be.a)({},e));case Object(fn.getType)(h.fetchMetadata.failure):return{};default:return e}},Is=Object(hs.combineReducers)({width:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(g.updateSize):return t.payload.width;default:return e}},height:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(fn.getType)(g.updateSize):return t.payload.height;default:return e}}}),Ds=Object(hs.combineReducers)({dialog:bs,editor:vs,github:js,messageBar:_s,settings:Es,solutions:As,gists:ks,host:Cs,samples:Ts,screen:Is}),Ls=n(930),Bs=n(933),Ps=A.a.mark(Ns),Rs=A.a.mark(Us);function Ns(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(s.dismiss),Us);case 2:case"end":return e.stop()}},Ps,this)}function Us(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.c)(s.hide());case 2:return e.next=4,Object(le.pause)(500);case 4:return e.next=6,Object(eo.c)(s.reset());case 6:case"end":return e.stop()}},Rs,this)}var Fs=n(931),Ms=n.n(Fs),Gs=[{label:"lodash",value:"lodash",typings:"@types/lodash",description:"Modular utilities used simplify array or object manipulations."},{label:"office-js",value:"https://appsforoffice.microsoft.com/lib/1/hosted/Office.js",typings:"@types/office-js",description:"JavaScript framework used to build Office Add-ins."},{label:"office-ui-fabric-js",value:["office-ui-fabric-js/dist/css/fabric.min.css","office-ui-fabric-js/dist/css/fabric.components.min.css","office-ui-fabric-js/dist/js/fabric.min.js"],description:"JavaScript front-end framework for building experiences for Office 365."},{label:"jquery",value:"jquery",typings:"@types/jquery",description:"JavaScript library for DOM operations."},{label:"@microsoft/office-js-helpers",value:"@microsoft/office-js-helpers/dist/office.helpers.min.js",typings:"@microsoft/office-js-helpers/dist/office.helpers.d.ts",description:"An open-source collection of helpers for developing Office Add-ins."},{label:"core-js",value:"core-js/client/core.min.js",typings:"@types/core-js",description:"Standard es6, es7 shim library"},{label:"whatwg-fetch",value:"whatwg-fetch",typings:["@types/whatwg-fetch","@types/whatwg-streams"],description:"A window.fetch polyfill."}];function Hs(){return!!window.monaco}var Ws={STARTS_WITH_TYPINGS:/^.types\/.+|^dt~.+/i,STARTS_WITH_COMMENT:/^#.*|^\/\/.*|^\/\*.*|.*\*\/$.*/im,ENDS_WITH_CSS:/.*\.css$/i,ENDS_WITH_DTS:/.*\.d\.ts$/i,GLOBAL:/^.*/i,TRIPLE_SLASH_REF:/\/\/\/\s*<reference\spath="(.+\.d\.ts)"\s*\/>/gm};function zs(e){n.e(0).then(n.t.bind(null,1358,7)).then(function(t){var n={provideDocumentFormattingEdits:function(n,r,o){var a=n.getValue(),i=qs(t,a,e);return[{range:n.getFullModelRange(),text:i}]}};monaco.languages.registerDocumentFormattingEditProvider("typescript",n)})}function Ks(e,t){return Js.apply(this,arguments)}function Js(){return(Js=Object(k.a)(A.a.mark(function e(t,r){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.e(0).then(n.t.bind(null,1358,7)).then(function(e){return qs(e,t,r)}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function qs(e,t,n){try{return Ms.a.format(t,{parser:"typescript",plugins:[e],tabWidth:n.tabWidth,arrowParens:"always",printWidth:120})}catch(r){return t}}function Vs(e,t){var n=Ws.TRIPLE_SLASH_REF.exec(t);if(Ws.TRIPLE_SLASH_REF.lastIndex=0,!n)return[];for(var r=t,o=e.split("/"),a=o.slice(0,o.length-1).join("/"),i=[];n;){var c=n,s=Object(At.a)(c,2),u=s[0],l=s[1],d="".concat(a,"/").concat(l);i.push(d),r=r.replace(u,""),n=Ws.TRIPLE_SLASH_REF.exec(r),Ws.TRIPLE_SLASH_REF.lastIndex=0}return i}var Ys={};function Qs(e){return $s.apply(this,arguments)}function $s(){return($s=Object(k.a)(A.a.mark(function e(t){var n,r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in Ys)){e.next=2;break}return e.abrupt("return",Ys[t]);case 2:return e.next=4,fetch(t);case 4:if(!(n=e.sent).ok){e.next=11;break}return e.next=8,n.text();case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=null;case 12:return r=e.t0,Ys[t]=r,e.abrupt("return",r);case 15:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Xs,Zs=A.a.mark(pu),eu=A.a.mark(mu),tu=A.a.mark(hu),nu=A.a.mark(gu),ru=A.a.mark(bu),ou=A.a.mark(yu),au=A.a.mark(Ou),iu=A.a.mark(vu),cu=A.a.mark(ju),su=A.a.mark(Su),uu=A.a.mark(_u),lu=A.a.mark(wu),du=A.a.mark(Eu),fu=Ao.getLogger("Editor");function pu(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(u.openFile),mu);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(y.edit),hu);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(u.newSolutionOpened),gu);case 6:return e.next=8,Object(eo.e)(Object(fn.getType)(u.newFileOpened),bu);case 8:return e.next=10,Object(eo.e)(Object(fn.getType)(u.onMount),Ou);case 10:return e.next=12,Object(eo.e)(Object(fn.getType)(m.hideLoadingSplashScreen),yu);case 12:return e.next=14,Object(eo.e)(Object(fn.getType)(u.applyMonacoOptions),vu);case 14:return e.next=16,Object(eo.e)(Object(fn.getType)(b.edit.success),vu);case 16:return e.next=18,Object(eo.e)(Object(fn.getType)(u.shouldUpdateIntellisense),ju);case 18:return e.next=20,Object(eo.e)(Object(fn.getType)(u.setIntellisenseFiles.request),Su);case 20:return e.next=22,Object(eo.e)(Object(fn.getType)(g.updateSize),_u);case 22:return e.next=24,Object(eo.e)(Object(fn.getType)(p.dismiss),_u);case 24:return e.next=26,Object(eo.e)(Object(fn.getType)(u.applyFormatting),wu);case 26:return e.next=28,Object(eo.e)(Object(fn.getType)(u.navigateToRun),Eu);case 28:case"end":return e.stop()}},Zs,this)}function mu(e){var t,n,r,o,a,i,c;return A.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(eo.d)(Jr.editor.getActiveSolution);case 2:return t=s.sent,s.next=5,Object(eo.d)(Jr.editor.getActiveFile);case 5:if(n=s.sent,r=e.payload,o=r.solutionId,a=r.fileId,o){s.next=13;break}if(t.files.find(function(e){return e.id===a})){s.next=12;break}throw new Error("The file id ".concat(a," does not exist in current open solution."));case 12:o=t.id;case 13:return s.next=15,Object(eo.c)(u.setActive({solutionId:o,fileId:a}));case 15:if(o===z){s.next=18;break}return s.next=18,Object(eo.c)(u.open());case 18:return s.next=20,Object(eo.d)(Jr.solutions.get,o);case 20:return i=s.sent,s.next=23,Object(eo.d)(Jr.solutions.getFile,a);case 23:if(c=s.sent,!i||t.id===o){s.next=27;break}return s.next=27,Object(eo.c)(u.newSolutionOpened(i));case 27:if(!c||n.id===a){s.next=30;break}return s.next=30,Object(eo.c)(u.newFileOpened(i,c));case 30:case"end":return s.stop()}},eu,this)}function hu(e){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},tu,this)}function gu(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},nu,this)}function bu(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Hs()){t.next=3;break}return t.next=3,Object(eo.c)(u.applyMonacoOptions());case 3:if("typescript"!==e.payload.file.language){t.next=6;break}return t.next=6,Object(eo.c)(u.shouldUpdateIntellisense());case 6:return t.next=8,Object(eo.c)(y.updateLastOpened({solutionId:e.payload.solution.id,fileId:e.payload.file.id}));case 8:case"end":return t.stop()}},ru,this)}function yu(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Object(C.hideSplashScreen)();case 1:case"end":return e.stop()}},ou,this)}function Ou(e){var t;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Xs=e.payload,n.next=3,Object(eo.d)(Jr.settings.getMonacoTheme);case 3:return(t=n.sent)&&monaco.editor.setTheme(t),Hs()&&(monaco.languages.register({id:"libraries"}),monaco.languages.setMonarchTokensProvider("libraries",{tokenizer:{root:[{regex:Ws.STARTS_WITH_COMMENT,action:{token:"comment"}},{regex:Ws.ENDS_WITH_CSS,action:{token:"number"}},{regex:Ws.STARTS_WITH_TYPINGS,action:{token:"string"}},{regex:Ws.ENDS_WITH_DTS,action:{token:"string"}},{regex:Ws.GLOBAL,action:{token:"keyword"}}]},tokenPostfix:""}),monaco.languages.registerCompletionItemProvider("libraries",{provideCompletionItems:function(e,t){var n=e.getValueInRange({startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:1,endColumn:t.column});return Ws.STARTS_WITH_COMMENT.test(n)?{suggestions:[]}:""===n?{suggestions:Gs.map(function(e){var t="";return Array.isArray(e.value)?t+=e.value.join("\n"):(t+=e.value||"",t+="\n"),Array.isArray(e.typings)?t+=e.typings.join("\n"):(t+=e.typings||"",t+="\n"),{label:e.label,documentation:e.description,kind:monaco.languages.CompletionItemKind.Module,insertText:t,range:null}})}:{suggestions:[]}}})),Xs.addAction({id:"trigger-suggest",label:"Trigger suggestion",keybindings:[monaco.KeyCode.F2],contextMenuGroupId:"navigation",contextMenuOrder:0,run:function(){return Xs.trigger("editor","editor.action.triggerSuggest",{})}}),n.next=9,Object(eo.c)(u.applyMonacoOptions());case 9:return n.next=11,Object(eo.c)(m.hideLoadingSplashScreen());case 11:return n.next=13,Object(eo.b)(ju);case 13:case"end":return n.stop()}},au,this)}function vu(){var e,t;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!Xs){n.next=7;break}return n.next=3,Object(eo.d)(Jr.settings.getMonacoOptions);case 3:e=n.sent,t=e.theme,Xs.updateOptions(e),monaco.editor.setTheme(t);case 7:return n.next=9,Object(eo.d)(Jr.settings.getIsPrettierEnabled);case 9:if(!n.sent){n.next=15;break}return n.next=13,Object(eo.d)(Jr.settings.getTabSize);case 13:zs({tabWidth:n.sent});case 15:case"end":return n.stop()}},iu,this)}function ju(){var e,t,n,r,o,a,i,c;return A.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(Hs()){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,Object(eo.d)(Jr.editor.getActiveSolution);case 4:if(e=s.sent,t=Object(ut.findScript)(e)){s.next=8;break}return s.abrupt("return");case 8:if("typescript"===t.language){s.next=10;break}return s.abrupt("return");case 10:if(n=Object(ut.findLibraries)(e)){s.next=13;break}return s.abrupt("return");case 13:return s.next=15,Object(eo.d)(Jr.host.get);case 15:r=s.sent,o=("EXCEL"===r?["@types/custom-functions-runtime"]:[]).concat(Object(ge.a)(n.content.split("\n"))),a=o.map(function(e){if((e=e.trim()).startsWith("//")||e.startsWith("#"))return null;if(/^@types/.test(e))return"https://unpkg.com/".concat(e,"/index.d.ts");if(/^dt~/.test(e)){var t=e.split("dt~")[1];return"https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/".concat(t,"/index.d.ts")}return/\.d\.ts$/i.test(e)?/^https?:/i.test(e)?e:"https://unpkg.com/".concat(e):null}).filter(function(e){return e}),i=[];case 20:if(!(a.length>0)){s.next=27;break}return c=Object(ge.a)(a),a=[],s.next=25,Object(eo.a)(c.map(function(e){return Qs(e).then(function(t){if(t){i.push(e),fu.info("Fetched IntelliSense for ".concat(e));var n=Vs(e,t);n.length>0&&(fu.info("Need to follow up with IntelliSense fetch for ",n),a=Object(ge.a)(a).concat(Object(ge.a)(n)))}else fu.error('Could not fetch library "'.concat(e,'".'))})}));case 25:s.next=20;break;case 27:return fu.info(["Ready to give URLS to Monaco: "].concat(Object(ge.a)(i.map(function(e){return" - "+e}))).join("\n")),s.next=30,Object(eo.c)(u.setIntellisenseFiles.request({urls:i}));case 30:case"end":return s.stop()}},cu,this)}function Su(e){var t,n,r,o,a,i;return A.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(eo.d)(Jr.editor.getIntellisenseFiles);case 2:return t=c.sent,n=Object.keys(t),r=e.payload.urls,(o=n.filter(function(e){return!r.includes(e)})).forEach(function(e){return t[e].dispose()}),c.next=9,Object(eo.c)(u.removeIntellisenseFiles(o));case 9:return a=r.filter(function(e){return!n.includes(e)}),c.next=12,Object(eo.b)(function(){return Promise.all(Object(ge.a)(new Set(a)).map(function(e){return Qs(e).then(function(t){if(t){var n=monaco.languages.typescript.typescriptDefaults.addExtraLib(t,e);return{url:e,disposable:n}}return null})}).filter(function(e){return null!==e}))});case 12:return i=c.sent,c.next=15,Object(eo.c)(u.setIntellisenseFiles.success(i.reduce(function(e,t){var n=t.url,r=t.disposable;return Object(be.a)({},e,Object(R.a)({},n,r))},{})));case 15:case"end":return c.stop()}},su,this)}function _u(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Xs&&Xs.layout();case 1:case"end":return e.stop()}},uu,this)}function wu(){var e;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.d)(Jr.settings.getIsAutoFormatEnabled);case 2:e=t.sent,Xs&&e&&Xs.trigger("editor","editor.action.formatDocument","");case 4:case"end":return t.stop()}},lu,this)}function Eu(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.href="".concat(we.currentRunnerUrl,"?backButton=true");case 1:case"end":return e.stop()}},du,this)}var xu=A.a.mark(Nu),Au=A.a.mark(Uu),ku=A.a.mark(Fu),Cu=A.a.mark(Mu),Tu=A.a.mark(Gu),Iu=A.a.mark(Hu),Du=A.a.mark(Wu),Lu=A.a.mark(zu),Bu=A.a.mark(Ku),Pu=A.a.mark(Ju),Ru=A.a.mark(qu);function Nu(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(y.edit),Uu);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(u.newSolutionOpened),Uu);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(y.create),Fu);case 6:return e.next=8,Object(eo.e)(Object(fn.getType)(y.getDefault.success),Mu);case 8:return e.next=10,Object(eo.e)(Object(fn.getType)(y.getDefault.failure),Gu);case 10:return e.next=12,Object(eo.e)(Object(fn.getType)(y.updateOptions),zu);case 12:return e.next=14,Object(eo.e)(Object(fn.getType)(y.remove),Wu);case 14:return e.next=16,Object(eo.e)(Object(fn.getType)(y.scriptNeedsParsing),qu);case 16:case"end":return e.stop()}},xu,this)}function Uu(e){var t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:a.t0=e.type,a.next=a.t0===Object(fn.getType)(u.newSolutionOpened)?3:a.t0===Object(fn.getType)(y.edit)?5:18;break;case 3:return t=e.payload.id,a.abrupt("break",19);case 5:if(!e.payload.fileId){a.next=17;break}return a.next=8,Object(eo.d)(Jr.solutions.getFile,e.payload.fileId);case 8:if("typescript"!==(n=a.sent).language&&"python"!==n.language){a.next=14;break}return t=e.payload.id,a.abrupt("break",19);case 14:return a.abrupt("return");case 15:a.next=18;break;case 17:return a.abrupt("return");case 18:throw new Error("Unrecognized type.");case 19:return a.next=21,Object(eo.d)(Jr.solutions.get,t);case 21:if(r=a.sent){a.next=24;break}return a.abrupt("return");case 24:if(o=r.files.find(function(e){return e.name===ut.SCRIPT_FILE_NAME})){a.next=27;break}return a.abrupt("return");case 27:return a.next=29,Object(eo.c)(y.scriptNeedsParsing({solution:r,file:o}));case 29:case"end":return a.stop()}},Au,this)}function Fu(){var e,t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(eo.d)(Jr.host.get);case 2:return e=a.sent,a.next=5,Object(eo.b)(ve,"".concat(we.currentOfficeJsRawSnippetsBaseRepoUrl,"/samples/").concat(e.toLowerCase(),"/default.yaml"));case 5:if(t=a.sent,n=t.content,r=t.error,!n){a.next=13;break}return o=$r(n),a.next=11,Object(eo.c)(y.getDefault.success({solution:o}));case 11:a.next=15;break;case 13:return a.next=15,Object(eo.c)(y.getDefault.failure(r));case 15:case"end":return a.stop()}},ku,this)}function Mu(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.b)(Hu,e.payload.solution);case 2:case"end":return t.stop()}},Cu,this)}function Gu(e){var t,n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.d)(Jr.host.get);case 2:return t=e.sent,n=Qr(t),e.next=6,Object(eo.b)(Hu,n);case 6:case"end":return e.stop()}},Tu,this)}function Hu(e){var t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e,a.next=3,Object(eo.d)(Jr.settings.getTabSize);case 3:if(n=a.sent,!(r=e.files.find(function(e){return e.name===ut.SCRIPT_FILE_NAME}))){a.next=10;break}return a.next=8,Object(eo.b)(Ks,r.content,{tabWidth:n});case 8:o=a.sent,t=Object(be.a)({},e,{files:[Object(be.a)({},r,{content:o})].concat(Object(ge.a)(e.files.filter(function(e){return e.name!==ut.SCRIPT_FILE_NAME})))});case 10:return a.next=12,Object(eo.c)(y.add(t));case 12:return a.next=14,Object(eo.c)(u.openFile({solutionId:t.id,fileId:t.files[0].id}));case 14:case"end":return a.stop()}},Iu,this)}function Wu(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.b)(Ju);case 2:return t.next=4,Object(eo.c)(y.deleteFromState(e.payload));case 4:return t.next=6,Object(eo.b)(So,e.payload.id);case 6:case"end":return t.stop()}},Du,this)}function zu(e){var t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,n=t.options,r=t.id,a.next=3,Object(eo.d)(Jr.solutions.get,r);case 3:if(!(o=a.sent).options.isUntrusted||!1!==n.isUntrusted){a.next=7;break}return a.next=7,Object(eo.c)(p.dismiss());case 7:return a.next=9,Object(eo.c)(y.edit({id:o.id,solution:{options:Object(be.a)({},o.options,n)}}));case 9:case"end":return a.stop()}},Lu,this)}function Ku(){var e;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.d)(Jr.solutions.getInLastOpenedOrder);case 2:if(0!==(e=t.sent).length){t.next=10;break}return t.next=6,Object(eo.c)(u.openFile({solutionId:z,fileId:H}));case 6:return t.next=8,Object(eo.c)(u.openBackstage());case 8:t.next=12;break;case 10:return t.next=12,Object(eo.c)(u.openFile({solutionId:e[0].id,fileId:e[0].files[0].id}));case 12:case"end":return t.stop()}},Bu,this)}function Ju(){var e;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.d)(Jr.solutions.getInLastOpenedOrder);case 2:if(!((e=t.sent).length<=1)){t.next=10;break}return t.next=6,Object(eo.c)(u.openFile({solutionId:z,fileId:H}));case 6:return t.next=8,Object(eo.c)(u.openBackstage());case 8:t.next=12;break;case 10:return t.next=12,Object(eo.c)(u.openFile({solutionId:e[1].id,fileId:e[1].files[0].id}));case 12:case"end":return t.stop()}},Pu,this)}function qu(e){var t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.payload,n=t.solution,r=t.file,o=({typescript:function(){return e=r.content,!!/[\s\*]@customfunction[\s\*]/i.test(e)&&Object(ft.parseTree)(e,"",Ot()).functions.length>0;var e},python:function(){return e=r.content,ht.test(e);var e}}[r.language]||function(){return!1})(),!(!n.options.isCustomFunctionsSolution&&o||n.options.isCustomFunctionsSolution&&!o)){a.next=6;break}return a.next=6,Object(eo.c)(y.updateOptions({id:n.id,options:{isCustomFunctionsSolution:o}}));case 6:case"end":return a.stop()}},Ru,this)}function Vu(e){return Yu.apply(this,arguments)}function Yu(){return(Yu=Object(k.a)(A.a.mark(function e(t){var n,r,o,a,i;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Office.onReady();case 2:if(n=e.sent,r=n.host,o=!!r){e.next=7;break}return e.abrupt("return");case 7:if(a=fi()(t.libraries||"",o).officeJs||"",a.toLowerCase().includes("https://appsforoffice.microsoft.com/lib/1/hosted/")){e.next=11;break}return e.abrupt("return");case 11:i=t.api_set||{},Object.entries(i).forEach(function(e){var t=Object(At.a)(e,2),n=t[0],o=t[1];if(!Office.context.requirements.isSetSupported(n,o))throw new Error("".concat(r," does not support the required API Set ").concat(n," @ ").concat(o))});case 13:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Qu=A.a.mark(sl),$u=A.a.mark(ul),Xu=A.a.mark(ll),Zu=A.a.mark(dl),el=A.a.mark(fl),tl=A.a.mark(pl),nl=A.a.mark(ml),rl=A.a.mark(hl),ol=A.a.mark(gl),al=A.a.mark(bl),il=A.a.mark(yl),cl=A.a.mark(Ol);function sl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(l.fetchMetadata.request),ul);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(l.fetchMetadata.success),ll);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(l.fetchMetadata.failure),dl);case 6:return e.next=8,Object(eo.e)(Object(fn.getType)(l.get.request),fl);case 8:return e.next=10,Object(eo.e)(Object(fn.getType)(l.get.success),ml);case 10:return e.next=12,Object(eo.e)(Object(fn.getType)(l.create.request),hl);case 12:return e.next=14,Object(eo.e)(Object(fn.getType)(l.create.success),gl);case 14:return e.next=16,Object(eo.e)(Object(fn.getType)(l.create.success),ul);case 16:return e.next=18,Object(eo.e)(Object(fn.getType)(l.update.request),bl);case 18:return e.next=20,Object(eo.e)(Object(fn.getType)(l.importSnippet.request),yl);case 20:return e.next=22,Object(eo.e)(Object(fn.getType)(l.importSnippet.success),Ol);case 22:case"end":return e.stop()}},Qu,this)}function ul(){var e,t,n,r,o,a;return A.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(eo.d)(Jr.github.getToken);case 2:if(e=i.sent){i.next=5;break}return i.abrupt("return");case 5:return i.next=7,Object(eo.d)(Jr.host.get);case 7:return t=i.sent,i.next=10,Object(eo.b)(Ae,{method:"GET",path:"gists?per_page=100",token:e,isArrayResponse:!0});case 10:if(n=i.sent,r=n.response,o=n.error,!r){i.next=19;break}return a=r.filter(function(e){var t=e.files;return 1===Object.keys(t).length&&/^(.*)\.yaml$/.test(t[Object.keys(t)[0]].filename)}).map(function(e){var n=e.files,r=e.id,o=e.description,a=n[Object.keys(n)[0]],i=/^(.*)\.(EXCEL|WORD|POWERPOINT|ACCESS|PROJECT|OUTLOOK|ONENOTE|WEB)\.yaml$/.exec(a.filename),c=null!==i?{title:i[1],host:i[2]}:{title:a.filename.replace(".yaml",""),host:t},s=c.title,u=c.host;return{url:a.raw_url,host:u,id:r,description:o,title:s,isPublic:e.public}}),i.next=17,Object(eo.c)(l.fetchMetadata.success(a));case 17:i.next=21;break;case 19:return i.next=21,Object(eo.c)(l.fetchMetadata.failure({shouldLogUserOut:"Unauthorized"===o.message}));case 21:case"end":return i.stop()}},$u,this)}function ll(e){var t,n,r,o,a,i,c,s,u;return A.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload.map(function(e){return e.id}),l.next=3,Object(eo.d)(Jr.solutions.getAll);case 3:n=l.sent,r=n.filter(function(e){return e.source&&!t.includes(e.source.id)}),o=!0,a=!1,i=void 0,l.prev=8,c=r[Symbol.iterator]();case 10:if(o=(s=c.next()).done){l.next=17;break}return u=s.value,l.next=14,Object(eo.c)(y.edit({id:u.id,solution:{source:void 0}}));case 14:o=!0,l.next=10;break;case 17:l.next=23;break;case 19:l.prev=19,l.t0=l.catch(8),a=!0,i=l.t0;case 23:l.prev=23,l.prev=24,o||null==c.return||c.return();case 26:if(l.prev=26,!a){l.next=29;break}throw i;case 29:return l.finish(26);case 30:return l.finish(23);case 31:case"end":return l.stop()}},Xu,this,[[8,19,23,31],[24,,26,30]])}function dl(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.payload.shouldLogUserOut&&Te();case 1:case"end":return t.stop()}},Zu,this)}function fl(e){var t;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.payload.conflictResolution){n.next=19;break}n.t0=e.payload.conflictResolution.type,n.next=n.t0===zc.Open?4:n.t0===zc.Overwrite?8:n.t0===zc.CreateCopy?13:16;break;case 4:return t=e.payload.conflictResolution.existingSolution,n.next=7,Object(eo.c)(u.openFile({solutionId:t.id,fileId:t.files[0].id}));case 7:return n.abrupt("return");case 8:return n.next=10,Object(eo.c)(y.remove(e.payload.conflictResolution.existingSolution));case 10:return n.next=12,Object(eo.b)(pl,e.payload.rawUrl,e.payload.gistId);case 12:return n.abrupt("return");case 13:return n.next=15,Object(eo.b)(pl,e.payload.rawUrl,e.payload.gistId);case 15:return n.abrupt("return");case 16:throw new Error("Unknown option ".concat(e.payload.conflictResolution.type));case 17:n.next=21;break;case 19:return n.next=21,Object(eo.b)(pl,e.payload.rawUrl,e.payload.gistId);case 21:case"end":return n.stop()}},el,this)}function pl(e,t){var n,r,o,a;return A.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(eo.b)(ve,e);case 2:if(n=i.sent,r=n.content,o=n.error,!r){i.next=12;break}return(a=$r(r)).source={id:t,origin:"gist"},i.next=10,Object(eo.c)(l.get.success({solution:a}));case 10:i.next=14;break;case 12:return i.next=14,Object(eo.c)(l.get.failure(o));case 14:case"end":return i.stop()}},tl,this)}function ml(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.b)(Hu,e.payload.solution);case 2:case"end":return t.stop()}},nl,this)}function hl(e){var t,n,r,o,a,i;return A.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(eo.d)(Jr.github.getToken);case 2:if(t=c.sent){c.next=5;break}return c.abrupt("return");case 5:return c.next=7,Object(eo.d)(Jr.solutions.get,e.payload.solutionId);case 7:return n=c.sent,r=Oe.a.safeDump(Xr(n)),c.next=11,Object(eo.b)(Ae,{method:"POST",path:"gists",isArrayResponse:!1,token:t,jsonPayload:JSON.stringify({public:e.payload.isPublic,host:n.host,description:"".concat(n.description),files:Object(R.a)({},"".concat(n.name,".").concat(n.host,".yaml"),{content:r})})});case 11:if(o=c.sent,a=o.response,i=o.error,!a){c.next=19;break}return c.next=17,Object(eo.c)(l.create.success({gist:a,solution:n}));case 17:c.next=21;break;case 19:return c.next=21,Object(eo.c)(l.create.failure(i));case 21:case"end":return c.stop()}},rl,this)}function gl(e){var t;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.solution,n.next=3,Object(eo.c)(y.edit({id:t.id,solution:{source:{id:e.payload.gist.id,origin:"gist"}}}));case 3:case"end":return n.stop()}},ol,this)}function bl(e){var t,n,r,o,a,i,c;return A.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(eo.d)(Jr.github.getToken);case 2:if(t=s.sent){s.next=5;break}return s.abrupt("return");case 5:return s.next=7,Object(eo.d)(Jr.solutions.get,e.payload.solutionId);case 7:if(n=s.sent,r=Oe.a.safeDump(Xr(n)),o=n.source.id){s.next=15;break}return s.next=13,Object(eo.c)(l.update.failure(new Error("No gistId for this solution.")));case 13:s.next=27;break;case 15:return s.next=17,Object(eo.b)(Ae,{method:"PATCH",path:"gists/".concat(o),isArrayResponse:!1,token:t,jsonPayload:JSON.stringify({description:"".concat(n.description),files:Object(R.a)({},"".concat(n.name,".").concat(n.host,".yaml"),{content:r})})});case 17:if(a=s.sent,i=a.response,c=a.error,!i){s.next=25;break}return s.next=23,Object(eo.c)(l.update.success({gist:i}));case 23:s.next=27;break;case 25:return s.next=27,Object(eo.c)(l.update.failure(c));case 27:case"end":return s.stop()}},al,this)}function yl(e){var t,n,r,o,a,i,c,s,d;return A.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(f.prev=0,!e.payload.gistId){f.next=16;break}return f.next=4,Object(eo.b)(Ae,{method:"GET",path:"gists/".concat(e.payload.gistId)});case 4:if(r=f.sent,o=r.response,a=r.error,!o){f.next=13;break}i=o.files,t=o.owner.login,n=Oe.a.safeLoad(i[Object.keys(i)[0]].content),f.next=14;break;case 13:throw a;case 14:f.next=21;break;case 16:if(!e.payload.gist){f.next=20;break}n=Oe.a.safeLoad(e.payload.gist),f.next=21;break;case 20:throw new Error("Either a gistId or gist must be specified");case 21:return c=$r(n),f.next=24,Object(eo.d)(Jr.host.get);case 24:if(s=f.sent,c.host===s){f.next=27;break}throw new Error("Cannot import a snippet created for ".concat(c.host," in ").concat(s,"."));case 27:return f.next=29,Object(eo.b)(Vu,n);case 29:return f.next=31,Object(eo.d)(Jr.github.getUsername);case 31:return d=f.sent,c.options.isUntrusted=t!==d,f.next=35,Object(eo.c)(l.importSnippet.success({solution:c}));case 35:f.next=43;break;case 37:return f.prev=37,f.t0=f.catch(0),f.next=41,Object(eo.c)(l.importSnippet.failure(f.t0));case 41:return f.next=43,Object(eo.c)(u.open());case 43:case"end":return f.stop()}},il,this,[[0,37]])}function Ol(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.b)(Hu,e.payload.solution);case 2:case"end":return t.stop()}},cl,this)}var vl=A.a.mark(Sl),jl=A.a.mark(_l);function Sl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(d.loginSuccessful),ul);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(d.logout),_l);case 4:case"end":return e.stop()}},vl,this)}function _l(e){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.b)(Te);case 2:case"end":return e.stop()}},jl,this)}var wl=A.a.mark(xl),El=A.a.mark(Al);function xl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(f.change),Al);case 2:case"end":return e.stop()}},wl,this)}function Al(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.b)(Ku);case 2:return e.next=4,Object(eo.c)(h.fetchMetadata.request());case 4:return e.next=6,Object(eo.c)(l.fetchMetadata.request());case 6:case"end":return e.stop()}},El,this)}var kl=n(307),Cl=A.a.mark(Pl),Tl=A.a.mark(Rl),Il=A.a.mark(Nl),Dl=A.a.mark(Ul),Ll=A.a.mark(Fl),Bl=A.a.mark(Ml);function Pl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(O.misc.initialize),Rl);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(O.misc.switchEnvironment),Nl);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(O.misc.confirmSwitchEnvironment),Ul);case 6:return e.next=8,Object(eo.e)(Object(fn.getType)(O.misc.popOutEditor),Fl);case 8:return e.next=10,Object(eo.e)(Object(fn.getType)(O.misc.goToCustomFunctionsDashboard),Ml);case 10:case"end":return e.stop()}},Cl,this)}function Rl(){var e;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.d)(E.host.get);case 2:return e=t.sent,t.next=5,Object(eo.c)(O.host.change(e));case 5:case"end":return t.stop()}},Tl,this)}function Nl(e){var t,n,r,o,a,i;return A.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.payload,n=Object(we.getCurrentEnv)(),t===n){c.next=10;break}return r=we.environmentDisplayNames[n],o=we.environmentDisplayNames[t],a="Switch from ".concat(r," to ").concat(o,"?"),"You are about to change your Script Lab environment and will not have access to your saved local snippets until you return to this environment. Are you sure you want to proceed?",i=[{key:"ok-button",text:"OK",isPrimary:!0,action:O.misc.confirmSwitchEnvironment(t)},{key:"cancel-button",text:"Cancel",isPrimary:!1,action:O.dialog.hide()}],c.next=10,Object(eo.c)(O.dialog.show({title:a,subText:"You are about to change your Script Lab environment and will not have access to your saved local snippets until you return to this environment. Are you sure you want to proceed?",buttons:i,isBlocking:!0}));case 10:case"end":return c.stop()}},Il,this)}function Ul(e){var t;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=e.payload,Object(kl.redirectEditorToOtherEnvironment)(t);case 2:case"end":return n.stop()}},Dl,this)}function Fl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Object(C.showSplashScreen)("Navigating to the runner. Please wait..."),Object(Qt.openPopoutCodeEditor)({onSuccess:function(){return window.location.href=we.currentRunnerUrl}});case 2:case"end":return e.stop()}},Ll,this)}function Ml(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.location.href=we.currentEditorUrl+"/custom-functions-with-back-button.html";case 1:case"end":return e.stop()}},Bl,this)}var Gl=A.a.mark(Kl),Hl=A.a.mark(Jl),Wl=A.a.mark(ql),zl=A.a.mark(Vl);function Kl(){var e,t,n,r,o;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(eo.d)(Jr.host.get);case 2:return e=a.sent,t=we.currentOfficeJsRawSnippetsBaseRepoUrl.indexOf("prod")>=0?"playlists-prod":"playlists",a.next=6,Object(eo.b)(ve,"".concat(we.currentOfficeJsRawSnippetsBaseRepoUrl,"/").concat(t,"/").concat(e.toLowerCase(),".yaml"));case 6:if(n=a.sent,r=n.content,o=n.error,!r){a.next=14;break}return a.next=12,Object(eo.c)(h.fetchMetadata.success(r.map(function(t){return Object(be.a)({},t,{host:e})})));case 12:a.next=16;break;case 14:return a.next=16,Object(eo.c)(h.fetchMetadata.failure(o));case 16:case"end":return a.stop()}},Gl,this)}function Jl(e){var t,n,r,o,a;return A.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload.rawUrl,i.next=3,Object(eo.b)(ve,t);case 3:if(n=i.sent,r=n.content,o=n.error,!r){i.next=12;break}return a=$r(r),i.next=10,Object(eo.c)(h.get.success({solution:a}));case 10:i.next=14;break;case 12:return i.next=14,Object(eo.c)(h.get.failure(o));case 14:case"end":return i.stop()}},Hl,this)}function ql(e){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(eo.b)(Hu,e.payload.solution);case 2:case"end":return t.stop()}},Wl,this)}function Vl(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.e)(Object(fn.getType)(h.fetchMetadata.request),Kl);case 2:return e.next=4,Object(eo.e)(Object(fn.getType)(h.get.request),Jl);case 4:return e.next=6,Object(eo.e)(Object(fn.getType)(h.get.success),ql);case 6:case"end":return e.stop()}},zl,this)}var Yl=A.a.mark(Ql);function Ql(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(eo.a)([Ns(),pu(),sl(),Sl(),xl(),Pl(),Vl(),so(),Nu()]);case 2:case"end":return e.stop()}},Yl,this)}var $l=function(e){var t=e.initialState,n=void 0===t?{}:t,r=Object(Bs.a)({onError:function(e){return Object(C.invokeGlobalErrorHandler)(e)}}),o=Object(hs.createStore)(Ds,n,Object(Ls.composeWithDevTools)(Object(hs.applyMiddleware)(r)));return r.run(Ql),o},Xl=function(e){if(Jr.host.getIsWeb()){var t=Jr.host.get(e);sessionStorage.setItem("host",t)}},Zl=function(){var e;return Jr.host.getIsWeb()&&(e=sessionStorage.getItem("host")||void 0),{host:e}},ed=n(932),td=n.n(ed),nd=function(e){function t(e){var n;return Object(ae.a)(this,t),(n=Object(ce.a)(this,Object(se.a)(t).call(this,e))).state={hasLoadedScripts:!1},Object(yi.addScriptTags)([Zr.SCRIPT_URLS.MONACO_LOADER]).then(function(){return function(){return rd.apply(this,arguments)}()}).then(function(){return function(){return yo.apply(this,arguments)}()}).then(function(e){var t=$l({initialState:Object(be.a)({},e,Zl())});t.subscribe(td()(function(){var e=t.getState();Oo(e),Xl(e)},1e3)),n.setState({hasLoadedScripts:!0,store:t})}),n}return Object(ue.a)(t,e),Object(ie.a)(t,[{key:"render",value:function(){var e=this.state,t=e.hasLoadedScripts,n=e.store;return t?I.a.createElement(Oi.a,{store:n},I.a.createElement(ms,null)):null}}]),t}(T.Component);function rd(){return(rd=Object(k.a)(A.a.mark(function e(){var t,n;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){if(Office&&Office.context&&Office.context.diagnostics&&Office.context.diagnostics.version){var e=Office.context.diagnostics.version;return Number.parseInt(e.substr(0,e.indexOf(".")),10)>=16}return!0},e.next=3,Office.onReady();case 3:if((t=e.sent).host&&t.platform===Office.PlatformType.PC&&n())try{window.external.GetHostInfo()}catch(r){Object(C.invokeGlobalErrorHandler)(new Eo.ScriptLabError("Office Update Required","Your Office version is missing important updates, and Script Lab snippets won't be able to run until you install those updates. To install, please follow the instructions at https://docs.microsoft.com/en-us/officeupdates/office-updates-msi"))}case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function od(){var e=Object(zo.a)(["\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n"]);return od=function(){return e},e}var ad=function(){var e=window.location.href,t="#/external-page?destination=",n=e.indexOf(t);if(n<0)return null;var r=decodeURIComponent(e.substr(n+t.length));return function(e){for(var t in Ye.a){var n=Ye.a[t];if(n===e)return!0}return!1}(r)?(Object(C.hideSplashScreen)(),I.a.createElement(id,null,I.a.createElement(wi.a,{style:{margin:"auto"},text:"Open link in new window",onClick:function(){window.open(r),Office.context.ui.messageParent("close")}}))):null};var id=Ko.default.div(od()),cd=Ao.getLogger("heartbeat"),sd=function(){return Object(T.useEffect)(function(){return window.onmessage=ud,function(){return window.onmessage=null}}),null};function ud(e){return ld.apply(this,arguments)}function ld(){return(ld=Object(k.a)(A.a.mark(function e(t){var n,r;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(cd.info(t),t.origin===we.currentRunnerUrl){e.next=4;break}return console.error('Could not read snippet data: invalid origin "'.concat(t.origin,'"')),e.abrupt("return");case 4:bo()(),0===t.data.indexOf(Zr.RUNNER_TO_EDITOR_HEARTBEAT_REQUESTS.GET_ACTIVE_SOLUTION)?(n=t.data.split("/")[1],r=localStorage.getItem("activeSolution_"+n),dd(t.origin,Zr.EDITOR_HEARTBEAT_TO_RUNNER_RESPONSES.ACTIVE_SOLUTION,r)):0===t.data.indexOf(Zr.RUNNER_TO_EDITOR_HEARTBEAT_REQUESTS.GET_PYTHON_CONFIG_IF_ANY)&&dd(t.origin,Zr.EDITOR_HEARTBEAT_TO_RUNNER_RESPONSES.PASS_MESSAGE_TO_USER_SNIPPET,Object(le.strictType)({type:Zr.RUNNER_TO_EDITOR_HEARTBEAT_REQUESTS.GET_PYTHON_CONFIG_IF_ANY,contents:Mr()}));case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function dd(e,t,n){cd.info("Heartbeat sending ".concat(t," message back")),window.parent.postMessage(Object(le.strictType)({type:t,contents:n}),e)}var fd,pd=function(){return Object(T.useEffect)(function(){window.location.href=we.currentRunnerUrl}),null},md=(fd={},Object(R.a)(fd,Y,{component:Je,officeJs:null}),Object(R.a)(fd,V,{component:ot,officeJs:Zr.SCRIPT_URLS.DEFAULT_OFFICE_JS,skipOfficeOnReady:!0,skipRedirect:!0}),Object(R.a)(fd,Q,{component:li,officeJs:Zr.SCRIPT_URLS.OFFICE_JS_FOR_CUSTOM_FUNCTIONS_DASHBOARD}),Object(R.a)(fd,$,{component:gi,officeJs:null}),Object(R.a)(fd,X,{component:bi,officeJs:null}),Object(R.a)(fd,Z,{component:nd,isRedirectCancelable:!0,officeJs:Zr.SCRIPT_URLS.DEFAULT_OFFICE_JS}),Object(R.a)(fd,ee,{component:ad,officeJs:Zr.SCRIPT_URLS.DEFAULT_OFFICE_JS}),Object(R.a)(fd,te,{component:sd,officeJs:null}),Object(R.a)(fd,ne,{component:pd,officeJs:null}),fd),hd=function(){return I.a.createElement(U.a,{pages:md,defaultPath:Z})};function gd(){var e=P.a.parse(P.a.extract(window.location.href));return e.state&&e.code?I.a.createElement(Je,null):(document.addEventListener("keydown",function(e){83===e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&e.preventDefault()},!1),I.a.createElement(hd,null))}window.onerror=function(e){return Object(C.invokeGlobalErrorHandler)(e)},Object(k.a)(A.a.mark(function e(){var t;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t=document.getElementById("root"),L.a.render(gd(),t),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}catch(n){Object(C.invokeGlobalErrorHandler)(n)}case 1:case"end":return e.stop()}},e,this)}))()},14:function(e,t,n){"use strict";function r(e,t){return e.files.find(function(e){return e.name===t})||null}Object.defineProperty(t,"__esModule",{value:!0}),t.LIBRARIES_FILE_NAME="libraries.txt",t.SCRIPT_FILE_NAME="index.ts",t.findScript=function(e){return r(e,t.SCRIPT_FILE_NAME)},t.findLibraries=function(e){return r(e,t.LIBRARIES_FILE_NAME)}},141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importStar(n(0)),a=n(11),i=n(921),c=n(228),s=n(55);t.ThemeContext=o.default.createContext(c.getTheme(s.DEFAULT_HOST));var u=function(e){function n(t){var n=e.call(this,t)||this;return i.initializeIcons(),c.setupFabricTheme(t.host||s.DEFAULT_HOST),n.state={theme:c.getTheme(t.host||s.DEFAULT_HOST)},n}return r.__extends(n,e),n.prototype.componentDidUpdate=function(e){if(this.props.host!==e.host){c.setupFabricTheme(this.props.host);var t=c.getTheme(this.props.host);this.setState({theme:t})}},n.prototype.render=function(){return o.default.createElement(a.ThemeProvider,{theme:this.state.theme},o.default.createElement(t.ThemeContext.Provider,{value:this.state.theme},this.props.children))},n}(o.Component);t.default=u},143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(1167)),a=r.__importDefault(n(1168)),i=!1,c={};function s(e){if(i||(a.default.reg(o.default),i=!0),!c[e]){var t=o.default.getLogger(e),n=window.localStorage.getItem("loglevel:"+e);n?t.setLevel(n):t.setLevel(o.default.levels.WARN),a.default.apply(t,{template:"%l (%n):",levelFormatter:function(e){return e.toUpperCase()},nameFormatter:function(e){return e||"global"}}),c[e]=t}return c[e]}t.getLogger=s,t.levels=o.default.levels,t.isLoggerEnabled=function(e,t){return s(e).getLevel()<=t}},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.when,n=e.children;return t?n:null}},172:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){window.localStorage.setItem("scriptlab_unused_key","")}},174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1).__importDefault(n(96)),o=n(36),a=n(37),i=n(43),c=n(103),s="isDialog";function u(){return!!r.default.parse(window.location.search)[s]}t.shouldShowPopoutControl=function(e){return!u()&&(o.Utilities.host===o.HostType.OUTLOOK||"editor"===e&&o.Utilities.platform===o.PlatformType.OFFICE_ONLINE)},t.openPopoutCodeEditor=function(e){var t=(void 0===e?{onSuccess:function(){}}:e).onSuccess;Office.context.ui.displayDialogAsync(function(){var e=r.default.parse(window.location.search);return e[s]=1,a.currentEditorUrl+"?"+r.default.stringify(e)}(),{height:60,width:60,promptBeforeOpen:!1},function(e){e.status===Office.AsyncResultStatus.Succeeded?t():(console.error(e),i.invokeGlobalErrorHandler(new c.ScriptLabError("Could not open a standalone code editor window: "+e.error.message)))})},t.isPoppedOut=u},175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(11),i=n(1336),c=n(1219),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onLinkClick=function(e){var n=e.props.itemKey;n&&n!==t.props.selectedKey&&t.props.onSelect(n)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.items,n=e.selectedKey,r=e.theme,a=e.backgroundColor,s=e.selectedColor,u=e.hideUnderline,l=e.testId;return o.default.createElement(c.PivotBarWrapper,null,o.default.createElement(i.Pivot,{"data-testid":l,linkSize:i.PivotLinkSize.normal,linkFormat:i.PivotLinkFormat.tabs,onLinkClick:this.onLinkClick,selectedKey:n||void 0,styles:{root:{backgroundColor:a||r.primaryDarker},link:{backgroundColor:a||r.primaryDarker,selectors:{":hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"},":active":{backgroundColor:s||r.primaryDarkest}}},linkIsSelected:{backgroundColor:s||r.primaryDarkest,selectors:{":before":{borderBottom:(u?0:2)+"px solid "+r.white}}},linkContent:{color:r.white,fontWeight:"400"},icon:{fontSize:"1.6rem"}}},t.map(function(e){return o.default.createElement(i.PivotItem,{key:e.key,itemKey:e.key,linkText:e.text,itemIcon:e.iconName,"data-testid":e.testId,itemCount:e.itemCount||void 0})})))},t.defaultProps={hideUnderline:!1},t}(o.default.Component);t.default=a.withTheme(s)},190:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(1218);t.default=function(e){var t=e.header,n=e.footer,i=e.wrapperStyle,c=void 0===i?{}:i,s=e.fullscreen,u=e.children,l=s?{height:"100vh"}:{},d=r.__assign({},c,l);return o.default.createElement(a.Layout,{style:d},t,o.default.createElement(a.ContentWrapper,null,u),n)}},215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(188),i=n(965),c=r.__importDefault(n(334)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTextFieldReceivedRef=function(e){e&&e.setSelectionRange(0,-1)},t.getTextToCopy=function(){return t.props.text},t}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(i.Wrapper,{style:this.props.style},o.default.createElement(a.TextField,{readOnly:!0,spellCheck:!1,value:this.props.text,componentRef:this.onTextFieldReceivedRef}),o.default.createElement(c.default,{textGetter:this.getTextToCopy}))},t}(o.default.Component);t.default=s},219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e){function t(t){var n=e.call(this,t)||this;return n.props.funcToRun(),n}return r.__extends(t,e),t.prototype.render=function(){return null},t}(n(0).Component);t.RunOnLoad=o},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=n(36),i=o.__importDefault(n(934)),c=n(35),s={black:"#000000",neutralDarker:"#1e1e1e",neutralDark:"#212121",neutralPrimary:"#333333",neutralSecondary:"#666666",neutralSecondaryLight:"#888888",neutralLight:"#eaeaea",neutralLighter:"#f4f4f4",white:"#ffffff"};t.getCommandBarFabricTheme=function(e){var n="string"===typeof e?t.getTheme(e):e;return c.createTheme({palette:{themePrimary:n.white,themeDarkAlt:n.neutralLighter,neutralLighter:n.primary,neutralLight:n.primaryDark,neutralQuaternaryAlt:n.primaryLight,neutralSecondary:n.white,neutralPrimary:n.white,neutralDark:n.neutralLighter,black:n.white,white:n.neutralSecondary}})},t.getTheme=function(e){var t=u[e]||u[a.HostType.WEB],n=i.default(t);return o.__assign({primaryDarkest:n.darken(.6).hex(),primaryDarker:n.darken(.5).hex(),primaryDark:n.darken(.3).hex(),primary:n.hex(),primaryLight:n.lighten(.3).hex(),primaryLighter:n.lighten(.5).hex(),primaryLightest:n.lighten(.6).hex()},s)};var u=((r={})[a.HostType.WEB]="#0078d4",r[a.HostType.ACCESS]="#B7472A",r[a.HostType.EXCEL]="#217346",r[a.HostType.ONENOTE]="#80397B",r[a.HostType.OUTLOOK]="#0173C7",r[a.HostType.POWERPOINT]="#B7472A",r[a.HostType.PROJECT]="#217346",r[a.HostType.WORD]="#2B579A",r);t.fabricTheme={themePrimary:"#217346",themeLighterAlt:"#f2f9f5",themeLighter:"#cee9da",themeLight:"#a8d5bc",themeTertiary:"#62ab83",themeSecondary:"#318456",themeDarkAlt:"#1e673f",themeDark:"#195735",themeDarker:"#134027",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#c2c2c2",neutralSecondary:"#858585",neutralPrimaryAlt:"#4b4b4b",neutralPrimary:"#333",neutralDark:"#272727",black:"#1d1d1d",white:"#fff",primaryBackground:"#fff",primaryText:"#333",bodyBackground:"#fff",bodyText:"#333",disabledBackground:"#f4f4f4",disabledText:"#c8c8c8"},t.setupFabricTheme=function(e){var n=t.getTheme(e),r={themePrimary:n.primary,themeLighterAlt:n.neutralLighter,themeLighter:n.primaryLightest,themeLight:n.primaryLighter,themeTertiary:n.primaryLight,themeSecondary:n.primary,themeDarkAlt:n.primaryDark,themeDark:n.primaryDarker,themeDarker:n.primaryDarkest,neutralLighterAlt:n.neutralLighter,neutralLighter:n.neutralLighter,neutralLight:n.neutralLight,neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#c2c2c2",neutralSecondary:"#858585",neutralPrimaryAlt:"#4b4b4b",neutralPrimary:"#333",neutralDark:"#272727",black:"#1d1d1d",white:"#fff",primaryBackground:"#fff",primaryText:"#333",bodyBackground:"#fff",bodyText:"#333",disabledBackground:"#f4f4f4",disabledText:"#c8c8c8"};c.loadTheme({palette:r,isInverted:!0})}},305:function(e,t,n){"use strict";function r(e){return e.replace(/\./g,"-")}Object.defineProperty(t,"__esModule",{value:!0}),t.PACKAGE_VERSIONS={"monaco-editor":"0.18.1","@microsoft/office-js":"1.1.11-adhoc.28"},t.HYPHENATED_PACKAGE_VERSIONS=function(){var e={};for(var n in t.PACKAGE_VERSIONS)e[n]=r(t.PACKAGE_VERSIONS[n]);return e}(),t.hyphenate=r},306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function o(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return[2,new Promise(function(t){var n=document.getElementsByTagName("script"),r=n[n.length-1],o=document.createElement("script");o.setAttribute("src",e),o.onload=function(){return t()},r.parentNode.insertBefore(o,r.nextSibling)})]})})}t.addScriptTags=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return[2,Promise.all(e.map(function(e){return o(e)}))]})})},t.addScriptTag=o},307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(96)),a=n(55),i=n(37),c=r.__importDefault(n(172)),s=n(43),u=n(103),l=2e4,d=4e3;function f(e){var t=e.isCancelable,n=e.redirectUrl;return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(o){switch(o.label){case 0:return t&&n.startsWith("https://localhost")?function(){var e=Number(window.localStorage.getItem(a.localStorageKeys.editor.lastEnvironmentRedirectTimestamp));return Date.now()-e<l}()?[4,new Promise(function(t){return r.__awaiter(e,void 0,void 0,function(){var e;return r.__generator(this,function(r){return e=setTimeout(function(){t(!0)},d),s.showSplashScreen('Redirecting to "'+n+'" in a few seconds. Click now to cancel.',function(){clearTimeout(e),window.localStorage.removeItem(a.localStorageKeys.editor.redirectEnvironmentUrl),t(!1)}),[2]})})})]:[3,2]:[3,3];case 1:if(!o.sent())return[2,!1];o.label=2;case 2:s.showSplashScreen('Redirecting to "'+n+'"'),o.label=3;case 3:return[2,!0]}})})}function p(e){if(0===e.length)return!0;for(var t in i.editorUrls){if(0===i.editorUrls[t].indexOf(e))return!0}return!1}function m(){window.localStorage.setItem(a.localStorageKeys.editor.lastEnvironmentRedirectTimestamp,Date.now().toString())}t.redirectIfNeeded=function(e){var t=e.isCancelable;return r.__awaiter(this,void 0,void 0,function(){var e,n,s,l,d,h,g;return r.__generator(this,function(r){switch(r.label){case 0:if(r.trys.push([0,3,,4]),e=o.default.parse(window.location.search),n=(e.originEnvironment||"").trim(),s=(e.targetEnvironment||"").trim(),!p(n)||!p(s))throw new Error("Invalid query parameters for target or origin environments");if(s.length>0){if(0===window.location.href.toLowerCase().indexOf(s))return window.localStorage.removeItem(a.localStorageKeys.editor.redirectEnvironmentUrl),[2];window.localStorage.setItem(a.localStorageKeys.editor.redirectEnvironmentUrl,s),s===i.editorUrls.local&&window.localStorage.setItem(a.localStorageKeys.editor.shouldShowLocalhostRedirectOption,"1")}return n.length>0&&window.localStorage.setItem(a.localStorageKeys.editor.originEnvironmentUrl,decodeURIComponent(n).toLowerCase()),c.default(),(l=window.localStorage.getItem(a.localStorageKeys.editor.redirectEnvironmentUrl))?((d=o.default.parse(window.location.search)).originEnvironment=window.location.origin,[4,f({redirectUrl:l,isCancelable:t})]):[3,2];case 1:return r.sent()?(t&&m(),h=[l,window.location.pathname,Object.keys(d).length>0?"?"+o.default.stringify(d):"",window.location.hash],window.location.replace(h.join("")),[2,new Promise(function(e){return function(){}})]):[2];case 2:return[2];case 3:throw g=r.sent(),new u.ScriptLabError("Error redirecting to a different environment.",g);case 4:return[2]}})})},t.redirectEditorToOtherEnvironment=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){return t=i.editorUrls[e],c.default(),n=window.localStorage.getItem(a.localStorageKeys.editor.originEnvironmentUrl),s.showSplashScreen("Re-loading Script Lab..."),m(),n?window.location.href=n+"?targetEnvironment="+encodeURIComponent(t):(window.localStorage.setItem(a.localStorageKeys.editor.redirectEnvironmentUrl,t),window.location.href=t+"?originEnvironment="+encodeURIComponent(i.currentEditorUrl)),[2]})})}},334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(58),i=r.__importDefault(n(444)),c=750,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onSuccess=function(){t.timeout&&clearTimeout(t.timeout),t.setState({isJustAfterCopy:!0}),t.timeout=setTimeout(function(){return t.setState({isJustAfterCopy:!1})},c)},t}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(i.default,{textGetter:this.props.textGetter,onSuccess:this.onSuccess},o.default.createElement(a.IconButton,{styles:this.state.isJustAfterCopy?{icon:{color:"#007500"}}:{},style:this.props.iconHeight?{height:this.props.iconHeight}:{},iconProps:{iconName:this.state.isJustAfterCopy?"CheckMark":"Copy"},title:"Copy to clipboard"}))},t}(o.default.Component);t.default=s},347:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(11),i=r.__importDefault(n(526)),c=r.__importDefault(n(1185)),s=n(9),u=n(565),l=n(228),d=n(1217);t.default=a.withTheme(function(e){var t,n=e.items.filter(function(e){return!e.hidden}).map(function(e){return r.__assign({},e,{"data-testid":e.key})}),a=e.farItems?e.farItems.filter(function(e){return!e.hidden}):[];return o.default.createElement(s.Customizer,{settings:{theme:l.getCommandBarFabricTheme(e.theme)}},o.default.createElement(u.CommandBar,r.__assign({},i.default(c.default(r.__assign({},e,{items:n,farItems:a}),["theme"]),{styles:{root:{paddingLeft:0,paddingRight:(t={},t[d.PlatformType.PC]="20px",t[d.PlatformType.Mac]="40px",t[d.PlatformType.OfficeOnline]="0px",t)[d.getPlatform()]}}}))))})},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=n(55),i={local:Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_LAST_UPDATED:"Mon, 29 Mar 2021 22:49:00 GMT",REACT_APP_COMMIT:"8eb2f132f3092cebcc5e3e4e736dcd104eaf0574"}).REACT_APP_GITHUB_CLIENT_ID,alpha:"ad26df7ba62ef691669e",beta:"edb61fe543b382628d68",staging:"",production:"",cdn:"55031174553ee45f92f4"};function c(){var e,n,r=[t.editorUrls,t.runnerUrls];try{for(var a=o.__values(r),i=a.next();!i.done;i=a.next()){var c=i.value;for(var s in c){var u=c[s];if(0===window.location.origin.indexOf(u))return s}}}catch(l){e={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}if("http://localhost"===window.location.origin)return"local";throw new Error('Invalid environment. URL "'+window.location.origin+'" not found in environments list.')}t.editorUrls={local:"https://localhost:3000",alpha:"https://script-lab-react-alpha.azurewebsites.net",beta:"https://script-lab-react-beta.azurewebsites.net",staging:"https://script-lab-react-staging.azurewebsites.net",production:"https://script-lab-react.azurewebsites.net",cdn:"https://script-lab.azureedge.net",alpha2017:"https://bornholm-edge.azurewebsites.net",beta2017:"https://bornholm-insiders.azurewebsites.net"},t.runnerUrls={local:"https://localhost:3200",alpha:"https://script-lab-react-runner-alpha.azurewebsites.net",beta:"https://script-lab-react-runner-beta.azurewebsites.net",staging:"https://script-lab-react-runner-staging.azurewebsites.net",production:"https://script-lab-react-runner.azurewebsites.net",cdn:"https://script-lab-runner.azureedge.net"},t.serverUrls={local:"http://localhost:5000",alpha:"https://script-lab-react-server-alpha.azurewebsites.net",beta:"https://script-lab-react-server-beta.azurewebsites.net",staging:"https://script-lab-react-server-staging.azurewebsites.net",production:"https://script-lab-react-server.azurewebsites.net",cdn:"https://script-lab-server.azureedge.net"},t.environmentDisplayNames=function(){var e={local:"localhost:3000"+(window.localStorage.getItem(a.localStorageKeys.editor.shouldShowLocalhostRedirectOption)?" (visited before)":""),alpha:"Alpha",beta:"Beta",staging:"Staging",production:"Production (direct)",cdn:"Production",alpha2017:"Script Lab 2017 - Alpha",beta2017:"Script Lab 2017"},n=window.localStorage.getItem(a.localStorageKeys.editor.originEnvironmentUrl);for(var r in t.editorUrls)t.editorUrls[r].startsWith(n)&&(e[r]+=" (*)");return e}(),t.currentServerUrl=t.serverUrls[c()],t.currentRunnerUrl=t.runnerUrls[c()],t.currentEditorUrl=t.editorUrls[c()],t.githubAppClientId=i[c()],t.environmentDisplayName=t.environmentDisplayNames[c()],t.currentOfficeJsRawSnippetsBaseRepoUrl="https://raw.githubusercontent.com/OfficeDev/office-js-snippets/"+("cdn"===c()?"prod":"main"),t.getVisibleEnvironmentKeysToSwitchTo=function(){return o.__spread(["cdn","beta","alpha","beta2017"],function(){switch(c()){case"local":case"alpha":return["alpha2017","production","staging","local"];default:return[window.localStorage.getItem(a.localStorageKeys.editor.shouldShowLocalhostRedirectOption)?"local":null]}}().filter(function(e){return e}))},t.getCurrentEnv=c,function(e){e.PC="PC",e.OfficeOnline="OfficeOnline",e.Mac="Mac",e.iOS="iOS",e.Android="Android",e.Universal="Universal"}(r=t.PlatformType||(t.PlatformType={})),t.getPlatform=function(){return window.Office&&window.Office.context&&window.Office.context.platform||r.OfficeOnline}},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(853)),a=n(55),i=r.__importDefault(n(172));function c(e,t,n){localStorage.setItem(""+e+t,JSON.stringify(n))}function s(){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);n&&e.push(n)}return e}function u(e){return s().filter(function(t){return t.startsWith(e)})}function l(e){return i.default(),u(e).map(function(e){return localStorage.getItem(e)}).map(function(e){return JSON.parse(e)})}function d(e){u(e).forEach(function(e){return localStorage.removeItem(e)})}t.GITHUB_KEY="github",t.SOLUTION_ROOT="solution#",t.CF_LOGS_ROOT="cf_logs#",t.DEBUG_KEY="debug",t.getIsCustomFunctionRunnerAlive=function(){i.default();var e=localStorage.getItem(a.localStorageKeys.editor.customFunctionsLastHeartbeatTimestamp);return!!e&&+e>3e3},t.getCustomFunctionCodeLastUpdated=function(){i.default();var e=localStorage.getItem(a.localStorageKeys.editor.customFunctionsLastUpdatedCodeTimestamp);return e?+e:0},t.getCustomFunctionLogsFromLocalStorage=function(){i.default();var e=l(t.CF_LOGS_ROOT);return d(t.CF_LOGS_ROOT),e},t.setCustomFunctionsLastRegisteredTimestamp=function(e){localStorage.setItem(a.localStorageKeys.editor.customFunctionsLastRegisteredTimestamp,e.toString())},t.getCustomFunctionsLastRegisteredTimestamp=function(){return i.default(),JSON.parse(localStorage.getItem(a.localStorageKeys.editor.customFunctionsLastRegisteredTimestamp)||"0")},t.writeIfChanged=function(e,t,n,r,a){void 0===a&&(a="");var i=e(n),s=r?e(r):null,u="string"===typeof t?t:t(i);!i||s&&o.default(i,s)||c(a,u,i)},t.writeItem=c,t.readItem=function(e,t){return JSON.parse(localStorage.getItem(""+e+t)||"null")},t.deleteItem=function(e,t){localStorage.removeItem(""+e+t)},t.getAllLocalStorageKeys=s,t.getAllLocalStorageKeysWithRoot=u,t.getAllItemsWithRoot=l,t.removeAllItemsWithRoot=d},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(107),o=n(103),a=n(42),i=!1;t.invokeGlobalErrorHandler=function(e,t){if(!function(e){return(e.message?e.message:e.toString()).includes("monaco-editor")}(e)){if(window.localStorage.getItem(a.DEBUG_KEY),i)return console.error("Global error handler -- FOLLOW-UP ERROR (not showing in the UI)"),console.error(e),!0;console.error("Global error handler:"),console.error(e);for(var n=document.getElementById("loading"),c=document.getElementById("root"),s=document.querySelectorAll("#loading h2")[0],u=document.querySelectorAll("#loading .error"),l=0;l<u.length;l++){var d=u[l];d.parentNode.removeChild(d)}s.innerHTML=e instanceof o.ScriptLabError?e.message:"An unexpected error has occurred.";var f,p=e instanceof o.ScriptLabError?e.innerError:e;if(p&&((f=document.createElement("a")).href="#",f.className="ms-font-m error",f.textContent="Click for more info",f.addEventListener("click",function(e){var t=document.createElement("pre");t.textContent=r.stringifyPlusPlus(p),n.insertBefore(t,f),f.parentNode.removeChild(f),e.preventDefault()}),n.insertBefore(f,null)),!(e instanceof o.ScriptLabError&&e.options.hideCloseButton)){var m=document.createElement("a");m.href="#",m.className="ms-font-m error",m.textContent="Close",m.addEventListener("click",function(e){n.style.visibility="hidden",c.style.display="",i=!1,e.preventDefault()}),n.insertBefore(m,null)}var h=document.querySelectorAll("#loading pre")[0];h&&n.removeChild(h);var g=document.querySelectorAll("#loading .loading-indicator")[0];return g&&g.parentNode.removeChild(g),c.style.display="none",n.style.visibility="",i=!0,t&&t.showExpanded&&f&&f.click(),!0}},t.showSplashScreen=function(e,t){document.getElementById("loading").style.visibility="";var n=r();function r(){var e=document.querySelectorAll("#loading h2")[0],t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}n.textContent=e,t&&n.addEventListener("click",function(e){r(),t()}),document.getElementById("root").style.display="none"},t.hideSplashScreen=function(){if(!i){document.getElementById("loading").style.visibility="hidden";var e=document.getElementById("root");e&&(e.style.display="")}}},444:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=r.__importDefault(n(966)),i=n(43),c=function(e){function t(n){var r=e.call(this,n)||this;return r.props.globallyUniqueSelector||(r.idIfAny="export-to-clipboard-"+t.nextGlobalId++),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props.globallyUniqueSelector||"#"+this.idIfAny+" > *";this.clipboard=new a.default(e,{text:this.props.textGetter}),this.clipboard.on("success",this.props.onSuccess),this.clipboard.on("error",this.props.onError)},t.prototype.componentWillUnmount=function(){this.clipboard.destroy()},t.prototype.render=function(){return this.props.globallyUniqueSelector?this.props.children||null:o.default.createElement("div",{id:this.idIfAny},this.props.children)},t.defaultProps={onError:i.invokeGlobalErrorHandler,onSuccess:function(){}},t.nextGlobalId=0,t}(o.default.Component);t.default=c},449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={playground_help:"https://github.com/OfficeDev/script-lab/blob/master/README.md",ask:"https://stackoverflow.com/questions/tagged/office-js",excel_api:"https://docs.microsoft.com/en-us/office/dev/add-ins/reference/overview/excel-add-ins-reference-overview",word_api:"https://docs.microsoft.com/office/dev/add-ins/reference/overview/word-add-ins-reference-overview",onenote_api:"https://docs.microsoft.com/office/dev/add-ins/reference/overview/onenote-add-ins-javascript-reference",outlook_api:"https://docs.microsoft.com/office/dev/add-ins/outlook/apis",powepoint_api:"https://docs.microsoft.com/office/dev/add-ins/reference/overview/powerpoint-add-ins-reference-overview",project_api:"https://docs.microsoft.com/office/dev/add-ins/reference/overview/project-add-ins-reference-overview",generic_api:"https://docs.microsoft.com/office/dev/add-ins/reference/javascript-api-for-office"}},450:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(344)),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(Error);t.SyntaxError=a,t.default=function(e){var t=o.default.transpileModule(e,{reportDiagnostics:!0,compilerOptions:{target:o.default.ScriptTarget.ES5,allowJs:!0,lib:["dom","es2015"]}});if(t.diagnostics.length)throw new a(t.diagnostics.map(function(t){var n=e.substr(0,t.start),r=e.substr(t.start+1),o=n.split("\n").length,a=n.lastIndexOf("\n"),i=e.substring(a,t.start+Math.max(r.indexOf("\n"),0)).trim();return"Line #"+o+": "+t.messageText+"\n "+i}).join("\n\n"));return t.outputText.replace('Object.defineProperty(exports, "__esModule", { value: true });',"")}},451:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[],r=[],o=null;return e&&e.split("\n").forEach(function(e){if(null==e)return null;if(""===(e=e.trim())||e.startsWith("#")||e.startsWith("//"))return null;if(/^@types/.test(e)||/^dt~/.test(e)||/\.d\.ts$/i.test(e))return null;var t=/^https?:\/\/|^ftp? :\/\//i.test(e)?e:"https://unpkg.com/"+e;return/\.css$/i.test(t)?n.push(t):/\.ts$|\.js$/i.test(t)&&/.*office(\.(experimental))?(\.debug)?\.js$/.test(t.toLowerCase())?(o=t,null):r.push(t)}),t||(o=null),{linkReferences:n,scriptReferences:r,officeJs:o}}},456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,a=n(1),i=a.__importStar(n(143));!function(e){e.ok="ok",e.error="error"}(r||(r={})),function(e){e.execute_result="execute_result",e.stream="stream",e.execute_reply="execute_reply"}(o||(o={}));var c=function(){function e(e,t){this.m_conn=e,this.m_path=t,this.m_executePromiseMap={}}return e.prototype.connect=function(){var e=this,t=u.combineUrl(this.m_conn.baseUrl,"api/sessions"),n={path:this.m_path,type:"notebook",name:"",kernel:{id:null,name:"python3"}};return fetch(t,{headers:{"Content-Type":"application/json",Authorization:"token "+this.m_conn.token},method:"POST",cache:"no-cache",body:JSON.stringify(n)}).then(function(e){return e.json()}).then(function(t){var n;return e.m_sessionId=t.id,e.m_kernelId=t.kernel.id,e.m_channelSessionId=u.uuid(),"http://"===e.m_conn.baseUrl.substr(0,"http://".length)?n="ws://"+e.m_conn.baseUrl.substr("http://".length):"https://"===e.m_conn.baseUrl.substr(0,"https://".length)&&(n="wss://"+e.m_conn.baseUrl.substr("https://".length)),n=u.combineUrl(n,"api/kernels/"+e.m_kernelId+"/channels?token="+e.m_conn.token+"&session_id="+e.m_channelSessionId),u.log("WebSocket url:"+n),new Promise(function(t,r){e.m_ws=new WebSocket(n),e.m_ws.onopen=function(){u.log("onopen"),t()},e.m_ws.onmessage=function(t){if(u.log("onmessage"),"string"===typeof t.data){u.log(t.data);var n=JSON.parse(t.data);e.handleWebSocketMessage(n)}else u.log("unknown message")},e.m_ws.onclose=function(){u.log("onclose")},e.m_ws.onerror=function(){u.log("onerror")}})})},e.prototype.ensureConnected=function(){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return this.m_connected?[3,2]:[4,this.connect()];case 1:e.sent(),this.m_connected=!0,e.label=2;case 2:return[2]}})})},e.prototype.executeCode=function(e){var t=this;return this.ensureConnected().then(function(){var n={code:e,silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!0};return new Promise(function(e,r){var o=t.sendShellMessage("execute_request",n,null);t.m_executePromiseMap[o]={resolve:e,reject:r}})})},e.prototype.sendShellMessage=function(e,t,n){var r=this.buildMessage("shell",e,t,n),o=JSON.stringify(r);return u.log("sending:"+o),this.m_ws.send(o),r.msg_id},e.prototype.buildMessage=function(e,t,n,r){var o=u.uuid();return{header:{msg_id:o,username:"username",session:this.m_channelSessionId,msg_type:t,version:"5.2"},msg_id:o,msg_type:t,metadata:r||{},content:n,buffers:[],parent_header:{},channel:e}},e.prototype.handleWebSocketMessage=function(e){switch(e.channel){case"shell":return this.handleShellReply(e);case"iopub":return this.handleIopubMessage(e);case"stdin":return this.handleInputRequest(e);default:console.error("unrecognized message channel",e.channel,e)}},e.prototype.handleShellReply=function(e){if(e.msg_type==o.execute_reply){var t=e.content,n=e.parent_header.msg_id,a=this.m_executePromiseMap[n];a&&(delete this.m_executePromiseMap[n],t.status==r.ok?a.resolve(null):t.status==r.error?a.reject(t.ename+":"+t.evalue):console.error("unrecognized message status",t.status))}},e.prototype.handleIopubMessage=function(e){if(e.msg_type===o.execute_result){var t=(a=e.content).data["text/plain"],n=e.parent_header.msg_id,r=this.m_executePromiseMap[n];u.log("ExecuteResult="+t),r&&(delete this.m_executePromiseMap[n],r.resolve(t))}else if(e.msg_type==o.stream){var a;if("stdout"===(a=e.content).name){t=a.text;u.isNullOrEmptyString(t)||(t=t.replace("\\n","")),u.logConsole(t)}}},e.prototype.handleInputRequest=function(e){var t=this,n=e.content;if("string"===typeof n.prompt&&"[Office-Api]"===n.prompt.substr(0,"[Office-Api]".length)){var r=n.prompt.substr("[Office-Api]".length),o=JSON.parse(r);OfficeExtension.HttpUtility.sendLocalDocumentRequest(o).then(function(n){var r=JSON.stringify(n),o=t.buildMessage("stdin","input_reply",{value:r},null);o.parent_header=e.header;var a=JSON.stringify(o);u.log("sending:"+a),t.m_ws.send(a)})}},e}();t.JupyterNotebook=c;var s=function(){function e(){}return e.buildFunctionInvokeStatement=function(t,n){var r=t;if(r+="(",n)for(var o=0;o<n.length;o++)0!==o&&(r+=", "),r+=e.buildLiteral(n[o]);return r+=")"},e.parseFromPythonLiteral=function(e){return"True"===e||"False"!==e&&("None"===e?null:"'"==e.charAt(0)?e.substr(1,e.length-2):JSON.parse(e))},e.buildLiteral=function(t){if("undefined"===typeof t||null===t)return"None";if("boolean"===typeof t)return t?"True":"False";if("number"===typeof t)return JSON.stringify(t);if("string"===typeof t)return JSON.stringify(t);if(Array.isArray(t)){for(var n="[",r=0;r<t.length;r++)0!==r&&(n+=","),n+=e.buildLiteral(t[r]);return n+"]"}return"None"},e}();t.PythonCodeHelper=s;var u=function(){function e(){}return e.combineUrl=function(t,n){return e.isNullOrEmptyString(n)?t:("/"===t.substr(t.length-1)&&(t=t.substr(0,t.length-1)),"/"==n.charAt(0)&&(n=n.substr(1)),t+"/"+n)},e.isNullOrEmptyString=function(e){return"undefined"===typeof e||null===e||0==e.length},e.uuid=function(){for(var e=[],t=0;t<32;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[12]="4",e[16]="0123456789abcdef".substr(3&e[16]|8,1),e.join("")},e.log=function(e){i.getLogger("Jupyter").info(e)},e.logResult=function(e){i.getLogger("Jupyter").info(e)},e.logConsole=function(e){console.log(e)},e}();t.Util=u},544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,a,i,c,s,u,l,d,f,p,m=n(1),h=m.__importDefault(n(11));t.Wrapper=h.default.div(r||(r=m.__makeTemplateObject(["\n  width: 100%;\n  flex: 3;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n"],["\n  width: 100%;\n  flex: 3;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n"]))),t.NoLogsPlaceholderContainer=h.default.div(o||(o=m.__makeTemplateObject(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ",";\n\n  height: 100%;\n  width: 100%;\n"],["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ",";\n\n  height: 100%;\n  width: 100%;\n"])),function(e){return e.theme.neutralPrimary}),t.NoLogsPlaceholder=h.default.div(a||(a=m.__makeTemplateObject(["\n  text-align: center;\n  max-width: 90%;\n"],["\n  text-align: center;\n  max-width: 90%;\n"]))),t.RunnerLastUpdatedWrapper=h.default.div.attrs({className:"ms-font-m"})(i||(i=m.__makeTemplateObject(["\n  padding: 0rem 1.6rem;\n  height: 2.8rem;\n  line-height: 2.8rem;\n  background: ",";\n  overflow: hidden;\n  overflow-wrap: normal;\n"],["\n  padding: 0rem 1.6rem;\n  height: 2.8rem;\n  line-height: 2.8rem;\n  background: ",";\n  overflow: hidden;\n  overflow-wrap: normal;\n"])),function(e){return e.theme.neutralLighter}),t.HeaderWrapper=h.default.div(c||(c=m.__makeTemplateObject(["\n  background: ",";\n  height: 3.2rem;\n  display: flex;\n  justify-content: space-between;\n"],["\n  background: ",";\n  height: 3.2rem;\n  display: flex;\n  justify-content: space-between;\n"])),function(e){return e.theme.neutralLight}),t.CheckboxWrapper=h.default.div(s||(s=m.__makeTemplateObject(["\n  flex-grow: 1;\n  padding: 0.6rem;\n"],["\n  flex-grow: 1;\n  padding: 0.6rem;\n"]))),t.LogsArea=h.default.div(u||(u=m.__makeTemplateObject(["\n  height: 100%;\n  max-height: inherit;\n  overflow-x: hidden;\n  overflow-y: auto;\n  flex: 1;\n"],["\n  height: 100%;\n  max-height: inherit;\n  overflow-x: hidden;\n  overflow-y: auto;\n  flex: 1;\n"]))),t.LogsList=h.default.ul(l||(l=m.__makeTemplateObject([""],[""]))),t.LogEntry=h.default.li(d||(d=m.__makeTemplateObject(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: 3.2rem;\n  padding: 0.9rem;\n  padding-left: 1rem;\n  font-family: monospace;\n  box-sizing: border-box;\n  border-top: 0.5px solid ",";\n  border-bottom: 0.5px solid ",";\n"],["\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: 3.2rem;\n  padding: 0.9rem;\n  padding-left: 1rem;\n  font-family: monospace;\n  box-sizing: border-box;\n  border-top: 0.5px solid ",";\n  border-bottom: 0.5px solid ",";\n"])),function(e){return e.theme.neutralLight},function(e){return e.theme.neutralLight}),t.LogText=h.default.pre(f||(f=m.__makeTemplateObject(["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  font-size: 1.2rem;\n  margin-left: 1rem;\n  width: 100%;\n"],["\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  font-size: 1.2rem;\n  margin-left: 1rem;\n  width: 100%;\n"]))),t.ObjectInspectorLogEntry=h.default.div(p||(p=m.__makeTemplateObject(["\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  display: flex;\n  width: 100%;\n  min-height: 3.2rem;\n  padding: 0.9rem;\n  padding-left: 1rem;\n  box-sizing: border-box;\n  border-top: 0.5px solid ",";\n  border-bottom: 0.5px solid ",";\n\n  & > li {\n    margin-left: 1rem;\n    width: calc(100% - 2rem);\n  }\n\n  & * {\n    background: ",";\n  }\n"],["\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  display: flex;\n  width: 100%;\n  min-height: 3.2rem;\n  padding: 0.9rem;\n  padding-left: 1rem;\n  box-sizing: border-box;\n  border-top: 0.5px solid ",";\n  border-bottom: 0.5px solid ",";\n\n  & > li {\n    margin-left: 1rem;\n    width: calc(100% - 2rem);\n  }\n\n  & * {\n    background: ",";\n  }\n"])),function(e){return e.theme.neutralLight},function(e){return e.theme.neutralLight},function(e){return e.backgroundColor})},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(305);t.SCRIPT_URLS={CUSTOM_FUNCTIONS_RUNNER_DEFAULT:"https://appsforoffice.microsoft.com/lib/preview/hosted/custom-functions-runtime.js",CUSTOM_FUNCTIONS_RUNNER_WITH_JUPYTER_SUPPORT:"https://exceljupyter.azurewebsites.net/agave/dist/external/office-js-custom-1/custom-functions-runtime.debug.js",DEFAULT_OFFICE_JS:"https://appsforoffice.microsoft.com/lib/1/hosted/office.js",OFFICE_JS_FOR_CUSTOM_FUNCTIONS_DASHBOARD:"https://appsforoffice.microsoft.com/lib/beta/hosted/office.js",MONACO_LOADER:"/external/monaco-editor-"+r.HYPHENATED_PACKAGE_VERSIONS["monaco-editor"]+"/vs/loader.js"},t.DEFAULT_HOST="WEB",t.CF_HEARTBEAT_POLLING_INTERVAL=500,t.localStorageKeys={editor:{customFunctionsLastHeartbeatTimestamp:"playground_custom_functions_last_heartbeat_timestamp",customFunctionsLastUpdatedCodeTimestamp:"playground_custom_functions_last_updated_code_timestamp",customFunctionsLastRegisteredTimestamp:"playground_custom_functions_last_registered",customFunctionsCurrentlyRunningTimestamp:"playground_custom_functions_currently_running_timestamp",log:"playground_log",customFunctionsRunPostData:"custom_functions_run_post_data",originEnvironmentUrl:"playground_origin_environment_url",redirectEnvironmentUrl:"playground_redirect_environment_url",lastEnvironmentRedirectTimestamp:"playground_last_environment_redirect_timestamp",shouldShowLocalhostRedirectOption:"playground_should_show_localhost_redirect_option"}},t.SERVER_HELLO_ENDPOINT={path:"hello",payload:{message:"Hello from Script Lab"}},t.RUNNER_TO_EDITOR_HEARTBEAT_REQUESTS={GET_ACTIVE_SOLUTION:"GET_ACTIVE_SOLUTION",GET_PYTHON_CONFIG_IF_ANY:"GET_PYTHON_CONFIG_IF_ANY"},t.EDITOR_HEARTBEAT_TO_RUNNER_RESPONSES={ACTIVE_SOLUTION:"ACTIVE_SOLUTION",PASS_MESSAGE_TO_USER_SNIPPET:"PASS_MESSAGE_TO_USER_SNIPPET"}},595:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(1333),i=n(916),c=n(306),s=n(307);function u(e){var t=this;return function(){return o.default.createElement(i.AwaitPromiseThenRender,{promise:Promise.resolve().then(function(){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return e.officeJs?[4,c.addScriptTags([e.officeJs])]:[3,3];case 1:return t.sent(),e.skipOfficeOnReady?[3,3]:[4,Office.onReady()];case 2:t.sent(),t.label=3;case 3:return e.skipRedirect?[3,5]:[4,s.redirectIfNeeded({isCancelable:e.isRedirectCancelable})];case 4:t.sent(),t.label=5;case 5:return[2]}})})})},o.default.createElement(e.component))}}t.default=function(e){var t=e.pages,n=e.defaultPath;return o.default.createElement(a.HashRouter,null,o.default.createElement(a.Switch,null,Object.keys(t).map(function(e){return o.default.createElement(a.Route,{exact:!0,path:e,component:u(t[e]),key:e})}),o.default.createElement(a.Route,{component:u(t[n])})))}},610:function(e,t,n){e.exports=n(1332)},613:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(614),n(622)},904:function(e,t,n){},916:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),a=n(43),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={promiseHasResolved:!1},t.promise.then(function(){return n.setState({promiseHasResolved:!0})}).catch(function(e){return a.invokeGlobalErrorHandler(e)}),n}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.children;return this.state.promiseHasResolved?e:null},t}(o.Component);t.AwaitPromiseThenRender=i},925:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(11),i=n(566),c=n(58),s=n(544),u=r.__importDefault(n(190)),l=r.__importDefault(n(334)),d=r.__importDefault(n(17)),f=n(107),p=r.__importDefault(n(1220)),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastLog=o.default.createRef(),t.state={shouldScrollToBottom:!0},t.inputRef=o.default.createRef(),t.setShouldScrollToBottom=function(e,n){return t.setState({shouldScrollToBottom:n})},t.getTextToCopy=function(){return t.props.logs.map(function(e){var t="";return"warn"===e.severity?t="[WARNING]: ":"error"===e.severity&&(t="[ERROR]: "),t+f.stringifyPlusPlusOrErrorMessage(e.message)}).join("\n\n")},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.scrollToBottom()},t.prototype.componentDidUpdate=function(){this.scrollToBottom()},t.prototype.scrollToBottom=function(){this.state.shouldScrollToBottom&&this.lastLog.current&&this.lastLog.current.scrollIntoView()},t.prototype.render=function(){var e=this.props,t=e.theme,n=e.logs,a=e.clearLogs,f=e.style,m=n.slice(-100).map(function(e){var n=e.id,r=e.severity,a=e.message;return o.default.createElement(p.default,{key:n,severity:r,message:a,theme:t})});return m.length>0&&m.splice(m.length-1,0,o.default.createElement("div",{key:"last-long",ref:this.lastLog})),o.default.createElement(s.Wrapper,{style:r.__assign({backgroundColor:t.neutralLighter},f)},o.default.createElement(u.default,{header:o.default.createElement(d.default,{when:n.length>0},o.default.createElement(s.HeaderWrapper,null,o.default.createElement(s.CheckboxWrapper,null,o.default.createElement(i.Checkbox,{label:"Auto-scroll",defaultChecked:!0,onChange:this.setShouldScrollToBottom})),o.default.createElement(c.IconButton,{iconProps:{iconName:"Clear"},style:{height:"3.2rem"},styles:{iconHovered:{color:"#b22222"}},title:"Clear",onClick:a}),o.default.createElement(l.default,{textGetter:this.getTextToCopy}))),footer:null},0===m.length?o.default.createElement(s.NoLogsPlaceholderContainer,null,o.default.createElement(s.NoLogsPlaceholder,null,"There are no logs to display. Use"," ",o.default.createElement("pre",{style:{fontFamily:"Consolas, monaco, monospace",fontWeight:"bold",display:"inline"}},"console.log()")," ","to display logs here.")):o.default.createElement(s.LogsArea,null,m)))},t.defaultProps={style:{}},t}(o.default.Component);t.default=a.withTheme(m)},928:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=r.__importDefault(n(0)),a=n(11),i=r.__importDefault(n(526)),c=n(9),s=n(565),u=n(228),l=n(1285);function d(e,t){return e.filter(function(e){return!e.hidden}).map(function(e){return i.default(e,r.__assign({},e.subMenuProps?{subMenuProps:{isBeakVisible:!0,shouldFocusOnMount:!0,styles:{root:{backgroundColor:t.primary,color:t.white}},items:void 0!==e.subMenuProps&&e.subMenuProps.items?e.subMenuProps.items.map(function(e){return i.default(e,{itemProps:{styles:{root:{background:t.primary,selectors:{":hover":{background:t.primaryDark},":active":{background:t.primaryDarker}}},label:{color:t.white}}}})}):[]}}:{},{style:{fontSize:"1.2rem"},iconProps:e.iconProps?r.__assign({style:r.__assign({fontSize:"1.4rem"},e.iconProps.style?e.iconProps.style:{})},e.iconProps):void 0}))})}t.default=a.withTheme(function(e){var t=d(e.items,e.theme),n=e.farItems?d(e.farItems,e.theme):[],a=(e.theme,r.__rest(e,["theme"])),f=i.default(r.__assign({},a,{items:t,farItems:n}),{styles:{root:{paddingLeft:0,paddingRight:0,height:"2rem"}}});return o.default.createElement(c.Customizer,{settings:{theme:u.getCommandBarFabricTheme(e.theme)}},o.default.createElement(l.Wrapper,null,o.default.createElement(s.CommandBar,r.__assign({},f))))})},965:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1),a=o.__importDefault(n(11));t.Wrapper=a.default.div(r||(r=o.__makeTemplateObject(["\n  display: flex;\n  border: 1px gray solid;\n  border-radius: 4px;\n\n  & > :nth-child(1) {\n    flex: 1;\n  }\n"],["\n  display: flex;\n  border: 1px gray solid;\n  border-radius: 4px;\n\n  & > :nth-child(1) {\n    flex: 1;\n  }\n"])))},968:function(e,t){},969:function(e,t){},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(116);t.isInternetExplorer=function(){return"ActiveXObject"in window},t.generateRandomToken=function(e){if(void 0===e&&(e=128),e%8!==0)throw new Error("generateRandomToken - bits must be in multiples of 8");var t=new Uint8Array(e/8);return(window.crypto||window.msCrypto).getRandomValues(t),r.bufferToHexString(t)},t.strictType=function(e){return e},t.pause=function(e){return new Promise(function(t){return setTimeout(t,e)})}},970:function(e,t){},972:function(e,t){},974:function(e,t){}},[[610,3,2]]]);
//# sourceMappingURL=main.6753f864.chunk.js.map